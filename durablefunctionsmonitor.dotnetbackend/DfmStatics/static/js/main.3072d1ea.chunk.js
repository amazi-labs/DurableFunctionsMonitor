(this["webpackJsonpdurablefunctionsmonitor.react"]=this["webpackJsonpdurablefunctionsmonitor.react"]||[]).push([[0],{404:function(e,t,a){e.exports=a(678)},409:function(e,t,a){},410:function(e,t,a){},411:function(e,t,a){},415:function(e,t,a){},439:function(e,t,a){},672:function(e,t,a){var r={"./locale":365,"./locale.js":365};function n(e){var t=i(e);return a(t)}function i(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=672},674:function(e,t,a){},675:function(e,t,a){},676:function(e,t,a){},677:function(e,t,a){},678:function(e,t,a){"use strict";a.r(t);var r,n,i,s,o,l=a(0),c=a(18),m=a(755),u=(a(409),a(23)),h=a(759),d=a(744),p=a(745),g=a(213),b=a(764),y=a(738),E=a(742),O=a(35),f=a(761),_=a(369),v=(a(410),a(725)),C=a(729),S=a(379),T=a(732),w=a(765),I=a(733),P=a(734),D=a(735),k=a(736),j=a(737),N=a(731),x=a(681),M=a(728),F=a(739),z=(a(411),Object(u.a)(r=class extends l.Component{render(){var e=this.props.state;return l.createElement("div",null,l.createElement(v.a,{color:e.isLoggedInAnonymously?"secondary":"inherit",onClick:t=>e.menuAnchorElement=t.currentTarget},l.createElement(M.a,null),l.createElement(h.a,{width:5}),l.createElement(C.a,{title:e.isLoggedInAnonymously?"Ensure this endpoint is not exposed to the public!":""},l.createElement(g.a,{color:e.isLoggedInAnonymously?"secondary":"inherit"},e.isLoggedInAnonymously?"Anonymous":e.userName))),!e.isLoggedInAnonymously&&l.createElement(S.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:()=>e.menuAnchorElement=void 0},l.createElement(T.a,{onClick:()=>e.logout()},"Login under a different name")),l.createElement(w.a,{open:!e.isLoggedIn},l.createElement(I.a,null,e.errorMessage?l.createElement(l.Fragment,null,l.createElement(P.a,{className:"login-progress"},l.createElement(F.a,{color:"secondary",fontSize:"large"})),l.createElement(k.a,{color:"secondary"},"Login failed. ",e.errorMessage)):e.allowedTaskHubNames?l.createElement(l.Fragment,null,l.createElement(j.a,null,"Select your Task Hub"),l.createElement(N.a,{className:"task-hub-list"},e.allowedTaskHubNames.map(t=>l.createElement(x.a,{button:!0},l.createElement(y.a,{href:e.locationPathName+t},t))))):l.createElement(l.Fragment,null,l.createElement(P.a,{className:"login-progress"},l.createElement(D.a,null)),l.createElement(k.a,null,"Login in progress...")))))}})||r),H=a(682),A=a(741),L=a(743),R=a(375),W=a.n(R),B=a(7),V=a(6),Y=a(768),U=a(740),q=a(206),K=a.n(q),J=a(374),G=a.n(J),Z=(a(415),n=V.d.bound,Object(u.a)((s=class extends l.Component{render(){var e=this.props.state;return l.createElement(Y.a,{className:"message-snackbar",anchorOrigin:{vertical:"top",horizontal:"right"},open:!!e.errorMessage,autoHideDuration:6e3,onClose:this.handleClose},l.createElement(U.a,{className:"error-snackbar-content",message:l.createElement("span",null,l.createElement(G.a,{className:"error-icon"}),e.errorMessage),action:[l.createElement(H.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},l.createElement(K.a,null))]}))}handleClose(){this.props.state.errorMessage=""}},Object(B.a)(s.prototype,"handleClose",[n],Object.getOwnPropertyDescriptor(s.prototype,"handleClose"),s.prototype),i=s))||i),$=Object(u.a)(o=class extends l.Component{componentDidMount(){this.props.state.setWindowTitle()}render(){var e=this.props.state;return l.createElement(l.Fragment,null,l.createElement(H.a,{color:"inherit",onClick:t=>e.menuAnchorElement=t.currentTarget},l.createElement(W.a,null)),l.createElement(S.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:()=>e.menuAnchorElement=void 0},l.createElement(T.a,{onClick:()=>e.showConnectionParamsDialog()},"Manage Storage Connection Settings..."),l.createElement(T.a,{onClick:()=>e.showPurgeHistoryDialog()},"Purge Instance History..."),l.createElement(T.a,{onClick:()=>e.showCleanEntityStorageDialog()},"Clean Entity Storage...")),l.createElement(w.a,{open:e.connectionParamsDialogOpen,onClose:()=>e.connectionParamsDialogOpen=!1},l.createElement(j.a,null,"Manage Storage Connection Settings"),l.createElement(I.a,null,e.inProgress?l.createElement(A.a,null):l.createElement(h.a,{height:4}),l.createElement(k.a,null,e.isReadonly?"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)":"The below values will be saved to local.settings.json file."),l.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Hub Name",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},value:e.hubName,onChange:t=>e.hubName=t.target.value}),l.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Azure Storage Connection String",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:e.isReadonly},InputLabelProps:{shrink:!0},value:e.connectionString,onChange:t=>e.connectionString=t.target.value}),l.createElement(Z,{state:e})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.connectionParamsDialogOpen=!1,color:"primary"},"Cancel"),!e.isReadonly&&l.createElement(v.a,{onClick:()=>e.saveConnectionParams(),disabled:!e.isDirty||!e.hubName||!e.connectionString||e.inProgress,color:"secondary"},"Save"))))}})||o,Q=a(30),X=a.n(Q),ee=a(746),te=a(685),ae=a(686),re=a(763),ne=a(690),ie=a(748),se=a(749),oe=a(762),le=a(760),ce=a(747),me=a(688),ue=a(255),he=a(750),de=a(751),pe=a(752),ge=a(753),be=a(767),ye=a(754),Ee=a(383),Oe=a(757),fe=a(211),_e=a.n(fe),ve=a(377),Ce=a.n(ve),Se=a(144);a(439);class Te{static momentAsUtc(e){if(!e||!e.isValid())return e;var t=X()(e.toISOString(!0).slice(0,19)+"Z");return t.utc(),t}static isValidMoment(e){return!!e&&e.isValid()&&e.isAfter(Te.MinMoment)&&e.isBefore(Te.MaxMoment)}static formatDateTime(e){return e.toISOString().slice(0,16)}}Te.MinMoment=X()("1900-01-01").utc(),Te.MaxMoment=X()("2100-01-01").utc();var we=["Timestamp","EventType","Name","ScheduledTime","Result","Details"];class Ie{constructor(){this.instanceId=void 0,this.name=void 0,this.entityId=void 0,this.runtimeStatus=void 0,this.entityType=void 0,this.lastEvent=void 0,this.input=void 0,this.customStatus=void 0,this.output=void 0,this.createdTime=void 0,this.lastUpdatedTime=void 0,this.historyEvents=void 0,this.tabTemplateNames=void 0}}var Pe,De,ke,je,Ne,xe,Me,Fe,ze=["instanceId","name","createdTime","lastUpdatedTime","runtimeStatus","lastEvent","input","output","customStatus"],He=a(11),Ae=(a(42),a(162)),Le=a.n(Ae),Re=a(756),We=(Pe=class{constructor(){Object(He.a)(this,"errorMessage",De,this)}},De=Object(B.a)(Pe.prototype,"errorMessage",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Pe),Be=DfmRoutePrefix?"/".concat(DfmRoutePrefix,"/"):"/",Ve=Be+"a/p/i";class Ye{get isVsCode(){return!1}get routePrefixAndTaskHubName(){return Be+this._getTaskHubName()}constructor(e,t){this._getTaskHubName=e,this._getAuthorizationHeaderAsync=t}call(e,t,a){return new Promise((r,n)=>{this._getAuthorizationHeaderAsync().then(i=>{Le.a.request({url:Ve+"/"+this._getTaskHubName()+t,method:e,data:a,headers:i}).then(e=>{r(e.data)},n)})})}}var Ue,qe,Ke,Je,Ge,Ze,$e,Qe,Xe,et,tt,at,rt,nt,it,st,ot,lt,ct,mt,ut=(ke=class extends We{get isLoggedIn(){return this._isLoggedIn}get isLoggedInAnonymously(){return!this._userName}get userName(){return this._userName}get taskHubName(){return this._taskHubName}get allowedTaskHubNames(){return this._allowedTaskHubNames}get locationPathName(){var e=window.location.pathname,t=e.lastIndexOf("/orchestrations/");return t>=0&&(e=e.substring(0,t)),e.endsWith("/")||(e+="/"),e}constructor(){super(),Object(He.a)(this,"menuAnchorElement",je,this),Object(He.a)(this,"_isLoggedIn",Ne,this),Object(He.a)(this,"_userName",xe,this),Object(He.a)(this,"_taskHubName",Me,this),Object(He.a)(this,"_allowedTaskHubNames",Fe,this),this._aadApp=void 0,this.login()}login(){var e="".concat(Ve,"/easyauth-config");Le.a.get(e).then(e=>this.loginWithEasyAuthConfig(e.data),e=>{this.errorMessage="".concat(e.message,".").concat(e.response?e.response.data:"")})}logout(){this.menuAnchorElement=void 0,this._aadApp.logout()}getAuthorizationHeaderAsync(){return this._aadApp?new Promise((e,t)=>{var a={scopes:[this._aadApp.getCurrentConfiguration().auth.clientId]};this._aadApp.acquireTokenSilent(a).then(t=>{var a=t.accessToken;a||(console.log("DFM: accessToken is null, so using idToken.rawIdToken instead"),a=t.idToken.rawIdToken),e({Authorization:"Bearer ".concat(a)})},e=>{console.log("DFM: acquireTokenSilent() failed (".concat(e,"), so calling acquireTokenRedirect()...")),this._aadApp.acquireTokenRedirect(a)})}):new Promise((e,t)=>e(void 0))}loginWithEasyAuthConfig(e){if(e.clientId){this._aadApp=new Re.a({auth:{clientId:e.clientId,authority:e.authority,redirectUri:this.getRootUri()}}),this._aadApp.handleRedirectCallback(()=>{},(e,t)=>{console.log("Failed to handle login redirect. name: ".concat(e.name,", message: ").concat(e.message,", errorCode: ").concat(e.errorCode,", errorMessage: ").concat(e.errorMessage,", accountState: ").concat(t))});var t=this._aadApp.getAccount();t?(this._userName=t.userName,this.initializeTaskHubNameAndConfirmLogin()):this._aadApp.loginRedirect()}else this.initializeTaskHubNameAndConfirmLogin()}initializeTaskHubNameAndConfirmLogin(){var e=this.tryGetTaskHubName();if(e)return this._taskHubName=e,void(this._isLoggedIn=!0);this.getAuthorizationHeaderAsync().then(e=>{var t="".concat(Ve,"/task-hub-names");Le.a.get(t,{headers:e}).then(e=>{var t=e.data;1===t.length?window.location.pathname=this.locationPathName+t[0]:this._allowedTaskHubNames=t},e=>{this.errorMessage="".concat(e.message,".").concat(e.response?e.response.data:"")})})}tryGetTaskHubName(){var e=this.locationPathName;if(e.toLowerCase().endsWith("/".concat(DfmRoutePrefix.toLowerCase(),"/")))return null;var t=e.split("/").filter(e=>!!e);return t.length<1?null:t[t.length-1]}getRootUri(){var e=this.tryGetTaskHubName();if(e){var t=window.location.href.toLowerCase().lastIndexOf("/"+e.toLowerCase());if(t>=0)return window.location.href.substring(0,t)}return window.location.origin+window.location.pathname}},Object(B.a)(ke.prototype,"isLoggedIn",[V.e],Object.getOwnPropertyDescriptor(ke.prototype,"isLoggedIn"),ke.prototype),Object(B.a)(ke.prototype,"isLoggedInAnonymously",[V.e],Object.getOwnPropertyDescriptor(ke.prototype,"isLoggedInAnonymously"),ke.prototype),Object(B.a)(ke.prototype,"userName",[V.e],Object.getOwnPropertyDescriptor(ke.prototype,"userName"),ke.prototype),Object(B.a)(ke.prototype,"taskHubName",[V.e],Object.getOwnPropertyDescriptor(ke.prototype,"taskHubName"),ke.prototype),Object(B.a)(ke.prototype,"allowedTaskHubNames",[V.e],Object.getOwnPropertyDescriptor(ke.prototype,"allowedTaskHubNames"),ke.prototype),je=Object(B.a)(ke.prototype,"menuAnchorElement",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ne=Object(B.a)(ke.prototype,"_isLoggedIn",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xe=Object(B.a)(ke.prototype,"_userName",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Object(B.a)(ke.prototype,"_taskHubName",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=Object(B.a)(ke.prototype,"_allowedTaskHubNames",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke),ht=(Ue=V.d.bound,Object(u.a)((Ke=class extends l.Component{render(){var e,t;return this.props.backendClient.isVsCode?l.createElement(y.a,{href:"/",onClick:this.onLinkClicked},null!==(e=this.props.title)&&void 0!==e?e:this.props.orchestrationId):l.createElement(y.a,{href:"".concat(this.props.backendClient.routePrefixAndTaskHubName).concat("/orchestrations/").concat(this.extraSanitizeHrefComponent(this.props.orchestrationId)),target:"_blank"},null!==(t=this.props.title)&&void 0!==t?t:this.props.orchestrationId)}onLinkClicked(){this.props.backendClient.call("OpenInNewWindow",this.props.orchestrationId)}extraSanitizeHrefComponent(e){return e.replace(/javascript:/gi,"")}},Object(B.a)(Ke.prototype,"onLinkClicked",[Ue],Object.getOwnPropertyDescriptor(Ke.prototype,"onLinkClicked"),Ke.prototype),qe=Ke))||qe),dt=a(47),pt=(Je=class{constructor(){Object(He.a)(this,"inProgress",Ge,this),Object(He.a)(this,"isCancelled",Ze,this)}},Ge=Object(B.a)(Je.prototype,"inProgress",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ze=Object(B.a)(Je.prototype,"isCancelled",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Je),gt=($e=class{get hiddenColumns(){return this._hiddenColumns}get orchestrations(){return this._orchestrations}get orderByDirection(){return this._orderByDirection}get orderBy(){return this._orderBy}set orderBy(e){this._orderBy!==e?(this._orderBy=e,this._orderByDirection="asc"):"desc"===this._orderByDirection?this.resetOrderBy():this._orderByDirection="desc",this._refresh()}get backendClient(){return this._backendClient}constructor(e,t,a){this._backendClient=e,this._localStorage=t,this._refresh=a,Object(He.a)(this,"columnUnderMouse",Qe,this),Object(He.a)(this,"_orchestrations",Xe,this),Object(He.a)(this,"_orderByDirection",et,this),Object(He.a)(this,"_orderBy",tt,this),Object(He.a)(this,"_hiddenColumns",at,this),this._noMorePagesToLoad=!1,this._pageSize=50;var r=this._localStorage.getItem("orderBy");r&&(this._orderBy=r);var n=this._localStorage.getItem("orderByDirection");n&&(this._orderByDirection=n);var i=this._localStorage.getItem("hiddenColumns");i&&(this._hiddenColumns=i.split("|"))}hideColumn(e){this._hiddenColumns.push(e),this._localStorage.setItem("hiddenColumns",this._hiddenColumns.join("|"))}unhide(){this._hiddenColumns=[],this._localStorage.removeItem("hiddenColumns"),this._refresh()}resetOrderBy(){this._orderBy="",this._orderByDirection="asc"}reset(){this._orchestrations=[],this._noMorePagesToLoad=!1}load(e,t,a=!1){if(a)this._noMorePagesToLoad=!1;else{if(this._noMorePagesToLoad)return Promise.resolve();this._localStorage.setItems([{fieldName:"orderBy",value:this._orderBy},{fieldName:"orderByDirection",value:this._orderByDirection}])}var r=a?0:this._orchestrations.length,n=this._orderBy?"&$orderby=".concat(this._orderBy," ").concat(this.orderByDirection):"",i=this._hiddenColumns.length?"&hidden-columns=".concat(this._hiddenColumns.join("|")):"",s="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(r).concat(e).concat(n).concat(i);return this._backendClient.call("GET",s).then(e=>{t.isCancelled||(a?this._orchestrations=e:this._orchestrations.push(...e),e.length||(this._noMorePagesToLoad=!0))})}},Qe=Object(B.a)($e.prototype,"columnUnderMouse",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)($e.prototype,"hiddenColumns",[V.e],Object.getOwnPropertyDescriptor($e.prototype,"hiddenColumns"),$e.prototype),Object(B.a)($e.prototype,"orchestrations",[V.e],Object.getOwnPropertyDescriptor($e.prototype,"orchestrations"),$e.prototype),Object(B.a)($e.prototype,"orderByDirection",[V.e],Object.getOwnPropertyDescriptor($e.prototype,"orderByDirection"),$e.prototype),Object(B.a)($e.prototype,"orderBy",[V.e],Object.getOwnPropertyDescriptor($e.prototype,"orderBy"),$e.prototype),Xe=Object(B.a)($e.prototype,"_orchestrations",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),et=Object(B.a)($e.prototype,"_orderByDirection",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"asc"}}),tt=Object(B.a)($e.prototype,"_orderBy",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),at=Object(B.a)($e.prototype,"_hiddenColumns",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$e),bt=a(95),yt=a.n(bt),Et=(ot=st=class e{get description(){return this._diagramCode}get rawHtml(){return this._diagramSvg}constructor(e){this._loadDetails=e,this.name="Diagram",this.isMermaidDiagram=!0,Object(He.a)(this,"_diagramCode",nt,this),Object(He.a)(this,"_diagramSvg",it,this)}load(t){return e._mermaidInitialized||(yt.a.initialize({startOnLoad:!0,sequence:{noteMargin:0,boxMargin:5,boxTextMargin:5}}),e._mermaidInitialized=!0),t.historyEvents?this.buildDiagram(t):Promise.resolve()}},st._mermaidInitialized=!1,rt=ot,Object(B.a)(rt.prototype,"description",[V.e],Object.getOwnPropertyDescriptor(rt.prototype,"description"),rt.prototype),Object(B.a)(rt.prototype,"rawHtml",[V.e],Object.getOwnPropertyDescriptor(rt.prototype,"rawHtml"),rt.prototype),nt=Object(B.a)(rt.prototype,"_diagramCode",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=Object(B.a)(rt.prototype,"_diagramSvg",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rt);function Ot(e){var t="";if(isNaN(e)||e<0)return t;var a=Math.floor(e/864e5);if(a>30)return t;var r=0;a>0&&(t+=a.toFixed(0)+"d",++r,e%=864e5);var n=Math.floor(e/36e5);if(n>0){if(t+=n.toFixed(0)+"h",++r>1)return"(".concat(t,")");e%=36e5}var i=Math.floor(e/6e4);if(i>0){if(t+=i.toFixed(0)+"m",++r>1)return"(".concat(t,")");e%=6e4}var s=Math.floor(e/1e3);if(s>0){if(t+=s.toFixed(0)+"s",++r>1)return"(".concat(t,")");e%=1e3}return e>0&&(t+=e.toFixed(0)+"ms"),t||(t="0ms"),"(".concat(t,")")}function ft(e){return e.substr(0,23)}function _t(e){return Math.round(e/1e3).toFixed(0)+"s"}var vt,Ct,St,Tt,wt,It,Pt,Dt,kt,jt,Nt,xt,Mt,Ft,zt,Ht,At,Lt=(lt=class{get rawHtml(){return this._diagramSvg}get diagramCode(){return this._diagramCode}constructor(e){this._backendClient=e,Object(He.a)(this,"_diagramSvg",ct,this),Object(He.a)(this,"_diagramCode",mt,this)}reset(){this._diagramCode="",this._diagramSvg=""}load(e,t,a){return new Promise((t,a)=>{var r="/orchestrations?$top=500&$orderby=createdTime asc".concat("&hidden-columns=history|input|output|customStatus|lastEvent").concat(e);this._backendClient.call("GET",r).then(e=>{var r=this.renderDiagram(e);Promise.all(r).then(r=>{this._diagramCode="gantt \n"+"title Gantt Chart (".concat(e.length," instances shown) \n")+"dateFormat YYYY-MM-DDTHH:mm:ssZ \n"+r.join(""),this._diagramSvg="";try{yt.a.render("mermaidSvgId",this._diagramCode,e=>{this._diagramSvg=e,t()})}catch(n){a(n)}},a)},a)})}escapeOrchestrationId(e){return e.replace(/[@:;]/g," ")}renderDiagram(e){var t,a=[],r="",n=0,i=Object(dt.a)(e);try{for(i.s();!(t=i.n()).done;){var s=t.value,o="",l="DurableEntity"===s.entityType?s.entityId.name:s.name;l!=r&&(o="section ".concat(++n,". ").concat(this.escapeOrchestrationId(l)," \n"),r=l);var c="DurableEntity"===s.entityType?s.entityId.key:s.instanceId,m=new Date(s.lastUpdatedTime).getTime()-new Date(s.createdTime).getTime();o+="".concat(this.escapeOrchestrationId(c)," ").concat(Ot(m),": active, ").concat(ft(s.createdTime),", ").concat(_t(m<1e3?1e3:m)," \n"),a.push(Promise.resolve(o))}}catch(u){i.e(u)}finally{i.f()}return a}},Object(B.a)(lt.prototype,"rawHtml",[V.e],Object.getOwnPropertyDescriptor(lt.prototype,"rawHtml"),lt.prototype),Object(B.a)(lt.prototype,"diagramCode",[V.e],Object.getOwnPropertyDescriptor(lt.prototype,"diagramCode"),lt.prototype),ct=Object(B.a)(lt.prototype,"_diagramSvg",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),mt=Object(B.a)(lt.prototype,"_diagramCode",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),lt),Rt=(vt=class{get zoomedIn(){return this._zoomedIn}get histogram(){return this._histogram}get numOfInstancesShown(){return this._numOfInstancesShown}get timeRangeInMs(){return this._filterState.timeTill.valueOf()-this._filterState.timeFrom.valueOf()}constructor(e,t){this._backendClient=e,this._filterState=t,Object(He.a)(this,"_histogram",Ct,this),Object(He.a)(this,"_numOfInstancesShown",St,this),Object(He.a)(this,"_zoomedIn",Tt,this),this._applyingZoom=!1,this._initialTimeInterval=null,this._numOfIntervals=200,this._pageSize=1e3}reset(){this._numOfInstancesShown=0,this._histogram=[]}load(e,t,a){this._applyingZoom||this._zoomedIn||(this._initialTimeInterval={from:this._filterState.timeFrom,till:this._filterState.timeTill}),this._numOfInstancesShown=0;var r=this._filterState.timeFrom.valueOf(),n=Math.ceil((this._filterState.timeTill.valueOf()-r)/this._numOfIntervals);n<=0&&(n=1);for(var i=[],s=0;s<this._numOfIntervals;s++)i[s]={x0:r+s*n,x:r+(s+1)*n,y:0};return this._histogram=i,this.loadNextBatch(e,r,n,0,t)}applyZoom(e,t){this._numOfInstancesShown=0,this._filterState.cancel();var a=1e3*Math.floor(e.getTime()/1e3),r=1e3*Math.ceil(t.getTime()/1e3);this._filterState.timeFrom=X()(a).utc(),this._filterState.timeTill=X()(r).utc(),this._applyingZoom=!0;try{this._filterState.reloadOrchestrations()}finally{this._applyingZoom=!1}this._zoomedIn=!0}resetZoom(){this._zoomedIn&&this._initialTimeInterval&&(this._zoomedIn=!1,this._filterState.cancel(),this._filterState.timeFrom=this._initialTimeInterval.from,this._filterState.timeTill=this._initialTimeInterval.till,this._initialTimeInterval=null,this._filterState.reloadOrchestrations())}loadNextBatch(e,t,a,r,n){var i="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(this._numOfInstancesShown).concat("&hidden-columns=history|input|output|customStatus|lastEvent").concat(e);return this._backendClient.call("GET",i).then(i=>{if(n.isCancelled||!i.length)return Promise.resolve();var s,o=Object(dt.a)(i);try{for(o.s();!(s=o.n()).done;){var l=s.value,c=Math.floor((new Date(l.createdTime).getTime()-t)/a);c<0||c>=this._numOfIntervals||!this._histogram[c]||this._histogram[c].y++}}catch(m){o.e(m)}finally{o.f()}return this._numOfInstancesShown+=i.length,this.loadNextBatch(e,t,a,r+1,n)})}},Object(B.a)(vt.prototype,"zoomedIn",[V.e],Object.getOwnPropertyDescriptor(vt.prototype,"zoomedIn"),vt.prototype),Object(B.a)(vt.prototype,"histogram",[V.e],Object.getOwnPropertyDescriptor(vt.prototype,"histogram"),vt.prototype),Object(B.a)(vt.prototype,"numOfInstancesShown",[V.e],Object.getOwnPropertyDescriptor(vt.prototype,"numOfInstancesShown"),vt.prototype),Ct=Object(B.a)(vt.prototype,"_histogram",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),St=Object(B.a)(vt.prototype,"_numOfInstancesShown",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Tt=Object(B.a)(vt.prototype,"_zoomedIn",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),vt);!function(e){e[e.Equals=0]="Equals",e[e.StartsWith=1]="StartsWith",e[e.Contains=2]="Contains"}(zt||(zt={})),function(e){e[e.ShowBoth=0]="ShowBoth",e[e.OrchestrationsOnly=1]="OrchestrationsOnly",e[e.DurableEntitiesOnly=2]="DurableEntitiesOnly"}(Ht||(Ht={})),function(e){e[e.List=0]="List",e[e.Histogram=1]="Histogram",e[e.Gantt=2]="Gantt"}(At||(At={}));var Wt=(wt=class extends We{get selectedTabIndex(){return this._selectedTabIndex}set selectedTabIndex(e){this._selectedTabIndex!==e&&(this._selectedTabIndex=e,this.reloadOrchestrations())}get selectedTabState(){return this._tabStates[this._selectedTabIndex]}get inProgress(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadOrchestrations(!0)}get timeFrom(){return this._timeFrom}set timeFrom(e){this._timeFrom=e,this.listState.resetOrderBy()}get timeTill(){return this._timeTill?this._timeTill:X()().utc()}set timeTill(e){this._timeTill=e,this.listState.resetOrderBy()}get timeTillEnabled(){return!!this._timeTill}set timeTillEnabled(e){this._timeTill=e?X()().utc():null,e||(this.listState.resetOrderBy(),this.reloadOrchestrations())}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e}get filterOperator(){return this._filterOperator}set filterOperator(e){this._filterOperator=e,this._filterValue&&"0"!==this._filteredColumn&&this.reloadOrchestrations()}get filteredColumn(){return this._filteredColumn}set filteredColumn(e){this._filteredColumn=e,this._filterValue&&("0"===this._filteredColumn&&(this._filterValue=""),this.reloadOrchestrations())}get showEntityType(){return Ht[this._showEntityType]}set showEntityType(e){this._showEntityType=Ht[e],this.reloadOrchestrations()}get showLastEventColumn(){return"lastEvent"===this._filteredColumn&&!!this._oldFilterValue}get backendClient(){return this._backendClient}constructor(e,t){var a;super(),this._backendClient=e,this._localStorage=t,Object(He.a)(this,"_selectedTabIndex",It,this),Object(He.a)(this,"_cancelToken",Pt,this),Object(He.a)(this,"_autoRefresh",Dt,this),Object(He.a)(this,"_timeFrom",kt,this),Object(He.a)(this,"_timeTill",jt,this),Object(He.a)(this,"_filterValue",Nt,this),Object(He.a)(this,"_filterOperator",xt,this),Object(He.a)(this,"_filteredColumn",Mt,this),Object(He.a)(this,"_showEntityType",Ft,this),this._tabStates=[new gt(this._backendClient,this._localStorage,()=>this.reloadOrchestrations()),new Rt(this._backendClient,this),new Lt(this._backendClient)],this._autoRefreshToken=void 0,this._oldFilterValue="",this._oldTimeFrom=void 0,this._oldTimeTill=void 0;var r=this._localStorage.getItem("timeFrom");(a=r?X()(r):X()().subtract(1,"days")).utc(),this._timeFrom=a,this._oldTimeFrom=a;var n=this._localStorage.getItem("timeTill");n&&(this._timeTill=X()(n),this._timeTill.utc(),this._oldTimeTill=this._timeTill);var i=this._localStorage.getItem("filteredColumn");i&&(this._filteredColumn=i);var s=this._localStorage.getItem("filterOperator");s&&(this._filterOperator=zt[s]);var o=this._localStorage.getItem("filterValue");o&&(this._filterValue=o,this._oldFilterValue=o);var l=this._localStorage.getItem("showEntityType");l&&(this._showEntityType=Ht[l]);var c=this._localStorage.getItem("autoRefresh");c&&(this._autoRefresh=Number(c))}applyTimeFrom(){Te.isValidMoment(this._timeFrom)&&this._oldTimeFrom!==this._timeFrom&&this.reloadOrchestrations()}applyTimeTill(){Te.isValidMoment(this._timeTill)&&this._oldTimeTill!==this._timeTill&&this.reloadOrchestrations()}applyFilterValue(){this._oldFilterValue!==this._filterValue&&this.reloadOrchestrations()}reloadOrchestrations(){var e,t=Object(dt.a)(this._tabStates);try{for(t.s();!(e=t.n()).done;){e.value.reset()}}catch(a){t.e(a)}finally{t.f()}Te.isValidMoment(this._timeFrom)||(this._timeFrom=this._oldTimeFrom),this._timeTill&&!Te.isValidMoment(this._timeTill)&&(this._timeTill=this._oldTimeTill),this._localStorage.setItems([{fieldName:"timeFrom",value:this._timeFrom.toISOString()},{fieldName:"timeTill",value:this._timeTill?this._timeTill.toISOString():null},{fieldName:"filteredColumn",value:this._filteredColumn},{fieldName:"filterOperator",value:zt[this._filterOperator]},{fieldName:"filterValue",value:this._filterValue?this._filterValue:null},{fieldName:"showEntityType",value:Ht[this._showEntityType]}]),this.loadOrchestrations(),this._oldFilterValue=this._filterValue,this._oldTimeFrom=this._timeFrom,this._oldTimeTill=this._timeTill}cancel(){this._cancelToken.isCancelled=!0,this._cancelToken=new pt}loadOrchestrations(e=!1){var t=this._cancelToken;if(!t.inProgress){t.inProgress=!0;var a=this._timeFrom.toISOString(),r=this._timeTill?this._timeTill.toISOString():X()().utc().toISOString(),n="&$filter=createdTime ge '".concat(a,"' and createdTime le '").concat(r,"'");if(this._showEntityType===Ht.OrchestrationsOnly?n+=" and entityType eq 'Orchestration'":this._showEntityType===Ht.DurableEntitiesOnly&&(n+=" and entityType eq 'DurableEntity'"),this._filterValue&&"0"!==this._filteredColumn)switch(n+=" and ",this._filterOperator){case zt.Equals:n+="".concat(this._filteredColumn," eq '").concat(this._filterValue,"'");break;case zt.StartsWith:n+="startswith(".concat(this._filteredColumn,", '").concat(this._filterValue,"')");break;case zt.Contains:n+="contains(".concat(this._filteredColumn,", '").concat(this._filterValue,"')")}this.selectedTabState.load(n,t,e).then(()=>{this._autoRefreshToken&&clearTimeout(this._autoRefreshToken),this._autoRefresh&&(this._autoRefreshToken=setTimeout(()=>{this.loadOrchestrations(!0)},1e3*this._autoRefresh))},e=>{this._autoRefresh=0,t.isCancelled||(this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," "))}).finally(()=>{t.inProgress=!1})}}get listState(){return this._tabStates[0]}},Object(B.a)(wt.prototype,"selectedTabIndex",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"selectedTabIndex"),wt.prototype),Object(B.a)(wt.prototype,"inProgress",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"inProgress"),wt.prototype),Object(B.a)(wt.prototype,"autoRefresh",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"autoRefresh"),wt.prototype),Object(B.a)(wt.prototype,"timeFrom",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"timeFrom"),wt.prototype),Object(B.a)(wt.prototype,"timeTill",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"timeTill"),wt.prototype),Object(B.a)(wt.prototype,"timeTillEnabled",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"timeTillEnabled"),wt.prototype),Object(B.a)(wt.prototype,"filterValue",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"filterValue"),wt.prototype),Object(B.a)(wt.prototype,"filterOperator",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"filterOperator"),wt.prototype),Object(B.a)(wt.prototype,"filteredColumn",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"filteredColumn"),wt.prototype),Object(B.a)(wt.prototype,"showEntityType",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"showEntityType"),wt.prototype),Object(B.a)(wt.prototype,"showLastEventColumn",[V.e],Object.getOwnPropertyDescriptor(wt.prototype,"showLastEventColumn"),wt.prototype),It=Object(B.a)(wt.prototype,"_selectedTabIndex",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return At.List}}),Pt=Object(B.a)(wt.prototype,"_cancelToken",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new pt}}),Dt=Object(B.a)(wt.prototype,"_autoRefresh",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),kt=Object(B.a)(wt.prototype,"_timeFrom",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt=Object(B.a)(wt.prototype,"_timeTill",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(B.a)(wt.prototype,"_filterValue",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),xt=Object(B.a)(wt.prototype,"_filterOperator",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return zt.Equals}}),Mt=Object(B.a)(wt.prototype,"_filteredColumn",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0"}}),Ft=Object(B.a)(wt.prototype,"_showEntityType",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ht.ShowBoth}}),wt),Bt=a(253),Vt=a.n(Bt);a(674);class Yt extends l.Component{render(){return this.props.backendClient.isVsCode?l.createElement(v.a,{variant:"outlined",color:"default",size:"large",className:"save-svg-button",disabled:this.props.inProgress,onClick:()=>this.props.backendClient.call("SaveAs",this.props.fileName+".svg",this.props.svg)},l.createElement("div",null,l.createElement(Vt.a,null),l.createElement(g.a,{color:"inherit"},"Save as .SVG"))):l.createElement(v.a,{variant:"outlined",color:"default",size:"large",className:"save-svg-button",disabled:this.props.inProgress,href:URL.createObjectURL(new Blob([this.props.svg],{type:"image/svg+xml"})),download:this.props.fileName+".svg"},l.createElement("div",null,l.createElement(Vt.a,null),l.createElement(g.a,{color:"inherit"},"Save as .SVG")))}}function Ut(e){return e.replace("</style>",".note { stroke: none !important; fill: none !important; } .noteText { font-size: 9px !important; } </style>")}var qt,Kt,Jt,Gt=a(378),Zt=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME:DfmClientConfig.theme,$t=Object(Gt.a)({palette:{type:"dark"===Zt?"dark":"light"}}),Qt="dark"===$t.palette.type?{backgroundColor:"#aaa"}:{};function Xt(e){var t=null;switch(e){case"Failed":t=ea($t.palette.error.light,.2);break;case"Completed":t=ea($t.palette.success.light,.2);break;case"Running":t=ea($t.palette.warning.light,.2);break;case"Terminated":t=ea($t.palette.background.paper,.1)}return t?{backgroundColor:t}:{}}function ea(e,t){return e.length>4?"rgba(".concat(parseInt(e.slice(1,3),16),", ").concat(parseInt(e.slice(3,5),16),", ").concat(parseInt(e.slice(5,7),16),", ").concat(t.toFixed(1),")"):"rgba(".concat(parseInt(e.slice(1,2),16),", ").concat(parseInt(e.slice(2,3),16),", ").concat(parseInt(e.slice(3,4),16),", ").concat(t.toFixed(1),")")}var ta,aa,ra,na,ia,sa,oa,la,ca,ma,ua,ha,da,pa,ga,ba,ya,Ea,Oa=(qt=V.d.bound,Object(u.a)((Jt=class extends l.Component{componentDidMount(){this.props.state.loadOrchestrations(),document.addEventListener("scroll",e=>{var t=this.props.state;if(t.selectedTabIndex===At.List){var a=e.target.scrollingElement;if(a){a.scrollHeight-window.innerHeight-a.scrollTop<100&&t.loadOrchestrations()}}}),document.addEventListener("keydown",e=>{var t=this.props.state;t.selectedTabIndex===At.Histogram&&e.ctrlKey&&90===e.keyCode&&t.selectedTabState.resetZoom()})}render(){var e=this.props.state,t=e.selectedTabState,a=e.selectedTabState,r=e.selectedTabState;return l.createElement(l.Fragment,null,l.createElement(d.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?l.createElement(A.a,null):l.createElement(h.a,{height:4}),l.createElement(p.a,{variant:"dense",className:"top-toolbar"},l.createElement(ee.a,{container:!0,className:"toolbar-grid1"},l.createElement(ee.a,{item:!0,xs:12},l.createElement(Oe.a,{className:"from-input",style:{marginLeft:10},ampm:!1,autoOk:!0,label:"From \xa0\xa0 (UTC)",invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:e.inProgress,value:e.timeFrom,onChange:t=>e.timeFrom=Te.momentAsUtc(t),onBlur:()=>e.applyTimeFrom(),onAccept:()=>e.applyTimeFrom(),onKeyPress:this.handleKeyPress})),l.createElement(ee.a,{item:!0,xs:12,className:"toolbar-grid1-item2"},l.createElement(te.a,null,l.createElement(ae.a,{className:"till-label",htmlFor:"till-checkbox",shrink:!0},"Till"),l.createElement(re.a,{id:"till-checkbox",className:"till-checkbox",disabled:e.inProgress,checked:e.timeTillEnabled,onChange:t=>e.timeTillEnabled=t.target.checked})),e.timeTillEnabled?l.createElement(Oe.a,{className:"till-input",ampm:!1,autoOk:!0,label:"(UTC)",invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:e.inProgress,value:e.timeTill,onChange:t=>e.timeTill=Te.momentAsUtc(t),onBlur:()=>e.applyTimeTill(),onAccept:()=>e.applyTimeTill(),onKeyPress:this.handleKeyPress}):l.createElement(E.a,{className:"till-input",label:"(UTC)",placeholder:"[Now]",InputLabelProps:{shrink:!0},type:"text",disabled:!0}))),l.createElement(ee.a,{container:!0,className:"toolbar-grid2"},l.createElement(ee.a,{item:!0,xs:12},l.createElement(te.a,null,l.createElement(ae.a,{htmlFor:"filtered-column-select"},"Filtered Column"),l.createElement(ne.a,{className:"toolbar-select filtered-column-input",disabled:e.inProgress,value:e.filteredColumn,onChange:t=>e.filteredColumn=t.target.value,inputProps:{id:"filtered-column-select"}},l.createElement(T.a,{value:"0"},"[Not Selected]"),ze.map(e=>l.createElement(T.a,{key:e,value:e},e)))),l.createElement(te.a,{className:"toolbar-grid2-item1-select"},l.createElement(ae.a,{htmlFor:"filter-operator-select"},"Filter Operator"),l.createElement(ne.a,{className:"toolbar-select",disabled:e.inProgress,value:e.filterOperator,onChange:t=>e.filterOperator=t.target.value,inputProps:{id:"filter-operator-select"}},l.createElement(T.a,{value:0},"Equals"),l.createElement(T.a,{value:1},"Starts With"),l.createElement(T.a,{value:2},"Contains")))),l.createElement(ee.a,{item:!0,xs:12,className:"toolbar-grid2-item2"},l.createElement(E.a,{className:"filter-value-input",label:"Filter Value",InputLabelProps:{shrink:!0},placeholder:"[some text or 'null']",disabled:"0"===e.filteredColumn||e.inProgress,value:e.filterValue,onChange:t=>e.filterValue=t.target.value,onBlur:()=>e.applyFilterValue(),onKeyPress:this.handleKeyPress}))),l.createElement(ie.a,{value:e.showEntityType,onChange:t=>e.showEntityType=t.target.value},l.createElement(se.a,{className:"entity-type-radio",disabled:e.inProgress,value:Ht[Ht.ShowBoth],control:l.createElement(oe.a,null),label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Show both")}),l.createElement(se.a,{className:"entity-type-radio",disabled:e.inProgress,value:Ht[Ht.OrchestrationsOnly],control:l.createElement(oe.a,null),label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Orchestrations only")}),l.createElement(se.a,{className:"entity-type-radio",disabled:e.inProgress,value:Ht[Ht.DurableEntitiesOnly],control:l.createElement(oe.a,null),label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Durable Entities only")})),l.createElement(g.a,{style:{flex:1}}),l.createElement(ee.a,{container:!0,className:"toolbar-grid3"},l.createElement(ee.a,{item:!0,xs:12},l.createElement(te.a,{className:"form-control-float-right"},l.createElement(ae.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),l.createElement(ne.a,{className:"toolbar-select",inputProps:{id:"auto-refresh-select"},value:e.autoRefresh,onChange:t=>e.autoRefresh=t.target.value},l.createElement(T.a,{value:0},"Never"),l.createElement(T.a,{value:1},"Every 1 sec."),l.createElement(T.a,{value:5},"Every 5 sec."),l.createElement(T.a,{value:10},"Every 10 sec.")))),l.createElement(ee.a,{item:!0,xs:12,className:"toolbar-grid3-item2"},l.createElement(v.a,{className:"refresh-button form-control-float-right",variant:"outlined",color:"default",size:"large",onClick:()=>e.inProgress?e.cancel():e.reloadOrchestrations()},e.inProgress?l.createElement(Ce.a,null):l.createElement(_e.a,null)))))),l.createElement(d.a,{color:"inherit",position:"static"},l.createElement(le.a,{value:e.selectedTabIndex,onChange:(t,a)=>e.selectedTabIndex=a},l.createElement(ce.a,{disabled:e.inProgress,label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"List")}),l.createElement(ce.a,{disabled:e.inProgress,label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Time Histogram")}),l.createElement(ce.a,{disabled:e.inProgress,label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Gantt Chart")}))),e.selectedTabIndex===At.List&&l.createElement(l.Fragment,null,l.createElement(me.a,{className:"items-count-label"},!!t.orchestrations.length&&l.createElement(l.Fragment,null,"".concat(t.orchestrations.length," items shown"),!!t.hiddenColumns.length&&l.createElement(l.Fragment,null,", ".concat(t.hiddenColumns.length," columns hidden "),"(",l.createElement(y.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:()=>t.unhide()},"unhide"),")"))),l.createElement(ue.a,{elevation:0},t.orchestrations.length?this.renderTable(t,e.showLastEventColumn,e.backendClient):this.renderEmptyTable()),e.inProgress&&t.orchestrations.length?l.createElement(A.a,null):l.createElement(h.a,{height:4})),e.selectedTabIndex===At.Histogram&&l.createElement(l.Fragment,null,l.createElement(me.a,{className:"items-count-label"},"".concat(a.numOfInstancesShown," items shown"),a.zoomedIn&&l.createElement(l.Fragment,null,", ",l.createElement(y.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:()=>a.resetZoom()},"reset zoom (Ctrl+Z)"))),l.createElement(Se.d,{width:window.innerWidth-40,height:window.innerHeight-400,xType:"time",margin:{left:80,right:80,top:20}},!!a.numOfInstancesShown&&l.createElement(Se.e,{tickTotal:7}),l.createElement(Se.c,{tickTotal:7,tickFormat:e=>this.formatTimeTick(e,a.timeRangeInMs)}),l.createElement(Se.b,{data:a.histogram,stroke:"white",colorType:"literal"}),!!a.numOfInstancesShown&&l.createElement(Se.a,{color:"#829AE3",drag:!0,enableY:!1,onDragEnd:e=>{e&&a.applyZoom(e.left,e.right)}}))),e.selectedTabIndex===At.Gantt&&!!r.rawHtml&&l.createElement(l.Fragment,null,l.createElement("div",{className:"raw-html-div",style:Qt,dangerouslySetInnerHTML:{__html:Ut(r.rawHtml)}}),l.createElement(p.a,{variant:"dense"},l.createElement(E.a,{label:"mermaid diagram code (for your reference)",value:r.diagramCode,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:4}),l.createElement(h.a,{width:20}),l.createElement(Yt,{svg:Ut(r.rawHtml),fileName:"gantt-chart-".concat(e.timeFrom.format("YYYY-MM-DD-HH-mm-ss"),"-").concat(e.timeTill.format("YYYY-MM-DD-HH-mm-ss")),inProgress:e.inProgress,backendClient:e.backendClient}))),l.createElement(p.a,{variant:"dense"}),l.createElement(Z,{state:this.props.state}))}renderEmptyTable(){return l.createElement(g.a,{variant:"h5",className:"empty-table-placeholder"},"This list is empty")}renderTable(e,t,a){var r=ze.filter(e=>!!t||"lastEvent"!==e);return l.createElement(he.a,{size:"small"},l.createElement(de.a,null,l.createElement(pe.a,null,r.map(t=>{var a=r.length<=e.hiddenColumns.length+1;return!e.hiddenColumns.includes(t)&&l.createElement(ge.a,{key:t,onMouseEnter:()=>e.columnUnderMouse=t,onMouseLeave:()=>e.columnUnderMouse=""},l.createElement(be.a,{active:e.orderBy===t,direction:e.orderByDirection,onClick:()=>e.orderBy=t},t),e.columnUnderMouse===t&&!a&&l.createElement(H.a,{color:"inherit",size:"small",className:"column-hide-button",onClick:()=>e.hideColumn(t)},l.createElement(K.a,null)))}))),l.createElement(ye.a,null,e.orchestrations.map(r=>{var n=Xt(r.runtimeStatus),i={verticalAlign:"top"};return l.createElement(pe.a,{key:r.instanceId,style:n},!e.hiddenColumns.includes("instanceId")&&l.createElement(ge.a,{className:"instance-id-cell",style:i},l.createElement(ht,{orchestrationId:r.instanceId,backendClient:a})),!e.hiddenColumns.includes("name")&&l.createElement(ge.a,{className:"name-cell",style:i},r.name),!e.hiddenColumns.includes("createdTime")&&l.createElement(ge.a,{className:"datetime-cell",style:i},r.createdTime),!e.hiddenColumns.includes("lastUpdatedTime")&&l.createElement(ge.a,{className:"datetime-cell",style:i},r.lastUpdatedTime),!e.hiddenColumns.includes("runtimeStatus")&&l.createElement(ge.a,{style:i},r.runtimeStatus),!e.hiddenColumns.includes("lastEvent")&&t&&l.createElement(ge.a,{style:i},r.lastEvent),!e.hiddenColumns.includes("input")&&l.createElement(ge.a,{className:"long-text-cell",style:i},l.createElement(Ee.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:this.renderJson(r.input)})),!e.hiddenColumns.includes("output")&&l.createElement(ge.a,{className:"output-cell",style:i},l.createElement(Ee.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:this.renderJson(r.output)})),!e.hiddenColumns.includes("customStatus")&&l.createElement(ge.a,{className:"output-cell",style:i},l.createElement(Ee.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:this.renderJson(r.customStatus)})))})))}formatTimeTick(e,t){var a=X()(e).utc();return t>432e6?a.format("YYYY-MM-DD"):t>864e5?a.format("YYYY-MM-DD HH:mm"):t>1e4?0===a.second()?a.format("HH:mm"):a.format("HH:mm:ss"):0===a.millisecond()?a.format("HH:mm:ss"):a.format(":SSS")}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.reloadOrchestrations())}renderJson(e){var t=JSON.stringify(e);return t.length>1024?"[".concat(t.length," symbols long JSON]"):t}},Object(B.a)(Jt.prototype,"handleKeyPress",[qt],Object.getOwnPropertyDescriptor(Jt.prototype,"handleKeyPress"),Jt.prototype),Kt=Jt))||Kt),fa=(a(675),Object(u.a)(ta=class extends l.Component{render(){var e=this.props.state;return l.createElement(l.Fragment,null,this.renderDialogs(e),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.purgeConfirmationOpen=!0},"Purge"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.raiseEventDialogOpen=!0},"Send Signal"))}renderDialogs(e){return l.createElement(l.Fragment,null,l.createElement(w.a,{open:e.purgeConfirmationOpen,onClose:()=>e.purgeConfirmationOpen=!1},l.createElement(j.a,null,"Confirm Purge"),l.createElement(I.a,null,l.createElement(k.a,null,"You're about to purge entity '",e.orchestrationId,"'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.purgeConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),l.createElement(v.a,{onClick:()=>e.purge(),color:"secondary"},"Yes, purge"))),l.createElement(w.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:()=>e.raiseEventDialogOpen=!1},l.createElement(j.a,null,"Send Signal"),l.createElement(I.a,null,l.createElement(k.a,null,"Provide signal name and some additional data"),l.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Signal Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:t=>e.eventName=t.target.value}),l.createElement(E.a,{margin:"dense",label:"Signal Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:t=>e.eventData=t.target.value})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.raiseEventDialogOpen=!1,color:"primary"},"Cancel"),l.createElement(v.a,{onClick:()=>e.raiseEvent(),disabled:!e.eventName,color:"secondary"},"Send"))))}})||ta),_a=Object(u.a)(aa=class extends l.Component{render(){var e,t,a=this.props.details,r=Xt(a.runtimeStatus);return l.createElement(l.Fragment,null,l.createElement(ee.a,{container:!0,className:"grid-container"},l.createElement(ee.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"entityId.name",value:null===(e=a.entityId)||void 0===e?void 0:e.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:6,md:3,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"entityId.key",value:null===(t=a.entityId)||void 0===t?void 0:t.key,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"createdTime",value:a.createdTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"lastUpdatedTime",value:a.lastUpdatedTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"runtimeStatus",value:a.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:r})),l.createElement(ee.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"input",value:JSON.stringify(a.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10})),l.createElement(ee.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"customStatus",value:JSON.stringify(a.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10}))))}})||aa,va=Object(u.a)(ra=class extends l.Component{render(){var e=this.props.state;return l.createElement(l.Fragment,null,this.renderDialogs(e),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.restartDialogOpen=!0},"Restart"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.rewindConfirmationOpen=!0},"Rewind"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.terminateConfirmationOpen=!0},"Terminate"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.raiseEventDialogOpen=!0},"Raise Event"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.setCustomStatusDialogOpen=!0},"Set Custom Status"),l.createElement(h.a,{width:10}),l.createElement(v.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.purgeConfirmationOpen=!0},"Purge"))}renderDialogs(e){return l.createElement(l.Fragment,null,l.createElement(w.a,{open:e.rewindConfirmationOpen,onClose:()=>e.rewindConfirmationOpen=!1},l.createElement(j.a,null,"Confirm Rewind"),l.createElement(I.a,null,l.createElement(k.a,null,"You're about to rewind orchestration '",e.orchestrationId,"'. Are you sure?")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.rewindConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),l.createElement(v.a,{onClick:()=>e.rewind(),color:"secondary"},"Yes, rewind"))),l.createElement(w.a,{open:e.terminateConfirmationOpen,onClose:()=>e.terminateConfirmationOpen=!1},l.createElement(j.a,null,"Confirm Terminate"),l.createElement(I.a,null,l.createElement(k.a,null,"You're about to terminate orchestration '",e.orchestrationId,"'. This operation cannot be undone. Are you sure?")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.terminateConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),l.createElement(v.a,{onClick:()=>e.terminate(),color:"secondary"},"Yes, terminate"))),l.createElement(w.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:()=>e.raiseEventDialogOpen=!1},l.createElement(j.a,null,"Raise Event"),l.createElement(I.a,null,l.createElement(k.a,null,"Provide event name and some additional data"),l.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Event Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:t=>e.eventName=t.target.value}),l.createElement(E.a,{margin:"dense",label:"Event Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:t=>e.eventData=t.target.value})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.raiseEventDialogOpen=!1,color:"primary"},"Cancel"),l.createElement(v.a,{onClick:()=>e.raiseEvent(),disabled:!e.eventName,color:"secondary"},"Raise"))),l.createElement(w.a,{fullWidth:!0,open:e.setCustomStatusDialogOpen,onClose:()=>e.setCustomStatusDialogOpen=!1},l.createElement(j.a,null,"Set customStatus"),l.createElement(I.a,null,l.createElement(k.a,null,"customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself."),l.createElement(E.a,{margin:"dense",InputLabelProps:{shrink:!0},label:"New customStatus (JSON)",fullWidth:!0,multiline:!0,rows:10,value:e.newCustomStatus,onChange:t=>e.newCustomStatus=t.target.value})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.setCustomStatusDialogOpen=!1,color:"primary"},"Cancel"),l.createElement(v.a,{onClick:()=>e.setCustomStatus(),disabled:!e.isCustomStatusDirty,color:"secondary"},"Apply"))),l.createElement(w.a,{open:e.purgeConfirmationOpen,onClose:()=>e.purgeConfirmationOpen=!1},l.createElement(j.a,null,"Confirm Purge"),l.createElement(I.a,null,l.createElement(k.a,null,"You're about to purge orchestration '",e.orchestrationId,"'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.purgeConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),l.createElement(v.a,{onClick:()=>e.purge(),color:"secondary"},"Yes, purge"))),l.createElement(w.a,{open:e.restartDialogOpen,onClose:()=>e.restartDialogOpen=!1},l.createElement(j.a,null,"Confirm Restart"),l.createElement(I.a,null,l.createElement(k.a,null,"You're about to restart orchestration '",e.orchestrationId,"'. Are you sure?"),l.createElement(se.a,{control:l.createElement(re.a,{checked:e.restartWithNewInstanceId,onChange:t=>e.restartWithNewInstanceId=t.target.checked}),label:"Restart with new instanceId"})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.restartDialogOpen=!1,color:"primary",autoFocus:!0},"Cancel"),l.createElement(v.a,{onClick:()=>e.restart(),color:"secondary"},"Restart"))))}})||ra,Ca=Object(u.a)(na=class extends l.Component{render(){var e=this.props.details,t=Xt(e.runtimeStatus);return l.createElement(l.Fragment,null,l.createElement(ee.a,{container:!0,className:"grid-container"},l.createElement(ee.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"instanceId",value:e.instanceId,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"name",value:e.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"createdTime",value:e.createdTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"lastUpdatedTime",value:e.lastUpdatedTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),l.createElement(ee.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"runtimeStatus",value:e.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:t})),l.createElement(ee.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"input",value:JSON.stringify(e.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),l.createElement(ee.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"output",value:JSON.stringify(e.output,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),l.createElement(ee.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},l.createElement(E.a,{label:"customStatus",value:JSON.stringify(e.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8}))),l.createElement(me.a,{className:"history-events-count-label"},"historyEvents: ",e.historyEvents?e.historyEvents.length:0," items"),this.renderTable(e.historyEvents))}renderEmptyTable(){return l.createElement(g.a,{variant:"h5",className:"empty-table-placeholder"},"This list is empty")}renderTable(e){return e&&e.length?l.createElement(he.a,{size:"small"},l.createElement(de.a,null,l.createElement(pe.a,null,we.map(e=>l.createElement(ge.a,{key:e},e)))),l.createElement(ye.a,null,e.map((e,t)=>{var a,r={verticalAlign:"top"};return l.createElement(pe.a,{key:t},l.createElement(ge.a,{style:r},e.Timestamp),l.createElement(ge.a,{style:r},e.EventType),l.createElement(ge.a,{className:"name-cell",style:r},e.SubOrchestrationId?l.createElement(ht,{orchestrationId:e.SubOrchestrationId,title:e.FunctionName,backendClient:this.props.backendClient}):null!==(a=e.Name)&&void 0!==a?a:e.FunctionName),l.createElement(ge.a,{style:r},e.ScheduledTime),l.createElement(ge.a,{className:"long-text-cell",style:r},l.createElement(Ee.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:JSON.stringify(e.Result)})),l.createElement(ge.a,{className:"long-text-cell",style:r},l.createElement(Ee.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:e.Details})))}))):this.renderEmptyTable()}})||na,Sa=Object(u.a)(ia=class extends l.Component{componentDidMount(){this.props.state.loadDetails()}render(){var e=this.props.state;return l.createElement(l.Fragment,null,l.createElement(d.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?l.createElement(A.a,null):l.createElement(h.a,{height:4}),l.createElement(p.a,{variant:"dense",className:"top-toolbar"},"Orchestration"===e.details.entityType&&l.createElement(va,{state:e,disabled:e.inProgress}),"DurableEntity"===e.details.entityType&&l.createElement(fa,{state:e,disabled:e.inProgress}),l.createElement(h.a,{width:20}),l.createElement(g.a,{style:{flex:1}}),l.createElement(te.a,null,l.createElement(ae.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),l.createElement(ne.a,{className:"toolbar-select",value:e.autoRefresh,onChange:t=>e.autoRefresh=t.target.value,inputProps:{id:"auto-refresh-select"}},l.createElement(T.a,{value:0},"Never"),l.createElement(T.a,{value:1},"Every 1 sec."),l.createElement(T.a,{value:5},"Every 5 sec."),l.createElement(T.a,{value:10},"Every 10 sec."))),l.createElement(h.a,{width:20}),l.createElement(v.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress,onClick:()=>e.loadDetails()},l.createElement(_e.a,null)))),!!e.tabStates.length&&l.createElement(l.Fragment,null,l.createElement(d.a,{color:"inherit",position:"static"},l.createElement(le.a,{value:e.selectedTabIndex,onChange:(t,a)=>e.selectedTabIndex=a},l.createElement(ce.a,{className:"tab-title",disabled:e.inProgress,label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},"Details")}),e.tabStates.map(t=>l.createElement(ce.a,{className:"tab-title",key:t.name,disabled:e.inProgress,label:l.createElement(g.a,{color:"textPrimary",variant:"subtitle2"},t.name)}))))),!e.selectedTabIndex&&"Orchestration"===e.details.entityType&&l.createElement(Ca,{details:e.details,backendClient:e.backendClient}),!e.selectedTabIndex&&"DurableEntity"===e.details.entityType&&l.createElement(_a,{details:e.details}),!!e.selectedTab&&!!e.selectedTab.rawHtml&&l.createElement(l.Fragment,null,l.createElement("div",{className:"raw-html-div",style:Qt,dangerouslySetInnerHTML:{__html:Ut(e.selectedTab.rawHtml)}}),e.selectedTab.isMermaidDiagram&&l.createElement(p.a,{variant:"dense"},l.createElement(E.a,{label:"mermaid diagram code (for your reference)",value:e.selectedTab.description,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:4}),l.createElement(h.a,{width:20}),l.createElement(Yt,{svg:Ut(e.selectedTab.rawHtml),fileName:e.orchestrationId,inProgress:e.inProgress,backendClient:e.backendClient}))),l.createElement(Z,{state:this.props.state}))}})||ia,Ta=a(687),wa=a(689),Ia=(a(676),Object(u.a)(sa=class extends l.Component{render(){var e=this.props.state;return l.createElement(w.a,{open:e.dialogOpen,onClose:()=>{e.inProgress||(e.dialogOpen=!1)}},l.createElement(j.a,null,"Purge Instance History"),null===e.instancesDeleted&&l.createElement("div",null,l.createElement(I.a,null,e.inProgress?l.createElement(A.a,null):l.createElement(h.a,{height:4}),l.createElement(k.a,null,"WARNING: this operation drops instance states from the underlying storage and cannot be undone.","DurableEntity"===e.entityType&&l.createElement(g.a,{color:"error"},"It might as well remove Durable Entities, that are still active. Ensure that you specify the correct time frame! To clean up deleted Entities use the 'Clean Entity Storage' command instead.")),l.createElement(te.a,{className:"purge-history-statuses",disabled:e.inProgress,fullWidth:!0},l.createElement(Ta.a,null,"Apply to:"),l.createElement(ie.a,{row:!0,value:e.entityType,onChange:t=>e.entityType=t.target.value},l.createElement(se.a,{disabled:e.inProgress,value:"Orchestration",control:l.createElement(oe.a,null),label:"Orchestrations"}),l.createElement(se.a,{disabled:e.inProgress,value:"DurableEntity",control:l.createElement(oe.a,null),label:"Durable Entities"}))),l.createElement(Oe.a,{className:"purge-history-from-input",ampm:!1,autoOk:!0,label:"DurableEntity"===e.entityType?"Last Updated From (UTC)":"From (UTC)",format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:e.inProgress,value:e.timeFrom,onChange:t=>e.timeFrom=Te.momentAsUtc(t)}),l.createElement(Oe.a,{className:"purge-history-till-input",ampm:!1,autoOk:!0,label:"DurableEntity"===e.entityType?"Last Updated Till (UTC)":"Till (UTC)",format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:e.inProgress,value:e.timeTill,onChange:t=>e.timeTill=Te.momentAsUtc(t)}),l.createElement(te.a,{className:"purge-history-statuses",disabled:e.inProgress},l.createElement(Ta.a,null,"With the following status:"),"Orchestration"===e.entityType&&l.createElement(wa.a,{row:!0},l.createElement(Pa,{state:e,runtimeStatus:"Completed"}),l.createElement(Pa,{state:e,runtimeStatus:"Failed"}),l.createElement(Pa,{state:e,runtimeStatus:"Terminated"})),"DurableEntity"===e.entityType&&l.createElement(wa.a,{row:!0},l.createElement(C.a,{title:"Durable Entities are always in 'Running' state"},l.createElement(se.a,{control:l.createElement(re.a,{checked:!0}),label:"Running",disabled:!0})))),l.createElement(Z,{state:e})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.dialogOpen=!1,disabled:e.inProgress,color:"primary"},"Cancel"),l.createElement(v.a,{onClick:()=>e.purgeHistory(),disabled:!e.isValid||e.inProgress,color:"secondary"},"Purge"))),null!==e.instancesDeleted&&l.createElement("div",null,l.createElement(I.a,null,l.createElement(k.a,{className:"success-message"},e.instancesDeleted," instances were deleted.")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.dialogOpen=!1,color:"primary"},"Close"))))}})||sa),Pa=Object(u.a)(oa=class extends l.Component{render(){var e=this.props.state,t=this.props.runtimeStatus;return l.createElement(se.a,{control:l.createElement(re.a,{checked:e.getStatusIncluded(t),onChange:a=>e.setStatusIncluded(t,a.target.checked)}),label:t})}})||oa,Da=(a(677),Object(u.a)(la=class extends l.Component{render(){var e=this.props.state;return l.createElement(w.a,{open:e.dialogOpen,onClose:()=>{e.inProgress||(e.dialogOpen=!1)}},l.createElement(j.a,null,"Clean Entity Storage"),!e.response&&l.createElement(l.Fragment,null,l.createElement(I.a,null,e.inProgress?l.createElement(A.a,null):l.createElement(h.a,{height:4}),l.createElement(k.a,null,"An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than EntityMessageReorderWindowInMinutes. Locks are considered orphaned, and are released, if the orchestration that holds them is not in state Running."),l.createElement(te.a,{className:"purge-history-statuses",disabled:e.inProgress},l.createElement(wa.a,{row:!0},l.createElement(se.a,{control:l.createElement(re.a,{checked:e.removeEmptyEntities,onChange:t=>e.removeEmptyEntities=t.target.checked}),label:"Remove Empty Entities"}),l.createElement(se.a,{control:l.createElement(re.a,{checked:e.releaseOrphanedLocks,onChange:t=>e.releaseOrphanedLocks=t.target.checked}),label:"Release Orphaned Locks"}))),l.createElement(Z,{state:e})),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.dialogOpen=!1,disabled:e.inProgress,color:"primary"},"Cancel"),l.createElement(v.a,{onClick:()=>e.clean(),disabled:!e.isValid||e.inProgress,color:"secondary"},"Clean"))),!!e.response&&l.createElement(l.Fragment,null,l.createElement(I.a,null,l.createElement(k.a,{className:"success-message"},e.response.numberOfEmptyEntitiesRemoved," empty entities removed."),l.createElement(k.a,{className:"success-message"},e.response.numberOfOrphanedLocksRemoved," orphaned locks removed.")),l.createElement(L.a,null,l.createElement(v.a,{onClick:()=>e.dialogOpen=!1,color:"primary"},"Close"))))}})||la),ka=Object(u.a)(ca=class extends l.Component{render(){var e=this.props.state;return l.createElement(O.a,{utils:_.a},l.createElement(l.Fragment,null,!e.loginState&&l.createElement(h.a,{height:20}),!!e.loginState&&l.createElement(d.a,{position:"static",color:"default",className:"app-bar"},l.createElement(p.a,null,e.loginState.isLoggedIn&&!!e.mainMenuState&&l.createElement($,{state:e.mainMenuState}),l.createElement("img",{src:"".concat(DfmRoutePrefix?"/":"").concat(DfmRoutePrefix,"/logo.svg"),width:"30px"}),l.createElement(h.a,{width:5}),l.createElement(g.a,{variant:"h6",color:"inherit",className:"title-typography"},"Durable Functions Monitor"),l.createElement(b.a,{color:"inherit"},l.createElement(y.a,{color:"inherit",href:e.loginState.locationPathName},"/ instances"),e.orchestrationDetailsState?l.createElement(g.a,{color:"inherit"},e.orchestrationDetailsState.orchestrationId):l.createElement(f.a,{className:"instance-id-input",freeSolo:!0,options:e.isExactMatch?[]:e.suggestions,value:e.typedInstanceId,onChange:(t,a)=>{e.typedInstanceId=null!==a&&void 0!==a?a:"",a&&e.goto()},renderInput:t=>l.createElement(E.a,Object.assign({},t,{className:e.isExactMatch?"instance-id-valid":null,size:"small",label:"instanceId to go to...",variant:"outlined",onChange:t=>e.typedInstanceId=t.target.value,onKeyPress:e=>this.handleKeyPress(e)}))})),l.createElement(g.a,{style:{flex:1}}),l.createElement(z,{state:e.loginState}))),!!e.orchestrationsState&&(!e.loginState||e.loginState.isLoggedIn)&&l.createElement(Oa,{state:e.orchestrationsState}),!!e.orchestrationDetailsState&&(!e.loginState||e.loginState.isLoggedIn)&&l.createElement(Sa,{state:e.orchestrationDetailsState}),l.createElement(Ia,{state:e.purgeHistoryDialogState}),l.createElement(Da,{state:e.cleanEntityStorageDialogState})))}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.goto())}})||ca,ja=(ma=class extends We{get inProgress(){return this._inProgress}get isReadonly(){return this._isReadOnly}get isDirty(){return this.connectionString!==this._oldConnectionString||this.hubName!==this._oldHubName}constructor(e,t,a){super(),this._backendClient=e,this._purgeHistoryDialogState=t,this._cleanEntityStorageDialogState=a,Object(He.a)(this,"menuAnchorElement",ua,this),Object(He.a)(this,"hubName",ha,this),Object(He.a)(this,"connectionString",da,this),Object(He.a)(this,"connectionParamsDialogOpen",pa,this),Object(He.a)(this,"_inProgress",ga,this),Object(He.a)(this,"_isReadOnly",ba,this),this._oldConnectionString=void 0,this._oldHubName=void 0}showConnectionParamsDialog(){this.menuAnchorElement=void 0,this.connectionParamsDialogOpen=!0,this._inProgress=!0,this._backendClient.call("GET","/manage-connection").then(e=>{this.connectionString=this._oldConnectionString=e.connectionString,this.hubName=this._oldHubName=e.hubName,this._isReadOnly=e.isReadOnly},e=>{this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}).finally(()=>{this._inProgress=!1})}saveConnectionParams(){this._inProgress=!0,this._backendClient.call("PUT","/manage-connection",{connectionString:this.connectionString!==this._oldConnectionString?this.connectionString:"",hubName:this.hubName}).then(()=>{this.connectionParamsDialogOpen=!1,alert("Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.")},e=>{this.errorMessage="Save failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}).finally(()=>{this._inProgress=!1})}showPurgeHistoryDialog(){this.menuAnchorElement=void 0,this._purgeHistoryDialogState.dialogOpen=!0}showCleanEntityStorageDialog(){this.menuAnchorElement=void 0,this._cleanEntityStorageDialogState.dialogOpen=!0}setWindowTitle(){this._backendClient.call("GET","/about").then(e=>{document.title="Durable Functions Monitor (".concat(e.accountName,"/").concat(e.hubName,") v").concat(e.version)})}},ua=Object(B.a)(ma.prototype,"menuAnchorElement",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha=Object(B.a)(ma.prototype,"hubName",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),da=Object(B.a)(ma.prototype,"connectionString",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pa=Object(B.a)(ma.prototype,"connectionParamsDialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(B.a)(ma.prototype,"inProgress",[V.e],Object.getOwnPropertyDescriptor(ma.prototype,"inProgress"),ma.prototype),Object(B.a)(ma.prototype,"isReadonly",[V.e],Object.getOwnPropertyDescriptor(ma.prototype,"isReadonly"),ma.prototype),Object(B.a)(ma.prototype,"isDirty",[V.e],Object.getOwnPropertyDescriptor(ma.prototype,"isDirty"),ma.prototype),ga=Object(B.a)(ma.prototype,"_inProgress",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ba=Object(B.a)(ma.prototype,"_isReadOnly",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ma);class Na extends Et{constructor(e){super(e),this.name="Sequence Diagram"}buildDiagram(e){return new Promise((t,a)=>{Promise.all(this.getSequenceForOrchestration(e.name,".",e.historyEvents)).then(e=>{this._diagramCode="sequenceDiagram \n"+e.join("");try{this._diagramSvg="",yt.a.render("mermaidSvgId",this._diagramCode,e=>{this._diagramSvg=e,t()})}catch(r){a(r)}},a)})}getSequenceForOrchestration(e,t,a){for(var r=this,n=[],i=0,s=function(){var s=a[i];switch(s.EventType){case"ExecutionStarted":c="".concat(t,"->>+").concat(e,":[ExecutionStarted] \n")+"Note over ".concat(t,",").concat(e,": ").concat(r.formatDateTime(s.Timestamp)," \n"),n.push(Promise.resolve(c));break;case"SubOrchestrationInstanceCompleted":if(s.SubOrchestrationId){var m=s.FunctionName;n.push(new Promise((t,a)=>{r._loadDetails(s.SubOrchestrationId).then(n=>{Promise.all(r.getSequenceForOrchestration(n.name,e,n.historyEvents)).then(e=>{t(e.join(""))},a)},a=>{console.log("Failed to load ".concat(m,". ").concat(a.message)),t("".concat(e,"-x").concat(m,":[FailedToLoad] \n"))})}))}break;case"SubOrchestrationInstanceFailed":c="".concat(e,"-x").concat(s.FunctionName,":[SubOrchestrationInstanceFailed] \n"),n.push(Promise.resolve(c));break;case"TaskCompleted":for(o=s.DurationInMs,l=i+1;l<a.length&&"TaskCompleted"===a[l].EventType&&a[l].FunctionName===s.FunctionName&&a[l].ScheduledTime.substr(0,23)===s.ScheduledTime.substr(0,23);l++)o<a[l].DurationInMs&&(o=a[l].DurationInMs);if(l===i+1){var u="".concat(e,"->>").concat(e,":").concat(s.FunctionName," \n")+"Note over ".concat(e,": ").concat(Ot(s.DurationInMs)," \n");n.push(Promise.resolve(u))}else{var h="par ".concat(l-i," calls \n")+"".concat(e,"->>").concat(e,":").concat(s.FunctionName," \n")+"Note over ".concat(e,": ").concat(Ot(o)," \n")+"end \n";n.push(Promise.resolve(h)),i=l-1}break;case"TaskFailed":c="".concat(e,"-x").concat(e,":").concat(s.FunctionName,"(failed) \n"),n.push(Promise.resolve(c));break;case"EventRaised":c="".concat(".","->>").concat(e,":").concat(s.Name," \n")+"Note over ".concat(".",",").concat(e,": ").concat(r.formatDateTime(s.Timestamp)," \n"),n.push(Promise.resolve(c));break;case"TimerFired":c="".concat(".","->>").concat(e,":[TimerFired] \n")+"Note over ".concat(".",",").concat(e,": ").concat(r.formatDateTime(s.Timestamp)," \n"),n.push(Promise.resolve(c));break;case"ExecutionTerminated":c="".concat(".","->>").concat(e,":[ExecutionTerminated] \n")+"Note over ".concat(".",",").concat(e,": ").concat(r.formatDateTime(s.Timestamp)," \n"),n.push(Promise.resolve(c));break;case"ExecutionCompleted":c="".concat(e,"--\x3e>-").concat(t,":[ExecutionCompleted] \n")+"Note over ".concat(e,",").concat(t,": ").concat(Ot(s.DurationInMs)," \n"),n.push(Promise.resolve(c))}i++};i<a.length;){var o,l,c;s()}return n}formatDateTime(e){return e.length<=11?e:"("+e.substr(11,12)+"Z)"}}class xa extends Et{constructor(e){super(e),this.name="Gantt Chart"}buildDiagram(e){return new Promise((t,a)=>{Promise.all(this.renderOrchestration(e,!0)).then(r=>{this._diagramCode="gantt \n"+"title ".concat(e.name,"(").concat(e.instanceId,") \n")+"dateFormat YYYY-MM-DDTHH:mm:ss.SSS \n"+r.join(""),this._diagramSvg="";try{yt.a.render("mermaidSvgId",this._diagramCode,e=>{this._diagramSvg=e,t()})}catch(n){a(n)}},a)})}renderOrchestration(e,t){var a=this,r=[],n=e.instanceId,i=e.name,s=e.historyEvents,o=s.find(e=>"ExecutionStarted"==e.EventType),l=s.find(e=>"ExecutionCompleted"==e.EventType),c=t;if(o&&l){if(c){var m=l.DurationInMs>864e5?"axisFormat %Y-%m-%d %H:%M \n":"axisFormat %H:%M:%S \n";r.push(Promise.resolve(m)),c=!1}m=t?"":"section ".concat(i,"(").concat(this.escapeOrchestrationId(n),") \n");var u=Ot(l.DurationInMs);u||(u=i),m+="".concat(u,": ").concat(t?"":"active,"," ").concat(ft(o.Timestamp),", ").concat(_t(l.DurationInMs)," \n"),r.push(Promise.resolve(m))}if(c){m="axisFormat %H:%M:%S \n";r.push(Promise.resolve(m))}var h,d=Object(dt.a)(s);try{for(d.s();!(h=d.n()).done;){var p=h.value;switch(p.EventType){case"SubOrchestrationInstanceCompleted":p.SubOrchestrationId&&function(){var e=p.FunctionName;r.push(new Promise((t,r)=>{a._loadDetails(p.SubOrchestrationId).then(e=>{Promise.all(a.renderOrchestration(e,!1)).then(e=>{t(e.join(""))},r)},a=>{console.log("Failed to load ".concat(e,". ").concat(a.message)),t("%% Failed to load ".concat(e,". ").concat(a.message," \n"))})}))}();break;case"TaskCompleted":m="".concat(p.FunctionName," ").concat(Ot(p.DurationInMs),": done, ").concat(ft(p.ScheduledTime),", ").concat(_t(p.DurationInMs)," \n");r.push(Promise.resolve(m));break;case"TaskFailed":m="".concat(p.FunctionName," ").concat(Ot(p.DurationInMs),": crit, ").concat(ft(p.ScheduledTime),", ").concat(_t(p.DurationInMs)," \n");r.push(Promise.resolve(m))}}}catch(g){d.e(g)}finally{d.f()}return r}escapeOrchestrationId(e){return e.replace(/[:;]/g," ")}}var Ma,Fa,za,Ha,Aa,La,Ra,Wa,Ba,Va,Ya,Ua,qa,Ka,Ja,Ga,Za,$a,Qa,Xa,er,tr,ar,rr,nr,ir,sr,or,lr,cr,mr,ur,hr,dr=(ya=class{get rawHtml(){return this._rawHtml}constructor(e,t){this._orchestrationId=e,this._backendClient=t,this.name="",this.description="",this.isMermaidDiagram=!1,Object(He.a)(this,"_rawHtml",Ea,this)}load(e){return new Promise((e,t)=>{var a="/orchestrations('".concat(this._orchestrationId,"')/custom-tab-markup('").concat(this.name,"')");this._backendClient.call("POST",a).then(t=>{this._rawHtml=t,e()},t)})}},Object(B.a)(ya.prototype,"rawHtml",[V.e],Object.getOwnPropertyDescriptor(ya.prototype,"rawHtml"),ya.prototype),Ea=Object(B.a)(ya.prototype,"_rawHtml",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya),pr=(Ma=class extends We{get selectedTabIndex(){return this._selectedTabIndex}set selectedTabIndex(e){this._selectedTabIndex!==e&&(this._selectedTabIndex=e,this.loadCustomTabIfNeeded())}get selectedTab(){return this._selectedTabIndex?this._tabStates[this._selectedTabIndex-1]:null}get orchestrationId(){return this._orchestrationId}get inProgress(){return this._inProgress}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadDetails()}get raiseEventDialogOpen(){return this._raiseEventDialogOpen}set raiseEventDialogOpen(e){this._raiseEventDialogOpen=e,this.eventName="",this.eventData=""}get setCustomStatusDialogOpen(){return this._setCustomStatusDialogOpen}set setCustomStatusDialogOpen(e){this._setCustomStatusDialogOpen=e,this.newCustomStatus=this.details.customStatus?JSON.stringify(this.details.customStatus):""}get restartDialogOpen(){return this._restartDialogOpen}set restartDialogOpen(e){this._restartDialogOpen=e,this.restartWithNewInstanceId=!0}get isCustomStatusDirty(){return this.details.customStatus?this.newCustomStatus!==JSON.stringify(this.details.customStatus):!!this.newCustomStatus}get tabStates(){return this._tabStates}get backendClient(){return this._backendClient}constructor(e,t,a){super(),this._orchestrationId=e,this._backendClient=t,this._localStorage=a,Object(He.a)(this,"details",Fa,this),Object(He.a)(this,"rewindConfirmationOpen",za,this),Object(He.a)(this,"terminateConfirmationOpen",Ha,this),Object(He.a)(this,"purgeConfirmationOpen",Aa,this),Object(He.a)(this,"eventName",La,this),Object(He.a)(this,"eventData",Ra,this),Object(He.a)(this,"newCustomStatus",Wa,this),Object(He.a)(this,"restartWithNewInstanceId",Ba,this),Object(He.a)(this,"_tabStates",Va,this),Object(He.a)(this,"_selectedTabIndex",Ya,this),Object(He.a)(this,"_inProgress",Ua,this),Object(He.a)(this,"_raiseEventDialogOpen",qa,this),Object(He.a)(this,"_setCustomStatusDialogOpen",Ka,this),Object(He.a)(this,"_restartDialogOpen",Ja,this),Object(He.a)(this,"_autoRefresh",Ga,this),this._autoRefreshToken=void 0;var r=this._localStorage.getItem("autoRefresh");r&&(this._autoRefresh=Number(r))}rewind(){this.rewindConfirmationOpen=!1;var e="/orchestrations('".concat(this._orchestrationId,"')/rewind");this._inProgress=!0,this._backendClient.call("POST",e).then(()=>{this._inProgress=!1,this.loadDetails()},e=>{this._inProgress=!1,this.errorMessage="Failed to rewind: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}terminate(){this.terminateConfirmationOpen=!1;var e="/orchestrations('".concat(this._orchestrationId,"')/terminate");this._inProgress=!0,this._backendClient.call("POST",e).then(()=>{this._inProgress=!1,this.loadDetails()},e=>{this._inProgress=!1,this.errorMessage="Failed to terminate: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}purge(){this.purgeConfirmationOpen=!1;var e="/orchestrations('".concat(this._orchestrationId,"')/purge");this._inProgress=!0,this._backendClient.call("POST",e).then(()=>{this._inProgress=!1,this.details=new Ie,this._tabStates=[]},e=>{this._inProgress=!1,this.errorMessage="Failed to purge: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}restart(){this.restartDialogOpen=!1;var e="/orchestrations('".concat(this._orchestrationId,"')/restart"),t={restartWithNewInstanceId:this.restartWithNewInstanceId};this._inProgress=!0,this._backendClient.call("POST",e,t).then(()=>{this._inProgress=!1,this.loadDetails()},e=>{this._inProgress=!1,this.errorMessage="Failed to restart: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}raiseEvent(){var e="/orchestrations('".concat(this._orchestrationId,"')/raise-event"),t={name:this.eventName,data:null};try{t.data=JSON.parse(this.eventData)}catch(a){return void(this.errorMessage="Failed to parse event data: ".concat(a.message))}finally{this.raiseEventDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",e,t).then(()=>{this._inProgress=!1,this.loadDetails()},e=>{this._inProgress=!1,this.errorMessage="Failed to raise an event: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}setCustomStatus(){var e="/orchestrations('".concat(this._orchestrationId,"')/set-custom-status"),t=null;try{this.newCustomStatus&&(t=JSON.parse(this.newCustomStatus))}catch(a){return void(this.errorMessage="Failed to parse custom status: ".concat(a.message))}finally{this.setCustomStatusDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",e,t).then(()=>{this._inProgress=!1,this.loadDetails()},e=>{this._inProgress=!1,this.errorMessage="Failed to set custom status: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})}loadDetails(){this.inProgress?this.setAutoRefresh():(this._inProgress=!0,this.internalLoadDetails(this._orchestrationId).then(e=>{this.details=e,this.setAutoRefresh();var t=0;if("Orchestration"===this.details.entityType&&(this._tabStates.length<=t&&(this._tabStates.push(new Na(e=>this.internalLoadDetails(e))),this._tabStates.push(new xa(e=>this.internalLoadDetails(e)))),t+=2),this.details.tabTemplateNames){var a,r=Object(dt.a)(this.details.tabTemplateNames);try{for(r.s();!(a=r.n()).done;){var n=a.value;this._tabStates.length<=t&&this._tabStates.push(new dr(this._orchestrationId,this._backendClient)),this._tabStates[t].name=n,t++}}catch(i){r.e(i)}finally{r.f()}}this._inProgress=!1,this.loadCustomTabIfNeeded()},e=>{this._inProgress=!1,this._autoRefresh=0,this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}loadCustomTabIfNeeded(){!this._inProgress&&this.selectedTab&&(this._inProgress=!0,this.selectedTab.load(this.details).then(()=>{},e=>{this._autoRefresh=0,this.errorMessage="Failed to load tab: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}).finally(()=>{this._inProgress=!1}))}setAutoRefresh(){this._autoRefresh&&(this._autoRefreshToken&&clearTimeout(this._autoRefreshToken),this._autoRefreshToken=setTimeout(()=>this.loadDetails(),1e3*this._autoRefresh))}internalLoadDetails(e){var t="/orchestrations('".concat(e,"')");return this._backendClient.call("GET",t).then(t=>{if(!t)throw{message:"Orchestration '".concat(e,"' not found.")};return t.history&&(t.historyEvents=t.history),t})}},Object(B.a)(Ma.prototype,"selectedTabIndex",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"selectedTabIndex"),Ma.prototype),Fa=Object(B.a)(Ma.prototype,"details",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ie}}),Object(B.a)(Ma.prototype,"orchestrationId",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"orchestrationId"),Ma.prototype),Object(B.a)(Ma.prototype,"inProgress",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"inProgress"),Ma.prototype),Object(B.a)(Ma.prototype,"autoRefresh",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"autoRefresh"),Ma.prototype),Object(B.a)(Ma.prototype,"raiseEventDialogOpen",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"raiseEventDialogOpen"),Ma.prototype),Object(B.a)(Ma.prototype,"setCustomStatusDialogOpen",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"setCustomStatusDialogOpen"),Ma.prototype),Object(B.a)(Ma.prototype,"restartDialogOpen",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"restartDialogOpen"),Ma.prototype),Object(B.a)(Ma.prototype,"isCustomStatusDirty",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"isCustomStatusDirty"),Ma.prototype),za=Object(B.a)(Ma.prototype,"rewindConfirmationOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ha=Object(B.a)(Ma.prototype,"terminateConfirmationOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Aa=Object(B.a)(Ma.prototype,"purgeConfirmationOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),La=Object(B.a)(Ma.prototype,"eventName",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ra=Object(B.a)(Ma.prototype,"eventData",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wa=Object(B.a)(Ma.prototype,"newCustomStatus",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ba=Object(B.a)(Ma.prototype,"restartWithNewInstanceId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Object(B.a)(Ma.prototype,"tabStates",[V.e],Object.getOwnPropertyDescriptor(Ma.prototype,"tabStates"),Ma.prototype),Va=Object(B.a)(Ma.prototype,"_tabStates",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ya=Object(B.a)(Ma.prototype,"_selectedTabIndex",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ua=Object(B.a)(Ma.prototype,"_inProgress",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qa=Object(B.a)(Ma.prototype,"_raiseEventDialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ka=Object(B.a)(Ma.prototype,"_setCustomStatusDialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ja=Object(B.a)(Ma.prototype,"_restartDialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ga=Object(B.a)(Ma.prototype,"_autoRefresh",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ma),gr=(Za=class extends We{get dialogOpen(){return this._dialogOpen}set dialogOpen(e){this._dialogOpen=e,e&&(this._instancesDeleted=null,this.timeFrom=X()().subtract(1,"days").utc(),this.timeTill=X()().utc(),this._statuses=new Set(["Completed","Terminated"]),this.entityType="Orchestration")}get instancesDeleted(){return this._instancesDeleted}get inProgress(){return this._inProgress}get isValid(){return this._statuses.size>0&&Te.isValidMoment(this.timeFrom)&&Te.isValidMoment(this.timeTill)}constructor(e){super(),this._backendClient=e,Object(He.a)(this,"timeFrom",$a,this),Object(He.a)(this,"timeTill",Qa,this),Object(He.a)(this,"entityType",Xa,this),Object(He.a)(this,"_statuses",er,this),Object(He.a)(this,"_dialogOpen",tr,this),Object(He.a)(this,"_inProgress",ar,this),Object(He.a)(this,"_instancesDeleted",rr,this)}purgeHistory(){this._inProgress=!0,this._backendClient.call("POST","/purge-history",{entityType:this.entityType,timeFrom:this.timeFrom.toISOString(),timeTill:this.timeTill.toISOString(),statuses:Array.from(this._statuses.values())}).then(e=>{this._instancesDeleted=e.instancesDeleted},e=>{this.errorMessage="Purge history failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}).finally(()=>{this._inProgress=!1})}getStatusIncluded(e){return this._statuses.has(e)}setStatusIncluded(e,t){t?this._statuses.add(e):this._statuses.delete(e)}},Object(B.a)(Za.prototype,"dialogOpen",[V.e],Object.getOwnPropertyDescriptor(Za.prototype,"dialogOpen"),Za.prototype),Object(B.a)(Za.prototype,"instancesDeleted",[V.e],Object.getOwnPropertyDescriptor(Za.prototype,"instancesDeleted"),Za.prototype),Object(B.a)(Za.prototype,"inProgress",[V.e],Object.getOwnPropertyDescriptor(Za.prototype,"inProgress"),Za.prototype),Object(B.a)(Za.prototype,"isValid",[V.e],Object.getOwnPropertyDescriptor(Za.prototype,"isValid"),Za.prototype),$a=Object(B.a)(Za.prototype,"timeFrom",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qa=Object(B.a)(Za.prototype,"timeTill",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xa=Object(B.a)(Za.prototype,"entityType",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Orchestration"}}),er=Object(B.a)(Za.prototype,"_statuses",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),tr=Object(B.a)(Za.prototype,"_dialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ar=Object(B.a)(Za.prototype,"_inProgress",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rr=Object(B.a)(Za.prototype,"_instancesDeleted",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Za),br=(nr=class extends We{get dialogOpen(){return this._dialogOpen}set dialogOpen(e){this._dialogOpen=e,e&&(this._response=null,this.removeEmptyEntities=!0,this.releaseOrphanedLocks=!0)}get response(){return this._response}get inProgress(){return this._inProgress}get isValid(){return!0}constructor(e){super(),this._backendClient=e,Object(He.a)(this,"removeEmptyEntities",ir,this),Object(He.a)(this,"releaseOrphanedLocks",sr,this),Object(He.a)(this,"_dialogOpen",or,this),Object(He.a)(this,"_inProgress",lr,this),Object(He.a)(this,"_response",cr,this)}clean(){this._inProgress=!0,this._backendClient.call("POST","/clean-entity-storage",{removeEmptyEntities:this.removeEmptyEntities,releaseOrphanedLocks:this.releaseOrphanedLocks}).then(e=>{this._response=e},e=>{this.errorMessage="Clean Entity Storage failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}).finally(()=>{this._inProgress=!1})}},Object(B.a)(nr.prototype,"dialogOpen",[V.e],Object.getOwnPropertyDescriptor(nr.prototype,"dialogOpen"),nr.prototype),Object(B.a)(nr.prototype,"response",[V.e],Object.getOwnPropertyDescriptor(nr.prototype,"response"),nr.prototype),Object(B.a)(nr.prototype,"inProgress",[V.e],Object.getOwnPropertyDescriptor(nr.prototype,"inProgress"),nr.prototype),Object(B.a)(nr.prototype,"isValid",[V.e],Object.getOwnPropertyDescriptor(nr.prototype,"isValid"),nr.prototype),ir=Object(B.a)(nr.prototype,"removeEmptyEntities",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sr=Object(B.a)(nr.prototype,"releaseOrphanedLocks",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),or=Object(B.a)(nr.prototype,"_dialogOpen",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),lr=Object(B.a)(nr.prototype,"_inProgress",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cr=Object(B.a)(nr.prototype,"_response",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nr);class yr{constructor(e){this._prefix=e}setItem(e,t){localStorage.setItem("".concat(this._prefix,"::").concat(e),t)}setItems(e){var t,a=Object(dt.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;null===r.value?localStorage.removeItem("".concat(this._prefix,"::").concat(r.fieldName)):localStorage.setItem("".concat(this._prefix,"::").concat(r.fieldName),r.value)}}catch(n){a.e(n)}finally{a.f()}}getItem(e){return localStorage.getItem("".concat(this._prefix,"::").concat(e))}removeItem(e){localStorage.removeItem("".concat(this._prefix,"::").concat(e))}}class Er{get isVsCode(){return!0}get routePrefixAndTaskHubName(){return null}constructor(e){this._vsCodeApi=e,this._handlers={},this._requests={},window.addEventListener("message",e=>{var t=e.data,a=this._handlers[t.id];if(a)try{a(t.data)}catch(n){console.log("Failed to handle response from VsCode: "+n)}else{var r=this._requests[t.id];r&&(t.err?r.reject(t.err):r.resolve(t.data),delete this._requests[t.id])}})}call(e,t,a){var r=Math.random().toString();return this._vsCodeApi.postMessage({id:r,method:e,url:t,data:a}),new Promise((e,t)=>{this._requests[r]={resolve:e,reject:t}})}setCustomHandlers(e,t){this._handlers.purgeHistory=e,this._handlers.cleanEntityStorage=t,this._vsCodeApi.postMessage({method:"IAmReady"})}}class Or{constructor(e,t){this._prefix=e,this._vsCodeApi=t,this._state=void 0,this._state=StateFromVsCode[this._prefix],this._state||(this._state={})}setItem(e,t){this._state[e]=t,this.save()}setItems(e){var t,a=Object(dt.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;null===r.value?delete this._state[r.fieldName]:this._state[r.fieldName]=r.value}}catch(n){a.e(n)}finally{a.f()}this.save()}getItem(e){return this._state[e]}removeItem(e){delete this._state[e],this.save()}save(){this._vsCodeApi.postMessage({method:"PersistState",key:this._prefix,data:this._state})}}var fr=(mr=class{get typedInstanceId(){return this._typedInstanceId}set typedInstanceId(e){this._typedInstanceId=e,this.reloadSuggestions()}get suggestions(){return this._suggestions}get isExactMatch(){return 1===this._suggestions.length&&this._suggestions[0]===this._typedInstanceId}constructor(){this.loginState=void 0,this.mainMenuState=void 0,this.orchestrationsState=void 0,this.orchestrationDetailsState=void 0,this.purgeHistoryDialogState=void 0,this.cleanEntityStorageDialogState=void 0,Object(He.a)(this,"_suggestions",ur,this),Object(He.a)(this,"_typedInstanceId",hr,this),this._backendClient=void 0;var e=void 0;try{e=acquireVsCodeApi()}catch(r){}if(e){var t=new Er(e);this._backendClient=t,this.purgeHistoryDialogState=new gr(t),this.cleanEntityStorageDialogState=new br(t),this.orchestrationId?this.orchestrationDetailsState=new pr(this.orchestrationId,t,new Or("OrchestrationDetailsState",e)):(this.orchestrationsState=new Wt(t,new Or("OrchestrationsState",e)),t.setCustomHandlers(()=>this.purgeHistoryDialogState.dialogOpen=!0,()=>this.cleanEntityStorageDialogState.dialogOpen=!0))}else{this.loginState=new ut;var a=new Ye(()=>this.loginState.taskHubName,()=>this.loginState.getAuthorizationHeaderAsync());this._backendClient=a,this.purgeHistoryDialogState=new gr(a),this.cleanEntityStorageDialogState=new br(a),this.orchestrationId?this.orchestrationDetailsState=new pr(this.orchestrationId,a,new yr("OrchestrationDetailsState")):(this.mainMenuState=new ja(a,this.purgeHistoryDialogState,this.cleanEntityStorageDialogState),this.orchestrationsState=new Wt(a,new yr("OrchestrationsState")))}}goto(){window.open("".concat(this._backendClient.routePrefixAndTaskHubName).concat("/orchestrations/").concat(this._typedInstanceId)),this._typedInstanceId="",this._suggestions=[]}get orchestrationId(){if(OrchestrationIdFromVsCode)return OrchestrationIdFromVsCode;var e=window.location.pathname.lastIndexOf("/orchestrations/");return e<0?"":window.location.pathname.substr(e+"/orchestrations/".length)}reloadSuggestions(){if(!this._typedInstanceId||this._typedInstanceId.length<2)this._suggestions=[];else{var e="/id-suggestions(prefix='".concat(this._typedInstanceId,"')");this._backendClient.call("GET",e).then(e=>{e&&this._typedInstanceId?this._suggestions=e:this._suggestions=[]})}}},Object(B.a)(mr.prototype,"typedInstanceId",[V.e],Object.getOwnPropertyDescriptor(mr.prototype,"typedInstanceId"),mr.prototype),Object(B.a)(mr.prototype,"suggestions",[V.e],Object.getOwnPropertyDescriptor(mr.prototype,"suggestions"),mr.prototype),Object(B.a)(mr.prototype,"isExactMatch",[V.e],Object.getOwnPropertyDescriptor(mr.prototype,"isExactMatch"),mr.prototype),ur=Object(B.a)(mr.prototype,"_suggestions",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hr=Object(B.a)(mr.prototype,"_typedInstanceId",[V.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),mr);document.body.style.backgroundColor=$t.palette.background.paper;var _r=new fr;c.render(l.createElement(m.a,{theme:$t},l.createElement(ka,{state:_r})),document.getElementById("root"))}},[[404,1,2]]]);
//# sourceMappingURL=main.3072d1ea.chunk.js.map