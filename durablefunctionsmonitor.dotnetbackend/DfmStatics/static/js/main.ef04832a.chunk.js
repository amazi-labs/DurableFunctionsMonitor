(this["webpackJsonpdurablefunctionsmonitor.react"]=this["webpackJsonpdurablefunctionsmonitor.react"]||[]).push([[0],{412:function(e,t,a){},414:function(e,t,a){},415:function(e,t,a){},419:function(e,t,a){},420:function(e,t,a){},422:function(e,t,a){},638:function(e,t,a){var n={"./locale":352,"./locale.js":352};function r(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=i,e.exports=r,r.id=638},679:function(e,t,a){},680:function(e,t,a){},681:function(e,t,a){},682:function(e,t,a){},683:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a(20),s=a(760),o=(a(412),a(413),a(18)),l=a(764),c=a(757),m=a(756),u=a(215),h=a(743),d=a(770),p=a(749),g=a(36),b=a(766),y=a(371),f=(a(414),a(730)),_=a(734),E=a(382),O=a(737),v=a(769),C=a(738),S=a(739),w=a(740),T=a(741),P=a(742),k=a(736),I=a(686),D=a(733),N=a(744);a(415);let j=Object(o.a)(n=class extends r.Component{render(){const e=this.props.state;return r.createElement("div",null,r.createElement(f.a,{color:e.isLoggedInAnonymously?"secondary":"inherit",onClick:t=>e.menuAnchorElement=t.currentTarget},r.createElement(D.a,null),r.createElement(l.a,{width:5}),r.createElement(_.a,{title:e.isLoggedInAnonymously?"Ensure this endpoint is not exposed to the public!":""},r.createElement(u.a,{color:e.isLoggedInAnonymously?"secondary":"inherit"},e.isLoggedInAnonymously?"Anonymous":e.userName))),!e.isLoggedInAnonymously&&r.createElement(E.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:()=>e.menuAnchorElement=void 0},r.createElement(O.a,{onClick:()=>e.logout()},"Login under a different name")),r.createElement(v.a,{open:!e.isLoggedIn},r.createElement(C.a,null,e.errorMessage?r.createElement(r.Fragment,null,r.createElement(S.a,{className:"login-progress"},r.createElement(N.a,{color:"secondary",fontSize:"large"})),r.createElement(T.a,{color:"secondary"},"Login failed. ",e.errorMessage)):e.allowedTaskHubNames?r.createElement(r.Fragment,null,r.createElement(P.a,null,"Select your Task Hub"),r.createElement(k.a,{className:"task-hub-list"},e.allowedTaskHubNames.map((t=>r.createElement(I.a,{button:!0,key:t},r.createElement(h.a,{href:e.locationPathName+t},t)))))):r.createElement(r.Fragment,null,r.createElement(S.a,{className:"login-progress"},r.createElement(w.a,null)),r.createElement(T.a,null,"Login in progress...")))))}})||n;var x,M,F,L=a(687),H=a(746),R=a(747),A=a(767),z=a(748),B=a(750),W=(a(419),a(377)),Y=a.n(W),V=a(7),U=a(6),q=a(773),G=a(745),K=a(208),J=a.n(K),Z=a(376),$=a.n(Z);a(420);let Q=(x=U.d.bound,Object(o.a)((F=class extends r.Component{render(){const e=this.props.state;return r.createElement(q.a,{className:"message-snackbar",anchorOrigin:{vertical:"top",horizontal:"right"},open:!!e.errorMessage,autoHideDuration:6e3,onClose:this.handleClose},r.createElement(G.a,{className:"error-snackbar-content",message:r.createElement("span",null,r.createElement($.a,{className:"error-icon"}),e.errorMessage),action:[r.createElement(L.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},r.createElement(J.a,null))]}))}handleClose(){this.props.state.errorMessage=""}},Object(V.a)(F.prototype,"handleClose",[x],Object.getOwnPropertyDescriptor(F.prototype,"handleClose"),F.prototype),M=F))||M);var X,ee,te=a(10),ae=(a(41),a(19)),ne=a.n(ae);let re=(X=class{get theme(){return DfmClientConfig.theme}get showTimeAsLocal(){return this._showTimeAsLocal}set showTimeAsLocal(e){var t;null===(t=localStorage)||void 0===t||t.setItem("showTimeAs",e?"Local":"UTC"),this._showTimeAsLocal=e}constructor(){var e;(Object(te.a)(this,"_showTimeAsLocal",ee,this),"Local"!==DfmClientConfig.showTimeAs)?this._showTimeAsLocal="Local"===(null===(e=localStorage)||void 0===e?void 0:e.getItem("showTimeAs")):this._showTimeAsLocal=!0}getMoment(e){return e&&e.isValid()?(this._showTimeAsLocal?e.local():e.utc(),e):e}setMoment(e){return e&&e.isValid()&&!this._showTimeAsLocal?ne()(e.toISOString(!0).slice(0,19)+"Z"):e}formatDateTimeString(e){if(!this._showTimeAsLocal||!e||e.length<11)return e;const t=e.lastIndexOf("."),a=t>=0?"."+e.substring(t+1,e.length-1):"";return ne()(e).format("YYYY-MM-DDTHH:mm:ss")+a}},Object(V.a)(X.prototype,"showTimeAsLocal",[U.e],Object.getOwnPropertyDescriptor(X.prototype,"showTimeAsLocal"),X.prototype),ee=Object(V.a)(X.prototype,"_showTimeAsLocal",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X);const ie=r.createContext(new re),se=new re;var oe,le,ce;let me=Object(o.a)((ce=le=class extends r.Component{constructor(...e){super(...e),this.context=void 0}componentDidMount(){this.props.state.setWindowTitle()}render(){const e=this.props.state;return r.createElement(r.Fragment,null,r.createElement(L.a,{color:"inherit",onClick:t=>e.menuAnchorElement=t.currentTarget},r.createElement(Y.a,null)),r.createElement(E.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:()=>e.menuAnchorElement=void 0},r.createElement(H.a,{row:!0,value:this.context.showTimeAsLocal.toString(),onChange:t=>{this.context.showTimeAsLocal="true"===t.target.value,e.menuAnchorElement=void 0,this.props.doRefresh()}},r.createElement(u.a,{className:"show-time-as-typography"},"Show time as:"),r.createElement(R.a,{control:r.createElement(A.a,{color:"primary"}),label:"UTC",value:"false"}),r.createElement(R.a,{control:r.createElement(A.a,{color:"primary"}),label:"Local",value:"true"})),r.createElement(O.a,{onClick:()=>e.showConnectionParamsDialog()},"Manage Storage Connection Settings..."),r.createElement(O.a,{onClick:()=>e.showPurgeHistoryDialog()},"Purge Instance History..."),r.createElement(O.a,{onClick:()=>e.showCleanEntityStorageDialog()},"Clean Entity Storage...")),r.createElement(v.a,{open:e.connectionParamsDialogOpen,onClose:()=>e.connectionParamsDialogOpen=!1},r.createElement(P.a,null,"Manage Storage Connection Settings"),r.createElement(C.a,null,e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(T.a,null,e.isReadonly?"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)":"The below values will be saved to local.settings.json file."),r.createElement(p.a,{autoFocus:!0,margin:"dense",label:"Hub Name",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},value:e.hubName,onChange:t=>e.hubName=t.target.value}),r.createElement(p.a,{autoFocus:!0,margin:"dense",label:"Azure Storage Connection String",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:e.isReadonly},InputLabelProps:{shrink:!0},value:e.connectionString,onChange:t=>e.connectionString=t.target.value}),r.createElement(Q,{state:e})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.connectionParamsDialogOpen=!1,color:"primary"},"Cancel"),!e.isReadonly&&r.createElement(f.a,{onClick:()=>e.saveConnectionParams(),disabled:!e.isDirty||!e.hubName||!e.connectionString||e.inProgress,color:"secondary"},"Save"))))}},le.contextType=ie,oe=ce))||oe;var ue=a(758),he=a(691),de=a(768),pe=a(692),ge=a(695),be=a(688),ye=a(765),fe=a(759),_e=a(762),Ee=a(138),Oe=a.n(Ee),ve=a(214),Ce=a.n(ve),Se=a(379),we=a.n(Se);a(422);const Te=["Timestamp","EventType","Name","ScheduledTime","Result","Details"],Pe=["Completed","Running","Failed","Pending","Terminated","Canceled","ContinuedAsNew"];class ke{constructor(){this.instanceId=void 0,this.name=void 0,this.entityId=void 0,this.runtimeStatus=void 0,this.entityType=void 0,this.lastEvent=void 0,this.input=void 0,this.customStatus=void 0,this.output=void 0,this.createdTime=void 0,this.lastUpdatedTime=void 0,this.tabTemplateNames=void 0}static getFunctionName(e){return"DurableEntity"===e.entityType?e.entityId.name:e.name}}const Ie=["instanceId","name","createdTime","lastUpdatedTime","runtimeStatus","lastEvent","input","output","customStatus"];var De,Ne,je=a(30);class xe{static isValidMoment(e){return!!e&&e.isValid()&&e.isAfter(xe.MinMoment)&&e.isBefore(xe.MaxMoment)}}xe.MinMoment=ne()("1900-01-01"),xe.MaxMoment=ne()("2100-01-01");let Me=(De=class{constructor(){Object(te.a)(this,"errorMessage",Ne,this)}},Ne=Object(V.a)(De.prototype,"errorMessage",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),De);var Fe,Le,He;let Re=(Fe=class{constructor(){Object(te.a)(this,"inProgress",Le,this),Object(te.a)(this,"isCancelled",He,this)}},Le=Object(V.a)(Fe.prototype,"inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),He=Object(V.a)(Fe.prototype,"isCancelled",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Fe);var Ae,ze,Be,We,Ye,Ve;let Ue=(Ae=class{get hiddenColumns(){return this._hiddenColumns}get orchestrations(){return this._orchestrations}get orderByDirection(){return this._orderByDirection}get orderBy(){return this._orderBy}set orderBy(e){this._orderBy!==e?(this._orderBy=e,this._orderByDirection="asc"):"desc"===this._orderByDirection?this.resetOrderBy():this._orderByDirection="desc",this._refresh()}get backendClient(){return this._backendClient}constructor(e,t,a){this._backendClient=e,this._localStorage=t,this._refresh=a,Object(te.a)(this,"columnUnderMouse",ze,this),Object(te.a)(this,"_orchestrations",Be,this),Object(te.a)(this,"_orderByDirection",We,this),Object(te.a)(this,"_orderBy",Ye,this),Object(te.a)(this,"_hiddenColumns",Ve,this),this._noMorePagesToLoad=!1,this._pageSize=50;const n=this._localStorage.getItem("orderBy");n&&(this._orderBy=n);const r=this._localStorage.getItem("orderByDirection");r&&(this._orderByDirection=r);const i=this._localStorage.getItem("hiddenColumns");i&&(this._hiddenColumns=i.split("|"))}hideColumn(e){this._hiddenColumns.push(e),this._localStorage.setItem("hiddenColumns",this._hiddenColumns.join("|"))}unhide(){this._hiddenColumns=[],this._localStorage.removeItem("hiddenColumns"),this._refresh()}resetOrderBy(){this._orderBy="",this._orderByDirection="asc"}reset(){this._orchestrations=[],this._noMorePagesToLoad=!1}load(e,t,a=!1){if(a)this._noMorePagesToLoad=!1;else{if(this._noMorePagesToLoad)return Promise.resolve();this._localStorage.setItems([{fieldName:"orderBy",value:this._orderBy},{fieldName:"orderByDirection",value:this._orderByDirection}])}const n=a?0:this._orchestrations.length,r=this._orderBy?"&$orderby=".concat(this._orderBy," ").concat(this.orderByDirection):"",i=this._hiddenColumns.length?"&hidden-columns=".concat(this._hiddenColumns.join("|")):"",s="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(n).concat(e).concat(r).concat(i);return this._backendClient.call("GET",s).then((e=>{t.isCancelled||(a?this._orchestrations=e:this._orchestrations.push(...e),e.length||(this._noMorePagesToLoad=!0))}))}},ze=Object(V.a)(Ae.prototype,"columnUnderMouse",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(V.a)(Ae.prototype,"hiddenColumns",[U.e],Object.getOwnPropertyDescriptor(Ae.prototype,"hiddenColumns"),Ae.prototype),Object(V.a)(Ae.prototype,"orchestrations",[U.e],Object.getOwnPropertyDescriptor(Ae.prototype,"orchestrations"),Ae.prototype),Object(V.a)(Ae.prototype,"orderByDirection",[U.e],Object.getOwnPropertyDescriptor(Ae.prototype,"orderByDirection"),Ae.prototype),Object(V.a)(Ae.prototype,"orderBy",[U.e],Object.getOwnPropertyDescriptor(Ae.prototype,"orderBy"),Ae.prototype),Be=Object(V.a)(Ae.prototype,"_orchestrations",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),We=Object(V.a)(Ae.prototype,"_orderByDirection",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"asc"}}),Ye=Object(V.a)(Ae.prototype,"_orderBy",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ve=Object(V.a)(Ae.prototype,"_hiddenColumns",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ae);var qe,Ge,Ke,Je,Ze,$e=a(73),Qe=a.n($e);let Xe=(Ze=Je=class e{constructor(){Object(te.a)(this,"_diagramCode",Ge,this),Object(te.a)(this,"_diagramSvg",Ke,this)}initMermaidWhenNeeded(){e._mermaidInitialized||(Qe.a.initialize({startOnLoad:!0,sequence:{noteMargin:0,boxMargin:5,boxTextMargin:5},flowchart:{curve:"Basis",useMaxWidth:!0,htmlLabels:!1}}),e._mermaidInitialized=!0)}escapeTitle(e){return e.replace(/[@:;]/g," ")}formatDuration(e){var t="";if(isNaN(e)||e<0)return t;const a=Math.floor(e/864e5);if(a>30)return t;var n=0;a>0&&(t+=a.toFixed(0)+"d",++n,e%=864e5);const r=Math.floor(e/36e5);if(r>0){if(t+=r.toFixed(0)+"h",++n>1)return"(".concat(t,")");e%=36e5}const i=Math.floor(e/6e4);if(i>0){if(t+=i.toFixed(0)+"m",++n>1)return"(".concat(t,")");e%=6e4}const s=Math.floor(e/1e3);if(s>0){if(t+=s.toFixed(0)+"s",++n>1)return"(".concat(t,")");e%=1e3}return e>0&&(t+=e.toFixed(0)+"ms"),t||(t="0ms"),"(".concat(t,")")}formatDurationInSeconds(e){return Math.round(e/1e3).toFixed(0)+"s"}},Je._mermaidInitialized=!1,qe=Ze,Ge=Object(V.a)(qe.prototype,"_diagramCode",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(V.a)(qe.prototype,"_diagramSvg",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe);var et;let tt=(et=class extends Xe{get rawHtml(){return this._diagramSvg}get diagramCode(){return this._diagramCode}constructor(e){super(),this._backendClient=e}reset(){this._diagramCode="",this._diagramSvg=""}load(e,t,a){return this.initMermaidWhenNeeded(),new Promise(((a,n)=>{const r="/orchestrations?$top=500&$orderby=createdTime asc".concat(e);this._backendClient.call("GET",r).then((e=>{t.isCancelled?a():Promise.all(this.renderDiagram(e)).then((t=>{this._diagramCode="gantt \n"+"title Gantt Chart (".concat(e.length," instances shown) \n")+"dateFormat YYYY-MM-DDTHH:mm:ss \n"+t.join(""),this._diagramSvg="";try{Qe.a.render("mermaidSvgId",this._diagramCode,(e=>{this._diagramSvg=e,a()}))}catch(r){n(r)}}),n)}),n)}))}renderDiagram(e){const t=[];var a,n="",r=0,i=Object(je.a)(e);try{for(i.s();!(a=i.n()).done;){const e=a.value;var s="";const i=ke.getFunctionName(e);i!==n&&(s="section ".concat(++r,". ").concat(this.escapeTitle(i)," \n"),n=i);const o="DurableEntity"===e.entityType?e.entityId.key:e.instanceId,l=new Date(e.lastUpdatedTime).getTime()-new Date(e.createdTime).getTime();s+="".concat(this.escapeTitle(o)," ").concat(this.formatDuration(l),": active, ").concat(this.formatDateTime(e.createdTime),", ").concat(this.formatDurationInSeconds(l<1e3?1e3:l)," \n"),t.push(Promise.resolve(s))}}catch(o){i.e(o)}finally{i.f()}return t}formatDateTime(e){return se.showTimeAsLocal?ne()(e).format("YYYY-MM-DDTHH:mm:ss"):e.substr(0,19)}},Object(V.a)(et.prototype,"rawHtml",[U.e],Object.getOwnPropertyDescriptor(et.prototype,"rawHtml"),et.prototype),Object(V.a)(et.prototype,"diagramCode",[U.e],Object.getOwnPropertyDescriptor(et.prototype,"diagramCode"),et.prototype),et);var at,nt,rt,it;let st=(at=class{get zoomedIn(){return this._zoomedIn}get histograms(){return this._histograms}get numOfInstancesShown(){return this._numOfInstancesShown}get counts(){return this._counts}get timeRangeInMilliseconds(){return this._timeRangeInMilliseconds}constructor(e,t){this._backendClient=e,this._filterState=t,Object(te.a)(this,"_histograms",nt,this),this._counts={},Object(te.a)(this,"_numOfInstancesShown",rt,this),Object(te.a)(this,"_zoomedIn",it,this),this._originalTimeInterval=null,this._applyingZoom=!1,this._timeRangeInMilliseconds=0,this._numOfIntervals=200,this._pageSize=1e3}reset(){}load(e,t,a){this._applyingZoom||this._zoomedIn||(this._originalTimeInterval={timeFrom:this._filterState.timeFrom,timeTill:this._filterState.timeTill,timeRange:this._filterState.timeRange}),this._numOfInstancesShown=0,this._histograms={},this._counts={};const n=this._filterState.timeFrom.valueOf();var r=Math.ceil((this._filterState.timeTill.valueOf()-n)/this._numOfIntervals);return r<=0&&(r=1),this._timeRangeInMilliseconds=this._filterState.timeTill.valueOf()-this._filterState.timeFrom.valueOf(),this.loadNextBatch(e,n,r,0,t)}applyZoom(e,t){this._numOfInstancesShown=0,this._filterState.cancel();const a=1e3*Math.floor(e.getTime()/1e3),n=1e3*Math.ceil(t.getTime()/1e3);this._filterState.timeFrom=ne()(a),this._filterState.timeTill=ne()(n),this._applyingZoom=!0;try{this._filterState.reloadOrchestrations()}finally{this._applyingZoom=!1}this._zoomedIn=!0}resetZoom(){this._zoomedIn&&this._originalTimeInterval&&(this._zoomedIn=!1,this._filterState.cancel(),this._filterState.timeFrom=this._originalTimeInterval.timeFrom,this._filterState.timeTill=this._originalTimeInterval.timeTill,this._filterState.timeRange=this._originalTimeInterval.timeRange)}loadNextBatch(e,t,a,n,r){const i="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(this._numOfInstancesShown).concat(e);return this._backendClient.call("GET",i).then((i=>{if(r.isCancelled)return Promise.resolve();var s,o=Object(je.a)(i);try{for(o.s();!(s=o.n()).done;){var l=s.value;const e=ke.getFunctionName(l);if(!this._histograms[e]){const n=[];for(var c=0;c<this._numOfIntervals;c++)n[c]={x0:t+c*a,x:t+(c+1)*a,y:0};this._histograms[e]=n}const n=Math.floor((new Date(l.createdTime).getTime()-t)/a);n<0||n>=this._numOfIntervals||(this._histograms[e][n].y+=1,this._counts[e]?this._counts[e]+=1:this._counts[e]=1)}}catch(m){o.e(m)}finally{o.f()}return this._numOfInstancesShown+=i.length,i.length===this._pageSize?this.loadNextBatch(e,t,a,n+1,r):void 0}))}},Object(V.a)(at.prototype,"zoomedIn",[U.e],Object.getOwnPropertyDescriptor(at.prototype,"zoomedIn"),at.prototype),Object(V.a)(at.prototype,"histograms",[U.e],Object.getOwnPropertyDescriptor(at.prototype,"histograms"),at.prototype),Object(V.a)(at.prototype,"numOfInstancesShown",[U.e],Object.getOwnPropertyDescriptor(at.prototype,"numOfInstancesShown"),at.prototype),nt=Object(V.a)(at.prototype,"_histograms",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),rt=Object(V.a)(at.prototype,"_numOfInstancesShown",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),it=Object(V.a)(at.prototype,"_zoomedIn",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),at);class ot{constructor(){this._values={};const e=window.location.search.substr(1).split("&");var t,a=Object(je.a)(e);try{for(a.s();!(t=a.n()).done;){const e=t.value.split("=");e.length>1&&(this._values[e[0]]=decodeURIComponent(e[1]))}}catch(n){a.e(n)}finally{a.f()}}get values(){return this._values}apply(){var e="";for(var t in this._values)e&&(e+="&"),e+=t+"="+encodeURIComponent(this._values[t]);window.history.replaceState(null,null,e?"?"+e:"")}}var lt,ct,mt,ut,ht,dt,pt,gt,bt,yt,ft,_t;let Et,Ot,vt;!function(e){e[e.Equals=0]="Equals",e[e.StartsWith=1]="StartsWith",e[e.Contains=2]="Contains",e[e.NotEquals=3]="NotEquals",e[e.NotStartsWith=4]="NotStartsWith",e[e.NotContains=5]="NotContains"}(Et||(Et={})),function(e){e[e.List=0]="List",e[e.Histogram=1]="Histogram",e[e.Gantt=2]="Gantt"}(Ot||(Ot={})),function(e){e[e.Custom=0]="Custom",e[e.LastMinute=1]="LastMinute",e[e.Last10Minutes=2]="Last10Minutes",e[e.LastHour=3]="LastHour",e[e.Last24Hours=4]="Last24Hours",e[e.Last7Days=5]="Last7Days",e[e.Last30Days=6]="Last30Days",e[e.Last90Days=7]="Last90Days"}(vt||(vt={}));let Ct=(lt=class extends Me{get tabIndex(){return this._tabIndex}set tabIndex(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.reloadOrchestrations())}get selectedTabState(){return this._tabStates[this._tabIndex]}get inProgress(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadOrchestrations(!0)}get timeFrom(){switch(this._timeRange){case vt.LastMinute:return ne()().subtract(1,"minutes");case vt.Last10Minutes:return ne()().subtract(10,"minutes");case vt.LastHour:return ne()().subtract(1,"hours");case vt.Last24Hours:return ne()().subtract(1,"days");case vt.Last7Days:return ne()().subtract(7,"days");case vt.Last30Days:return ne()().subtract(30,"days");case vt.Last90Days:return ne()().subtract(90,"days");default:return this._timeFrom}}set timeFrom(e){this._timeFrom=e,this._timeRange=vt.Custom,this.listState.resetOrderBy()}get timeTill(){return this._timeRange||!this._timeTill?ne()():this._timeTill}set timeTill(e){this._timeTill=e,this._timeRange=vt.Custom,this.listState.resetOrderBy()}get timeTillEnabled(){return!!this._timeTill}set timeTillEnabled(e){this._timeTill=e?ne()():null,e||(this.listState.resetOrderBy(),this.reloadOrchestrations())}get timeRange(){return this._timeRange}set timeRange(e){this.menuAnchorElement=void 0,this._timeRange=e,this.listState.resetOrderBy(),this.reloadOrchestrations()}get filterValue(){return this._filterValue}set filterValue(e){this._filterValue=e}get filterOperator(){return this._filterOperator}set filterOperator(e){this._filterOperator=e,this._filterValue&&"0"!==this._filteredColumn&&this.reloadOrchestrations()}get filteredColumn(){return this._filteredColumn}set filteredColumn(e){this._filteredColumn=e,this._filterValue&&("0"===this._filteredColumn&&(this._filterValue=""),this.reloadOrchestrations())}get showStatuses(){return this._showStatuses}isStatusChecked(e){return e?!this._showStatuses||!!this._showStatuses.includes(e):!this._showStatuses}setStatusChecked(e,t){if(e)t?(this._showStatuses||(this._showStatuses=[]),this._showStatuses.push(t)):this._showStatuses=null;else if(t){this._showStatuses||(this._showStatuses=[]);const e=this._showStatuses.indexOf(t);e>=0&&this._showStatuses.splice(e,1)}else this._showStatuses=[];this._refreshToken&&clearTimeout(this._refreshToken),this._refreshToken=setTimeout((()=>this.reloadOrchestrations()),this._delayedRefreshDelay)}rescheduleDelayedRefresh(){this._refreshToken&&(clearTimeout(this._refreshToken),this._refreshToken=setTimeout((()=>this.reloadOrchestrations()),this._delayedRefreshDelay))}get showLastEventColumn(){return"lastEvent"===this._filteredColumn&&!!this._oldFilterValue}get backendClient(){return this._backendClient}constructor(e,t){var a;super(),this._backendClient=e,this._localStorage=t,Object(te.a)(this,"menuAnchorElement",ct,this),Object(te.a)(this,"_tabIndex",mt,this),Object(te.a)(this,"_cancelToken",ut,this),Object(te.a)(this,"_autoRefresh",ht,this),Object(te.a)(this,"_timeFrom",dt,this),Object(te.a)(this,"_timeTill",pt,this),Object(te.a)(this,"_timeRange",gt,this),Object(te.a)(this,"_filterValue",bt,this),Object(te.a)(this,"_filterOperator",yt,this),Object(te.a)(this,"_filteredColumn",ft,this),Object(te.a)(this,"_showStatuses",_t,this),this._tabStates=[new Ue(this._backendClient,this._localStorage,(()=>this.reloadOrchestrations())),new st(this._backendClient,this),new tt(this._backendClient)],this._refreshToken=void 0,this._delayedRefreshDelay=2500,this._oldFilterValue="",this._oldTimeFrom=void 0,this._oldTimeTill=void 0;const n=this._localStorage.getItem("timeFrom");a=n?ne()(n):ne()().subtract(1,"days"),this._timeFrom=a,this._oldTimeFrom=a;const r=this._localStorage.getItem("timeTill");r&&(this._timeTill=ne()(r),this._oldTimeTill=this._timeTill);const i=this._localStorage.getItem("timeRange");if(i){const e=new ot;e.values.timeFrom||e.values.timeTill||(this._timeRange=vt[i])}const s=this._localStorage.getItem("filteredColumn");s&&(this._filteredColumn=s);const o=this._localStorage.getItem("filterOperator");o&&(this._filterOperator=Et[o]);const l=this._localStorage.getItem("filterValue");l&&(this._filterValue=l,this._oldFilterValue=l);const c=this._localStorage.getItem("showStatuses");c&&(this._showStatuses=JSON.parse(c));const m=this._localStorage.getItem("autoRefresh");m&&(this._autoRefresh=Number(m));const u=this._localStorage.getItem("tabIndex");if(u){const e=Number(u);e>=0&&e<this._tabStates.length&&(this._tabIndex=e)}}applyTimeFrom(){xe.isValidMoment(this._timeFrom)&&this._oldTimeFrom!==this._timeFrom&&this.reloadOrchestrations()}applyTimeTill(){xe.isValidMoment(this._timeTill)&&this._oldTimeTill!==this._timeTill&&this.reloadOrchestrations()}applyFilterValue(){this._oldFilterValue!==this._filterValue&&this.reloadOrchestrations()}reloadOrchestrations(){this._refreshToken&&(clearTimeout(this._refreshToken),this._refreshToken=null);var e,t=Object(je.a)(this._tabStates);try{for(t.s();!(e=t.n()).done;){e.value.reset()}}catch(a){t.e(a)}finally{t.f()}xe.isValidMoment(this._timeFrom)||(this._timeFrom=this._oldTimeFrom),this._timeTill&&!xe.isValidMoment(this._timeTill)&&(this._timeTill=this._oldTimeTill),this._localStorage.setItems([{fieldName:"timeFrom",value:this._timeRange?null:this._timeFrom.toISOString()},{fieldName:"timeTill",value:this._timeTill&&!this._timeRange?this._timeTill.toISOString():null},{fieldName:"timeRange",value:this._timeRange?vt[this._timeRange]:null},{fieldName:"filteredColumn",value:this._filteredColumn},{fieldName:"filterOperator",value:Et[this._filterOperator]},{fieldName:"filterValue",value:this._filterValue?this._filterValue:null},{fieldName:"showStatuses",value:this._showStatuses?JSON.stringify(this._showStatuses):null}]),this.loadOrchestrations(),this._oldFilterValue=this._filterValue,this._oldTimeFrom=this._timeFrom,this._oldTimeTill=this._timeTill}cancel(){this._cancelToken.isCancelled=!0,this._cancelToken=new Re}loadOrchestrations(e=!1){const t=this._cancelToken;if(!t.inProgress){t.inProgress=!0;var a="&$filter=createdTime ge '".concat(this.timeFrom.toISOString(),"' and createdTime le '").concat(this.timeTill.toISOString(),"'");if(this._showStatuses&&(a+=" and runtimeStatus in (".concat(this._showStatuses.map((e=>"'".concat(e,"'"))).join(","),")")),this._filterValue&&"0"!==this._filteredColumn){a+=" and ";const e=encodeURIComponent(this._filterValue);switch(this._filterOperator){case Et.Equals:a+="".concat(this._filteredColumn," eq '").concat(e,"'");break;case Et.StartsWith:a+="startswith(".concat(this._filteredColumn,", '").concat(e,"')");break;case Et.Contains:a+="contains(".concat(this._filteredColumn,", '").concat(e,"')");break;case Et.NotEquals:a+="".concat(this._filteredColumn," ne '").concat(e,"'");break;case Et.NotStartsWith:a+="startswith(".concat(this._filteredColumn,", '").concat(e,"') eq false");break;case Et.NotContains:a+="contains(".concat(this._filteredColumn,", '").concat(e,"') eq false")}}this.selectedTabState.load(a,t,e).then((()=>{this._refreshToken&&clearTimeout(this._refreshToken),this._autoRefresh&&(this._refreshToken=setTimeout((()=>{this.loadOrchestrations(!0)}),1e3*this._autoRefresh))}),(e=>{this._autoRefresh=0,t.isCancelled||(this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," "))})).finally((()=>{t.inProgress=!1}))}}get listState(){return this._tabStates[0]}},Object(V.a)(lt.prototype,"tabIndex",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"tabIndex"),lt.prototype),Object(V.a)(lt.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"inProgress"),lt.prototype),Object(V.a)(lt.prototype,"autoRefresh",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"autoRefresh"),lt.prototype),Object(V.a)(lt.prototype,"timeFrom",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"timeFrom"),lt.prototype),Object(V.a)(lt.prototype,"timeTill",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"timeTill"),lt.prototype),Object(V.a)(lt.prototype,"timeTillEnabled",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"timeTillEnabled"),lt.prototype),Object(V.a)(lt.prototype,"timeRange",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"timeRange"),lt.prototype),ct=Object(V.a)(lt.prototype,"menuAnchorElement",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(V.a)(lt.prototype,"filterValue",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"filterValue"),lt.prototype),Object(V.a)(lt.prototype,"filterOperator",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"filterOperator"),lt.prototype),Object(V.a)(lt.prototype,"filteredColumn",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"filteredColumn"),lt.prototype),Object(V.a)(lt.prototype,"showStatuses",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"showStatuses"),lt.prototype),Object(V.a)(lt.prototype,"showLastEventColumn",[U.e],Object.getOwnPropertyDescriptor(lt.prototype,"showLastEventColumn"),lt.prototype),mt=Object(V.a)(lt.prototype,"_tabIndex",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ot.List}}),ut=Object(V.a)(lt.prototype,"_cancelToken",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Re}}),ht=Object(V.a)(lt.prototype,"_autoRefresh",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dt=Object(V.a)(lt.prototype,"_timeFrom",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=Object(V.a)(lt.prototype,"_timeTill",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=Object(V.a)(lt.prototype,"_timeRange",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return vt.Custom}}),bt=Object(V.a)(lt.prototype,"_filterValue",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),yt=Object(V.a)(lt.prototype,"_filterOperator",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Et.Equals}}),ft=Object(V.a)(lt.prototype,"_filteredColumn",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0"}}),_t=Object(V.a)(lt.prototype,"_showStatuses",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lt);var St=a(694),wt=a(257),Tt=a(751),Pt=a(752),kt=a(753),It=a(754),Dt=a(771),Nt=a(755),jt=a(387),xt=a(118),Mt=a.n(xt),Ft=a(761);const Lt=DfmRoutePrefix?"/".concat(DfmRoutePrefix,"/"):"/",Ht=Lt+"a/p/i";class Rt{get isVsCode(){return!1}get routePrefixAndTaskHubName(){return Lt+this._getTaskHubName()}constructor(e,t){this._getTaskHubName=e,this._getAuthorizationHeaderAsync=t}call(e,t,a){return["get","post","put"].includes(e.toLowerCase())?new Promise(((n,r)=>{this._getAuthorizationHeaderAsync().then((i=>{Mt.a.request({url:Ht+"/"+this._getTaskHubName()+t,method:e,data:a,headers:i}).then((e=>{n(e.data)}),r)}))})):Promise.reject(new Error("Method ".concat(e," not supported")))}}var At,zt,Bt,Wt,Yt,Vt;const Ut="/orchestrations/";let qt=(At=class extends Me{get isLoggedIn(){return this._isLoggedIn}get isLoggedInAnonymously(){return!this._userName}get userName(){return this._userName}get taskHubName(){return this._taskHubName}get allowedTaskHubNames(){return this._allowedTaskHubNames}get locationPathName(){var e=window.location.pathname;const t=e.lastIndexOf(Ut);return t>=0&&(e=e.substring(0,t)),e.endsWith("/")||(e+="/"),e}get rootUri(){const e=this.tryGetTaskHubName();if(e){const t=window.location.href.toLowerCase().lastIndexOf("/"+e.toLowerCase());if(t>=0)return window.location.href.substring(0,t)}return window.location.origin+(window.location.pathname.endsWith("/")?window.location.pathname.substr(0,window.location.pathname.length-1):window.location.pathname)}constructor(){super(),Object(te.a)(this,"menuAnchorElement",zt,this),Object(te.a)(this,"_isLoggedIn",Bt,this),Object(te.a)(this,"_userName",Wt,this),Object(te.a)(this,"_taskHubName",Yt,this),Object(te.a)(this,"_allowedTaskHubNames",Vt,this),this._aadApp=void 0,Mt.a.defaults.maxRedirects=0,this.login()}login(){const e="".concat(Ht,"/easyauth-config");Mt.a.get(e).then((e=>this.loginWithEasyAuthConfig(e.data)),(e=>{this.errorMessage="".concat(e.message,".").concat(e.response?e.response.data:"")}))}logout(){this.menuAnchorElement=void 0,this._aadApp?this._aadApp.logout():window.location.replace("/.auth/logout")}getAuthorizationHeaderAsync(){return this._aadApp?new Promise(((e,t)=>{const a={scopes:[this._aadApp.getCurrentConfiguration().auth.clientId]};this._aadApp.acquireTokenSilent(a).then((t=>{var a=t.accessToken;a||(console.log("DFM: accessToken is null, so using idToken.rawIdToken instead"),a=t.idToken.rawIdToken),e({Authorization:"Bearer ".concat(a)})}),(e=>{console.log("DFM: acquireTokenSilent() failed (".concat(e,"), so calling acquireTokenRedirect()...")),this._aadApp.acquireTokenRedirect(a)}))})):new Promise(((e,t)=>e(void 0)))}loginWithEasyAuthConfig(e){if(!e.clientId)return this._userName=e.userName,Mt.a.interceptors.response.use((e=>e),(e=>("Network Error"===e.message&&window.location.reload(!0),Promise.reject(e)))),void this.initializeTaskHubNameAndConfirmLogin();this._aadApp=new Ft.a({auth:{clientId:e.clientId,authority:e.authority,redirectUri:this.rootUri}}),this._aadApp.handleRedirectCallback((()=>{}),((e,t)=>{console.log("Failed to handle login redirect. name: ".concat(e.name,", message: ").concat(e.message,", errorCode: ").concat(e.errorCode,", errorMessage: ").concat(e.errorMessage,", accountState: ").concat(t))}));const t=this._aadApp.getAccount();t?(this._userName=t.userName,this.initializeTaskHubNameAndConfirmLogin()):this._aadApp.loginRedirect()}initializeTaskHubNameAndConfirmLogin(){const e=this.tryGetTaskHubName();if(e)return this._taskHubName=e,void(this._isLoggedIn=!0);this.getAuthorizationHeaderAsync().then((e=>{const t="".concat(Ht,"/task-hub-names");Mt.a.get(t,{headers:e}).then((e=>{const t=e.data;1===t.length?window.location.pathname=this.locationPathName+t[0]:this._allowedTaskHubNames=t}),(e=>{this.errorMessage="".concat(e.message,".").concat(e.response?e.response.data:"")}))}))}tryGetTaskHubName(){const e=this.locationPathName;if(e.toLowerCase().endsWith("/".concat(DfmRoutePrefix.toLowerCase(),"/")))return null;const t=e.split("/").filter((e=>!!e));return t.length<1?null:t[t.length-1]}},Object(V.a)(At.prototype,"isLoggedIn",[U.e],Object.getOwnPropertyDescriptor(At.prototype,"isLoggedIn"),At.prototype),Object(V.a)(At.prototype,"isLoggedInAnonymously",[U.e],Object.getOwnPropertyDescriptor(At.prototype,"isLoggedInAnonymously"),At.prototype),Object(V.a)(At.prototype,"userName",[U.e],Object.getOwnPropertyDescriptor(At.prototype,"userName"),At.prototype),Object(V.a)(At.prototype,"taskHubName",[U.e],Object.getOwnPropertyDescriptor(At.prototype,"taskHubName"),At.prototype),Object(V.a)(At.prototype,"allowedTaskHubNames",[U.e],Object.getOwnPropertyDescriptor(At.prototype,"allowedTaskHubNames"),At.prototype),zt=Object(V.a)(At.prototype,"menuAnchorElement",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=Object(V.a)(At.prototype,"_isLoggedIn",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wt=Object(V.a)(At.prototype,"_userName",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Object(V.a)(At.prototype,"_taskHubName",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=Object(V.a)(At.prototype,"_allowedTaskHubNames",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At);var Gt=a(381);const Kt=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME:se.theme,Jt=Object(Gt.a)({palette:{type:"dark"===Kt?"dark":"light"}}),Zt="dark"===Jt.palette.type?{backgroundColor:"#aaa"}:{};function $t(e){var t=null;switch(e){case"Failed":t=Qt(Jt.palette.error.light,.2);break;case"Completed":t=Qt(Jt.palette.success.light,.2);break;case"Running":t=Qt(Jt.palette.warning.light,.2);break;case"Terminated":t=Qt(Jt.palette.background.paper,.1)}return t?{backgroundColor:t}:{}}function Qt(e,t){return e.length>4?"rgba(".concat(parseInt(e.slice(1,3),16),", ").concat(parseInt(e.slice(3,5),16),", ").concat(parseInt(e.slice(5,7),16),", ").concat(t.toFixed(1),")"):"rgba(".concat(parseInt(e.slice(1,2),16),", ").concat(parseInt(e.slice(2,3),16),", ").concat(parseInt(e.slice(3,4),16),", ").concat(t.toFixed(1),")")}var Xt,ea,ta;let aa=(Xt=U.d.bound,Object(o.a)((ta=class extends r.Component{render(){var e,t;return this.props.backendClient.isVsCode?r.createElement(h.a,{color:"dark"===Jt.palette.type?"inherit":"primary",href:"/",onClick:this.onLinkClicked},null!==(e=this.props.title)&&void 0!==e?e:this.props.orchestrationId):r.createElement(h.a,{color:"dark"===Jt.palette.type?"inherit":"primary",href:"".concat(this.props.backendClient.routePrefixAndTaskHubName).concat(Ut).concat(this.extraSanitizeHrefComponent(this.props.orchestrationId)),target:"_blank"},null!==(t=this.props.title)&&void 0!==t?t:this.props.orchestrationId)}onLinkClicked(){this.props.backendClient.call("OpenInNewWindow",this.props.orchestrationId)}extraSanitizeHrefComponent(e){return e.replace(/javascript:/gi,"")}},Object(V.a)(ta.prototype,"onLinkClicked",[Xt],Object.getOwnPropertyDescriptor(ta.prototype,"onLinkClicked"),ta.prototype),ea=ta))||ea);function na(e){if(!e)return"";const t=JSON.stringify(e);return t.length>1024?"[".concat(t.length," symbols long JSON]"):t}var ra,ia,sa;let oa=Object(o.a)((sa=ia=class extends r.Component{constructor(...e){super(...e),this.context=void 0}render(){const e=this.props.state;return r.createElement(r.Fragment,null,r.createElement(St.a,{className:"items-count-label"},!!e.orchestrations.length&&r.createElement(r.Fragment,null,"".concat(e.orchestrations.length," items shown"),!!e.hiddenColumns.length&&r.createElement(r.Fragment,null,", ".concat(e.hiddenColumns.length," columns hidden "),"(",r.createElement(h.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:()=>e.unhide()},"unhide"),")"))),r.createElement(wt.a,{elevation:0},this.renderTable(e)))}renderTable(e){if(!e.orchestrations.length)return r.createElement(u.a,{variant:"h5",className:"empty-table-placeholder"},"This list is empty");const t=Ie.filter((e=>!!this.props.showLastEventColumn||"lastEvent"!==e));return r.createElement(Tt.a,{size:"small"},r.createElement(Pt.a,null,r.createElement(kt.a,null,t.map((a=>{const n=t.length<=e.hiddenColumns.length+1;return!e.hiddenColumns.includes(a)&&r.createElement(It.a,{key:a,onMouseEnter:()=>e.columnUnderMouse=a,onMouseLeave:()=>e.columnUnderMouse=""},r.createElement(Dt.a,{active:e.orderBy===a,direction:e.orderByDirection,onClick:()=>e.orderBy=a},a),e.columnUnderMouse===a&&!n&&r.createElement(L.a,{color:"inherit",size:"small",className:"column-hide-button",onClick:()=>e.hideColumn(a)},r.createElement(J.a,null)))})))),r.createElement(Nt.a,null,e.orchestrations.map((t=>{const a=$t(t.runtimeStatus),n={verticalAlign:"top"};return r.createElement(kt.a,{key:t.instanceId,style:a},!e.hiddenColumns.includes("instanceId")&&r.createElement(It.a,{className:"instance-id-cell",style:n},r.createElement(aa,{orchestrationId:t.instanceId,backendClient:this.props.backendClient})),!e.hiddenColumns.includes("name")&&r.createElement(It.a,{className:"name-cell",style:n},t.name),!e.hiddenColumns.includes("createdTime")&&r.createElement(It.a,{className:"datetime-cell",style:n},this.context.formatDateTimeString(t.createdTime)),!e.hiddenColumns.includes("lastUpdatedTime")&&r.createElement(It.a,{className:"datetime-cell",style:n},this.context.formatDateTimeString(t.lastUpdatedTime)),!e.hiddenColumns.includes("runtimeStatus")&&r.createElement(It.a,{style:n},t.runtimeStatus),!e.hiddenColumns.includes("lastEvent")&&this.props.showLastEventColumn&&r.createElement(It.a,{style:n},t.lastEvent),!e.hiddenColumns.includes("input")&&r.createElement(It.a,{className:"long-text-cell",style:n},r.createElement(jt.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:na(t.input)})),!e.hiddenColumns.includes("output")&&r.createElement(It.a,{className:"output-cell",style:n},r.createElement(jt.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:na(t.output)})),!e.hiddenColumns.includes("customStatus")&&r.createElement(It.a,{className:"output-cell",style:n},r.createElement(jt.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:na(t.customStatus)})))}))))}},ia.contextType=ie,ra=sa))||ra;var la,ca,ma,ua=a(119);let ha=Object(o.a)((ma=ca=class extends r.Component{constructor(...e){super(...e),this.context=void 0}render(){const e=this.props.state,t=Object.keys(e.histograms).sort();return r.createElement(r.Fragment,null,r.createElement(St.a,{className:"items-count-label"},"".concat(e.numOfInstancesShown," items shown"),e.zoomedIn&&r.createElement(r.Fragment,null,", ",r.createElement(h.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:()=>e.resetZoom()},"reset zoom (Ctrl+Z)"))),r.createElement(ua.e,{width:window.innerWidth-40,height:window.innerHeight-400,xType:"time",stackBy:"y",margin:{left:80,right:10,top:20}},!!e.numOfInstancesShown&&r.createElement(ua.f,{tickTotal:7}),r.createElement(ua.d,{tickTotal:7,tickFormat:t=>this.formatTimeTick(t,e.timeRangeInMilliseconds)}),t.map((t=>r.createElement(ua.c,{key:t,stroke:"white",color:this.getColorCodeForInstanceType(t),data:e.histograms[t]}))),!!e.numOfInstancesShown&&r.createElement(ua.b,{color:"#829AE3",drag:!0,enableY:!1,onDragEnd:t=>{t&&e.applyZoom(t.left,t.right)}})),r.createElement(ua.a,{className:"histogram-legend",colors:t.map((e=>this.getColorCodeForInstanceType(e))),items:t.map((t=>"".concat(t," (").concat(e.counts[t],")"))),orientation:"horizontal"}))}getColorCodeForInstanceType(e){for(var t=0,a=e.length-1;a>=0;a--)t=(t<<5)-t+e.charCodeAt(a),t&=2147483647;return t|=1048576,"#"+(t&=16777199).toString(16)}formatTimeTick(e,t){const a=ne()(e);return this.context.showTimeAsLocal||a.utc(),t>432e6?a.format("YYYY-MM-DD"):t>864e5?a.format("YYYY-MM-DD HH:mm"):t>1e4?0===a.second()?a.format("HH:mm"):a.format("HH:mm:ss"):0===a.millisecond()?a.format("HH:mm:ss"):a.format(":SSS")}},ca.contextType=ie,la=ma))||la;var da,pa=a(137),ga=a.n(pa),ba=a(255),ya=a.n(ba);class fa extends r.Component{render(){return this.props.backendClient.isVsCode?r.createElement(f.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:()=>this.props.backendClient.call("SaveAs",this.props.fileName+".svg",this.props.svg)},r.createElement(ya.a,null),r.createElement(l.a,{width:20}),r.createElement(u.a,{color:"inherit"},"Save as .SVG")):r.createElement(f.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,href:URL.createObjectURL(new Blob([this.props.svg],{type:"image/svg+xml"})),download:this.props.fileName+".svg"},r.createElement(ya.a,null),r.createElement(l.a,{width:20}),r.createElement(u.a,{color:"inherit"},"Save as .SVG"))}}function _a(e){return e.replace("</style>",".note { stroke: none !important; fill: none !important; } .noteText { font-size: 9px !important; } </style>")}let Ea=Object(o.a)(da=class extends r.Component{render(){const e=this.props.state;return e.rawHtml?r.createElement(r.Fragment,null,r.createElement("div",{className:"raw-html-div",style:Zt,dangerouslySetInnerHTML:{__html:_a(e.rawHtml)}}),r.createElement(m.a,{variant:"dense"},r.createElement(u.a,{style:{flex:1}}),r.createElement(f.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:()=>window.navigator.clipboard.writeText(e.diagramCode)},r.createElement(ga.a,null),r.createElement(l.a,{width:10}),r.createElement(u.a,{color:"inherit"},"Copy diagram code to Clipboard")),r.createElement(l.a,{width:20}),r.createElement(fa,{svg:_a(e.rawHtml),fileName:this.props.fileName,inProgress:this.props.inProgress,backendClient:this.props.backendClient}),r.createElement(l.a,{width:20}))):null}})||da;var Oa,va,Ca,Sa,wa;let Ta=(Oa=U.d.bound,Object(o.a)((wa=Sa=class extends r.Component{constructor(...e){super(...e),this.context=void 0}componentDidMount(){this.props.state.loadOrchestrations(),document.addEventListener("scroll",(e=>{const t=this.props.state;if(t.tabIndex!==Ot.List)return;const a=e.target.scrollingElement;if(!a)return;a.scrollHeight-window.innerHeight-a.scrollTop<100&&t.loadOrchestrations()})),document.addEventListener("keydown",(e=>{const t=this.props.state;if(t.tabIndex===Ot.Histogram&&e.ctrlKey&&90===e.keyCode){t.selectedTabState.resetZoom()}}))}render(){const e=this.props.state,t=e.selectedTabState,a=e.selectedTabState,n=e.selectedTabState,i=this.context.showTimeAsLocal?"Local":"UTC";return r.createElement(r.Fragment,null,r.createElement(E.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:()=>e.menuAnchorElement=void 0},r.createElement(O.a,{onClick:()=>e.timeRange=vt.LastMinute},"Last Minute"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Last10Minutes},"Last 10 Minutes"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.LastHour},"Last Hour"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Last24Hours},"Last 24 Hours"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Last7Days},"Last 7 Days"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Last30Days},"Last 30 Days"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Last90Days},"Last 90 Days"),r.createElement(O.a,{onClick:()=>e.timeRange=vt.Custom},"Custom")),r.createElement(c.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(m.a,{variant:"dense",className:"top-toolbar"},r.createElement(ue.a,{container:!0,className:"toolbar-grid1"},r.createElement(ue.a,{item:!0,xs:12},r.createElement(f.a,{size:"small",variant:"outlined",className:"time-period-menu-drop-btn",onClick:t=>e.menuAnchorElement=t.currentTarget},r.createElement(we.a,null)),e.timeRange?r.createElement(p.a,{className:"from-input",label:"Time Range",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},type:"text",value:this.timeRangeToString(e.timeRange)}):r.createElement(_e.a,{className:"from-input",ampm:!1,autoOk:!0,label:"From (".concat(i,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:e.inProgress,value:this.context.getMoment(e.timeFrom),onChange:t=>e.timeFrom=this.context.setMoment(t),onBlur:()=>e.applyTimeFrom(),onAccept:()=>e.applyTimeFrom(),onKeyPress:this.handleKeyPress})),r.createElement(ue.a,{item:!0,xs:12,className:"toolbar-grid1-item2"},!e.timeRange&&r.createElement(r.Fragment,null,r.createElement(he.a,null,r.createElement(de.a,{id:"till-checkbox",className:"till-checkbox",disabled:e.inProgress,checked:e.timeTillEnabled,onChange:t=>e.timeTillEnabled=t.target.checked})),e.timeTillEnabled?r.createElement(_e.a,{className:"till-input",ampm:!1,autoOk:!0,label:"Till (".concat(i,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:e.inProgress,value:this.context.getMoment(e.timeTill),onChange:t=>e.timeTill=this.context.setMoment(t),onBlur:()=>e.applyTimeTill(),onAccept:()=>e.applyTimeTill(),onKeyPress:this.handleKeyPress}):r.createElement(p.a,{className:"till-input",label:"Till (".concat(i,")"),placeholder:"[Now]",InputLabelProps:{shrink:!0},type:"text",disabled:!0})))),r.createElement(ue.a,{container:!0,className:"toolbar-grid2"},r.createElement(ue.a,{item:!0,xs:12},r.createElement(he.a,null,r.createElement(pe.a,{htmlFor:"filtered-column-select"},"Filtered Column"),r.createElement(ge.a,{className:"toolbar-select filtered-column-input",disabled:e.inProgress,value:e.filteredColumn,onChange:t=>e.filteredColumn=t.target.value,inputProps:{id:"filtered-column-select"}},r.createElement(O.a,{value:"0"},"[Not Selected]"),Ie.map((e=>r.createElement(O.a,{key:e,value:e},e))))),r.createElement(he.a,{className:"toolbar-grid2-item1-select"},r.createElement(pe.a,{htmlFor:"filter-operator-select"},"Filter Operator"),r.createElement(ge.a,{className:"toolbar-select",disabled:e.inProgress,value:e.filterOperator,onChange:t=>e.filterOperator=t.target.value,inputProps:{id:"filter-operator-select"}},r.createElement(O.a,{value:Et.Equals},"Equals"),r.createElement(O.a,{value:Et.StartsWith},"Starts With"),r.createElement(O.a,{value:Et.Contains},"Contains"),r.createElement(O.a,{value:Et.NotEquals},"Not Equals"),r.createElement(O.a,{value:Et.NotStartsWith},"Not Starts With"),r.createElement(O.a,{value:Et.NotContains},"Not Contains")))),r.createElement(ue.a,{item:!0,xs:12,className:"toolbar-grid2-item2"},r.createElement(p.a,{className:"filter-value-input",label:"Filter Value",InputLabelProps:{shrink:!0},placeholder:"[some text or 'null']",disabled:"0"===e.filteredColumn||e.inProgress,value:e.filterValue,onChange:t=>e.filterValue=t.target.value,onBlur:()=>e.applyFilterValue(),onKeyPress:this.handleKeyPress}))),r.createElement(be.a,{className:"toolbar-runtime-status-group"},r.createElement(pe.a,{className:"toolbar-runtime-status-group-label",shrink:!0},"Type/Status ",e.showStatuses?" (".concat(e.showStatuses.length," selected)"):""),r.createElement(be.a,{className:"toolbar-runtime-status-checkbox-group",onScroll:()=>e.rescheduleDelayedRefresh()},r.createElement(R.a,{control:r.createElement(de.a,{className:"status-checkbox",disabled:e.inProgress,checked:e.isStatusChecked(),onChange:t=>e.setStatusChecked(t.target.checked)}),label:"[All]"}),Pe.map((t=>r.createElement(R.a,{key:t,control:r.createElement(de.a,{className:"status-checkbox",disabled:e.inProgress,checked:e.isStatusChecked(t),onChange:a=>e.setStatusChecked(a.target.checked,t)}),label:"Orchestations:"+t}))),r.createElement(R.a,{control:r.createElement(de.a,{className:"status-checkbox",disabled:e.inProgress,checked:e.isStatusChecked("DurableEntities"),onChange:t=>e.setStatusChecked(t.target.checked,"DurableEntities")}),label:"Durable Entities"}))),r.createElement(u.a,{style:{flex:1}}),r.createElement(ue.a,{container:!0,className:"toolbar-grid3"},r.createElement(ue.a,{item:!0,xs:12},r.createElement(he.a,{className:"form-control-float-right"},r.createElement(pe.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),r.createElement(ge.a,{className:"autorefresh-select",inputProps:{id:"auto-refresh-select"},value:e.autoRefresh,onChange:t=>e.autoRefresh=t.target.value},r.createElement(O.a,{value:0},"Never"),r.createElement(O.a,{value:1},"Every 1 sec."),r.createElement(O.a,{value:5},"Every 5 sec."),r.createElement(O.a,{value:10},"Every 10 sec.")))),r.createElement(ue.a,{item:!0,xs:12,className:"toolbar-grid3-item2"},r.createElement(f.a,{className:"refresh-button form-control-float-right",variant:"outlined",color:"default",size:"large",onClick:()=>e.inProgress?e.cancel():e.reloadOrchestrations()},e.inProgress?r.createElement(Ce.a,null):r.createElement(Oe.a,null)))))),r.createElement(c.a,{color:"inherit",position:"static"},r.createElement(ye.a,{className:"tab-buttons",value:e.tabIndex,onChange:(t,a)=>e.tabIndex=a},r.createElement(fe.a,{className:"tab-buttons",disabled:e.inProgress,label:r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},"List")}),r.createElement(fe.a,{className:"tab-buttons",disabled:e.inProgress,label:r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},"Time Histogram")}),r.createElement(fe.a,{className:"tab-buttons",disabled:e.inProgress,label:r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},"Gantt Chart")}))),e.tabIndex===Ot.List&&r.createElement(r.Fragment,null,r.createElement(oa,{state:t,showLastEventColumn:e.showLastEventColumn,backendClient:e.backendClient}),e.inProgress&&t.orchestrations.length?r.createElement(z.a,null):r.createElement(l.a,{height:4})),e.tabIndex===Ot.Histogram&&r.createElement(ha,{state:a}),e.tabIndex===Ot.Gantt&&r.createElement(Ea,{state:n,inProgress:e.inProgress,fileName:"gantt-chart-".concat(e.timeFrom.format("YYYY-MM-DD-HH-mm-ss"),"-").concat(e.timeTill.format("YYYY-MM-DD-HH-mm-ss")),backendClient:e.backendClient}),r.createElement(m.a,{variant:"dense"}),r.createElement(Q,{state:this.props.state}))}timeRangeToString(e){switch(e){case vt.LastMinute:return"Last Minute";case vt.Last10Minutes:return"Last 10 Minutes";case vt.LastHour:return"Last Hour";case vt.Last24Hours:return"Last 24 Hours";case vt.Last7Days:return"Last 7 Days";case vt.Last30Days:return"Last 30 Days";case vt.Last90Days:return"Last 90 Days";default:return""}}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.reloadOrchestrations())}},Sa.contextType=ie,Ca=wa,Object(V.a)(Ca.prototype,"handleKeyPress",[Oa],Object.getOwnPropertyDescriptor(Ca.prototype,"handleKeyPress"),Ca.prototype),va=Ca))||va);var Pa,ka=a(380),Ia=a.n(ka);a(679);let Da=Object(o.a)(Pa=class extends r.Component{render(){const e=this.props.state;return r.createElement(r.Fragment,null,this.renderDialogs(e),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.purgeConfirmationOpen=!0},"Purge"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.raiseEventDialogOpen=!0},"Send Signal"))}renderDialogs(e){return r.createElement(r.Fragment,null,r.createElement(v.a,{open:e.purgeConfirmationOpen,onClose:()=>e.purgeConfirmationOpen=!1},r.createElement(P.a,null,"Confirm Purge"),r.createElement(C.a,null,r.createElement(T.a,null,"You're about to purge entity '",e.orchestrationId,"'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.purgeConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),r.createElement(f.a,{onClick:()=>e.purge(),color:"secondary"},"Yes, purge"))),r.createElement(v.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:()=>e.raiseEventDialogOpen=!1},r.createElement(P.a,null,"Send Signal"),r.createElement(C.a,null,r.createElement(T.a,null,"Provide signal name and some additional data"),r.createElement(p.a,{autoFocus:!0,margin:"dense",label:"Signal Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:t=>e.eventName=t.target.value}),r.createElement(p.a,{margin:"dense",label:"Signal Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:t=>e.eventData=t.target.value})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.raiseEventDialogOpen=!1,color:"primary"},"Cancel"),r.createElement(f.a,{onClick:()=>e.raiseEvent(),disabled:!e.eventName,color:"secondary"},"Send"))))}})||Pa;var Na;let ja=Object(o.a)(Na=class extends r.Component{render(){var e,t;const a=this.props.details,n=$t(a.runtimeStatus);return r.createElement(r.Fragment,null,r.createElement(ue.a,{container:!0,className:"grid-container"},r.createElement(ue.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"entityId.name",value:null===(e=a.entityId)||void 0===e?void 0:e.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:6,md:3,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"entityId.key",value:null===(t=a.entityId)||void 0===t?void 0:t.key,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"createdTime",value:a.createdTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"lastUpdatedTime",value:a.lastUpdatedTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"runtimeStatus",value:a.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:n})),r.createElement(ue.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"input",value:JSON.stringify(a.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10})),r.createElement(ue.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"customStatus",value:JSON.stringify(a.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10}))))}})||Na;var xa;let Ma=Object(o.a)(xa=class extends r.Component{render(){const e=this.props.state;return r.createElement(r.Fragment,null,this.renderDialogs(e),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.restartDialogOpen=!0},"Restart"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.rewindConfirmationOpen=!0},"Rewind"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.terminateConfirmationOpen=!0},"Terminate"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.raiseEventDialogOpen=!0},"Raise Event"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.setCustomStatusDialogOpen=!0},"Set Custom Status"),r.createElement(l.a,{width:10}),r.createElement(f.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:()=>e.purgeConfirmationOpen=!0},"Purge"))}renderDialogs(e){return r.createElement(r.Fragment,null,r.createElement(v.a,{open:e.rewindConfirmationOpen,onClose:()=>e.rewindConfirmationOpen=!1},r.createElement(P.a,null,"Confirm Rewind"),r.createElement(C.a,null,r.createElement(T.a,null,"You're about to rewind orchestration '",e.orchestrationId,"'. Are you sure?")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.rewindConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),r.createElement(f.a,{onClick:()=>e.rewind(),color:"secondary"},"Yes, rewind"))),r.createElement(v.a,{open:e.terminateConfirmationOpen,onClose:()=>e.terminateConfirmationOpen=!1},r.createElement(P.a,null,"Confirm Terminate"),r.createElement(C.a,null,r.createElement(T.a,null,"You're about to terminate orchestration '",e.orchestrationId,"'. This operation cannot be undone. Are you sure?")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.terminateConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),r.createElement(f.a,{onClick:()=>e.terminate(),color:"secondary"},"Yes, terminate"))),r.createElement(v.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:()=>e.raiseEventDialogOpen=!1},r.createElement(P.a,null,"Raise Event"),r.createElement(C.a,null,r.createElement(T.a,null,"Provide event name and some additional data"),r.createElement(p.a,{autoFocus:!0,margin:"dense",label:"Event Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:t=>e.eventName=t.target.value}),r.createElement(p.a,{margin:"dense",label:"Event Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:t=>e.eventData=t.target.value})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.raiseEventDialogOpen=!1,color:"primary"},"Cancel"),r.createElement(f.a,{onClick:()=>e.raiseEvent(),disabled:!e.eventName,color:"secondary"},"Raise"))),r.createElement(v.a,{fullWidth:!0,open:e.setCustomStatusDialogOpen,onClose:()=>e.setCustomStatusDialogOpen=!1},r.createElement(P.a,null,"Set customStatus"),r.createElement(C.a,null,r.createElement(T.a,null,"customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself."),r.createElement(p.a,{margin:"dense",InputLabelProps:{shrink:!0},label:"New customStatus (JSON)",fullWidth:!0,multiline:!0,rows:10,value:e.newCustomStatus,onChange:t=>e.newCustomStatus=t.target.value})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.setCustomStatusDialogOpen=!1,color:"primary"},"Cancel"),r.createElement(f.a,{onClick:()=>e.setCustomStatus(),disabled:!e.isCustomStatusDirty,color:"secondary"},"Apply"))),r.createElement(v.a,{open:e.purgeConfirmationOpen,onClose:()=>e.purgeConfirmationOpen=!1},r.createElement(P.a,null,"Confirm Purge"),r.createElement(C.a,null,r.createElement(T.a,null,"You're about to purge orchestration '",e.orchestrationId,"'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.purgeConfirmationOpen=!1,color:"primary",autoFocus:!0},"Cancel"),r.createElement(f.a,{onClick:()=>e.purge(),color:"secondary"},"Yes, purge"))),r.createElement(v.a,{open:e.restartDialogOpen,onClose:()=>e.restartDialogOpen=!1},r.createElement(P.a,null,"Confirm Restart"),r.createElement(C.a,null,r.createElement(T.a,null,"You're about to restart orchestration '",e.orchestrationId,"'. Are you sure?"),r.createElement(R.a,{control:r.createElement(de.a,{checked:e.restartWithNewInstanceId,onChange:t=>e.restartWithNewInstanceId=t.target.checked}),label:"Restart with new instanceId"})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.restartDialogOpen=!1,color:"primary",autoFocus:!0},"Cancel"),r.createElement(f.a,{onClick:()=>e.restart(),color:"secondary"},"Restart"))))}})||xa;var Fa,La,Ha;let Ra=Object(o.a)((Ha=La=class extends r.Component{constructor(...e){super(...e),this.context=void 0}componentDidMount(){document.addEventListener("scroll",(e=>{const t=e.target.scrollingElement;if(!t)return;t.scrollHeight-window.innerHeight-t.scrollTop<50&&this.props.state.loadHistory()}))}render(){const e=this.props.state.historyTotalCount,t=this.props.state.details,a=this.props.state.history,n=a.length,i=$t(t.runtimeStatus);return r.createElement(r.Fragment,null,r.createElement(ue.a,{container:!0,className:"grid-container"},r.createElement(ue.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"instanceId",value:t.instanceId,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"name",value:t.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"createdTime",value:this.context.formatDateTimeString(t.createdTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"lastUpdatedTime",value:this.context.formatDateTimeString(t.lastUpdatedTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),r.createElement(ue.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"runtimeStatus",value:t.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:i})),r.createElement(ue.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"input",value:JSON.stringify(t.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),r.createElement(ue.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"output",value:JSON.stringify(t.output,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),r.createElement(ue.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},r.createElement(p.a,{label:"customStatus",value:JSON.stringify(t.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8}))),r.createElement(St.a,{className:"history-events-count-label"},"historyEvents: ",e===n?"".concat(n," items"):"".concat(n," of ").concat(e," items shown")),!!a.length&&this.renderTable(a))}renderEventLink(e){var t;const a=this.props.state;if(e.SubOrchestrationId)return r.createElement(aa,{orchestrationId:e.SubOrchestrationId,title:e.FunctionName,backendClient:a.backendClient});const n=null!==(t=e.Name)&&void 0!==t?t:e.FunctionName;return a.functionNames[n]?r.createElement(h.a,{href:"/",color:"dark"===Jt.palette.type?"inherit":"primary",onClick:()=>{a.gotoFunctionCode(n)}},n):n}renderTable(e){return r.createElement(Tt.a,{size:"small"},r.createElement(Pt.a,null,r.createElement(kt.a,null,Te.map((e=>r.createElement(It.a,{key:e},e))))),r.createElement(Nt.a,null,e.map(((e,t)=>{const a={verticalAlign:"top"};return r.createElement(kt.a,{key:t},r.createElement(It.a,{style:a},this.context.formatDateTimeString(e.Timestamp)),r.createElement(It.a,{style:a},e.EventType),r.createElement(It.a,{className:"name-cell",style:a},this.renderEventLink(e)),r.createElement(It.a,{style:a},this.context.formatDateTimeString(e.ScheduledTime)),r.createElement(It.a,{className:"long-text-cell",style:a},r.createElement(jt.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:na(e.Result)})),r.createElement(It.a,{className:"long-text-cell",style:a},r.createElement(jt.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:na(e.Details)})))}))))}},La.contextType=ie,Fa=Ha))||Fa;var Aa;let za=Object(o.a)(Aa=class extends r.Component{componentDidMount(){this.props.state.loadDetails()}componentDidUpdate(){const e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("actor")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("messageText")))}render(){const e=this.props.state;return r.createElement(r.Fragment,null,r.createElement(c.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(m.a,{variant:"dense",className:"details-top-toolbar"},"Orchestration"===e.details.entityType&&r.createElement(Ma,{state:e,disabled:e.inProgress}),"DurableEntity"===e.details.entityType&&r.createElement(Da,{state:e,disabled:e.inProgress}),r.createElement(l.a,{width:20}),r.createElement(u.a,{style:{flex:1}}),r.createElement(he.a,null,r.createElement(pe.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),r.createElement(ge.a,{className:"toolbar-select",value:e.autoRefresh,onChange:t=>e.autoRefresh=t.target.value,inputProps:{id:"auto-refresh-select"}},r.createElement(O.a,{value:0},"Never"),r.createElement(O.a,{value:1},"Every 1 sec."),r.createElement(O.a,{value:5},"Every 5 sec."),r.createElement(O.a,{value:10},"Every 10 sec."))),r.createElement(l.a,{width:20}),r.createElement(f.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress&&!e.loadInProgress,onClick:()=>e.loadInProgress?e.cancel():e.loadDetails()},e.loadInProgress?r.createElement(Ce.a,null):r.createElement(Oe.a,null)))),(!!e.tabStates.length||e.functionGraphAvailable)&&r.createElement(r.Fragment,null,r.createElement(c.a,{color:"inherit",position:"static"},r.createElement(ye.a,{className:"tab-buttons",value:e.tabIndex,onChange:(t,a)=>{"functions-graph-link"!==a&&(e.tabIndex=a)}},r.createElement(fe.a,{className:"tab-buttons",disabled:e.inProgress,label:r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},"Details")}),e.tabStates.map((t=>r.createElement(fe.a,{className:"tab-buttons",key:t.name,disabled:e.inProgress,label:r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},t.name)}))),e.functionGraphAvailable&&r.createElement(fe.a,{className:"tab-buttons",disabled:e.inProgress,value:"functions-graph-link",onClick:t=>{t.preventDefault(),e.showFunctionsGraph()},label:r.createElement("span",{className:"functions-graph-tab-span"},r.createElement(u.a,{color:"textPrimary",variant:"subtitle2"},"Functions Graph"),r.createElement(Ia.a,{className:"functions-graph-link-icon"}))})))),!e.tabIndex&&"Orchestration"===e.details.entityType&&r.createElement(r.Fragment,null,r.createElement(Ra,{state:e}),e.inProgress&&e.history.length?r.createElement(z.a,null):r.createElement(l.a,{height:4})),!e.tabIndex&&"DurableEntity"===e.details.entityType&&r.createElement(ja,{details:e.details}),!!e.selectedTab&&!!e.selectedTab.rawHtml&&r.createElement(r.Fragment,null,r.createElement("div",{className:"raw-html-div",style:Zt,dangerouslySetInnerHTML:{__html:_a(e.selectedTab.rawHtml)}}),e.selectedTab.isMermaidDiagram&&r.createElement(m.a,{variant:"dense"},r.createElement(u.a,{style:{flex:1}}),r.createElement(f.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:()=>window.navigator.clipboard.writeText(e.selectedTab.description)},r.createElement(ga.a,null),r.createElement(l.a,{width:10}),r.createElement(u.a,{color:"inherit"},"Copy diagram code to Clipboard")),r.createElement(l.a,{width:20}),r.createElement(fa,{svg:_a(e.selectedTab.rawHtml),fileName:e.orchestrationId,inProgress:e.inProgress,backendClient:e.backendClient}),r.createElement(l.a,{width:20}))),r.createElement(Q,{state:this.props.state}))}mountClickEventToFunctionNodes(e){const t=this.props.state;for(var a=0;a<e.length;a++){const r=e[a];var n=r.innerHTML;const i=/>(.+)</.exec(n);if(i&&(n=i[1]),t.functionNames[n]){const e=n;r.onclick=()=>t.gotoFunctionCode(e),r.style.cursor="pointer"}}}})||Aa;var Ba;a(680);let Wa=Object(o.a)(Ba=class extends r.Component{componentDidMount(){this.props.state.load()}componentDidUpdate(){const e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("orchestrator")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")))}render(){const e=this.props.state;return r.createElement(r.Fragment,null,r.createElement(c.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(m.a,{variant:"dense",className:"details-top-toolbar"},r.createElement(l.a,{width:20}),r.createElement(p.a,{fullWidth:!0,label:"Function Project Path",disabled:!0,InputLabelProps:{shrink:!0},type:"text",value:e.projectPath}),r.createElement(l.a,{width:20}),r.createElement(u.a,{style:{flex:1}}),r.createElement(f.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress,onClick:()=>e.load()},r.createElement(Oe.a,null)))),!!e.diagramSvg&&r.createElement(r.Fragment,null,r.createElement("div",{className:"diagram-div",style:Zt,dangerouslySetInnerHTML:{__html:_a(e.diagramSvg)}}),r.createElement(m.a,{variant:"dense"},r.createElement(f.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:()=>window.navigator.clipboard.writeText(e.diagramCode)},r.createElement(ga.a,null),r.createElement(l.a,{width:10}),r.createElement(u.a,{color:"inherit"},"Copy diagram code to Clipboard")),r.createElement(l.a,{width:20}),r.createElement(fa,{svg:_a(e.diagramSvg),fileName:"functions.svg",inProgress:e.inProgress,backendClient:e.backendClient}))),r.createElement(Q,{state:this.props.state}))}mountClickEventToFunctionNodes(e){const t=this.props.state;for(var a=0;a<e.length;a++){const n=e[a],r=/flowchart-(.+)-/.exec(n.id);if(r){const e=r[1];n.onclick=()=>t.gotoFunctionCode(e)}}}})||Ba;var Ya,Va,Ua,qa,Ga=a(693);a(681);let Ka=Object(o.a)((Ua=Va=class extends r.Component{constructor(...e){super(...e),this.context=void 0}render(){const e=this.props.state,t=this.context.showTimeAsLocal?"Local":"UTC";return r.createElement(v.a,{open:e.dialogOpen,onClose:()=>{e.inProgress||(e.dialogOpen=!1)}},r.createElement(P.a,null,"Purge Instance History"),null===e.instancesDeleted&&r.createElement("div",null,r.createElement(C.a,null,e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(T.a,null,"WARNING: this operation drops instance states from the underlying storage and cannot be undone.","DurableEntity"===e.entityType&&r.createElement(u.a,{color:"error"},"It might as well remove Durable Entities, that are still active. Ensure that you specify the correct time frame! To clean up deleted Entities use the 'Clean Entity Storage' command instead.")),r.createElement(he.a,{className:"purge-history-statuses",disabled:e.inProgress,fullWidth:!0},r.createElement(Ga.a,null,"Apply to:"),r.createElement(H.a,{row:!0,value:e.entityType,onChange:t=>e.entityType=t.target.value},r.createElement(R.a,{disabled:e.inProgress,value:"Orchestration",control:r.createElement(A.a,null),label:"Orchestrations"}),r.createElement(R.a,{disabled:e.inProgress,value:"DurableEntity",control:r.createElement(A.a,null),label:"Durable Entities"}))),r.createElement(_e.a,{className:"purge-history-from-input",ampm:!1,autoOk:!0,label:"DurableEntity"===e.entityType?"Last Updated From (".concat(t,")"):"From (".concat(t,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:e.inProgress,value:this.context.getMoment(e.timeFrom),onChange:t=>e.timeFrom=this.context.setMoment(t)}),r.createElement(_e.a,{className:"purge-history-till-input",ampm:!1,autoOk:!0,label:"DurableEntity"===e.entityType?"Last Updated Till (".concat(t,")"):"Till (".concat(t,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:e.inProgress,value:this.context.getMoment(e.timeTill),onChange:t=>e.timeTill=this.context.setMoment(t)}),r.createElement(he.a,{className:"purge-history-statuses",disabled:e.inProgress},r.createElement(Ga.a,null,"With the following status:"),"Orchestration"===e.entityType&&r.createElement(be.a,{row:!0},r.createElement(Ja,{state:e,runtimeStatus:"Completed"}),r.createElement(Ja,{state:e,runtimeStatus:"Failed"}),r.createElement(Ja,{state:e,runtimeStatus:"Terminated"})),"DurableEntity"===e.entityType&&r.createElement(be.a,{row:!0},r.createElement(_.a,{title:"Durable Entities are always in 'Running' state"},r.createElement(R.a,{control:r.createElement(de.a,{checked:!0}),label:"Running",disabled:!0})))),r.createElement(Q,{state:e})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.dialogOpen=!1,disabled:e.inProgress,color:"primary"},"Cancel"),r.createElement(f.a,{onClick:()=>e.purgeHistory(),disabled:!e.isValid||e.inProgress,color:"secondary"},"Purge"))),null!==e.instancesDeleted&&r.createElement("div",null,r.createElement(C.a,null,r.createElement(T.a,{className:"success-message"},e.instancesDeleted," instances were deleted.")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.dialogOpen=!1,color:"primary"},"Close"))))}},Va.contextType=ie,Ya=Ua))||Ya,Ja=Object(o.a)(qa=class extends r.Component{render(){const e=this.props.state,t=this.props.runtimeStatus;return r.createElement(R.a,{control:r.createElement(de.a,{checked:e.getStatusIncluded(t),onChange:a=>e.setStatusIncluded(t,a.target.checked)}),label:t})}})||qa;var Za;a(682);let $a=Object(o.a)(Za=class extends r.Component{render(){const e=this.props.state;return r.createElement(v.a,{open:e.dialogOpen,onClose:()=>{e.inProgress||(e.dialogOpen=!1)}},r.createElement(P.a,null,"Clean Entity Storage"),!e.response&&r.createElement(r.Fragment,null,r.createElement(C.a,null,e.inProgress?r.createElement(z.a,null):r.createElement(l.a,{height:4}),r.createElement(T.a,null,"An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than EntityMessageReorderWindowInMinutes. Locks are considered orphaned, and are released, if the orchestration that holds them is not in state Running."),r.createElement(he.a,{className:"purge-history-statuses",disabled:e.inProgress},r.createElement(be.a,{row:!0},r.createElement(R.a,{control:r.createElement(de.a,{checked:e.removeEmptyEntities,onChange:t=>e.removeEmptyEntities=t.target.checked}),label:"Remove Empty Entities"}),r.createElement(R.a,{control:r.createElement(de.a,{checked:e.releaseOrphanedLocks,onChange:t=>e.releaseOrphanedLocks=t.target.checked}),label:"Release Orphaned Locks"}))),r.createElement(Q,{state:e})),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.dialogOpen=!1,disabled:e.inProgress,color:"primary"},"Cancel"),r.createElement(f.a,{onClick:()=>e.clean(),disabled:!e.isValid||e.inProgress,color:"secondary"},"Clean"))),!!e.response&&r.createElement(r.Fragment,null,r.createElement(C.a,null,r.createElement(T.a,{className:"success-message"},e.response.numberOfEmptyEntitiesRemoved," empty entities removed."),r.createElement(T.a,{className:"success-message"},e.response.numberOfOrphanedLocksRemoved," orphaned locks removed.")),r.createElement(B.a,null,r.createElement(f.a,{onClick:()=>e.dialogOpen=!1,color:"primary"},"Close"))))}})||Za;var Qa;let Xa=Object(o.a)(Qa=class extends r.Component{render(){const e=this.props.state;return r.createElement(g.a,{utils:y.a},r.createElement(ie.Provider,{value:se},!e.loginState&&r.createElement(l.a,{height:20}),!!e.loginState&&r.createElement(c.a,{position:"static",color:"default",className:"app-bar"},r.createElement(m.a,null,e.loginState.isLoggedIn&&!!e.mainMenuState&&r.createElement(me,{state:e.mainMenuState,doRefresh:()=>e.orchestrationsState.reloadOrchestrations()}),r.createElement("img",{src:"".concat(DfmRoutePrefix?"/":"").concat(DfmRoutePrefix,"/logo.svg"),width:"30px"}),r.createElement(l.a,{width:5}),r.createElement(u.a,{variant:"h6",color:"inherit",className:"title-typography"},r.createElement(h.a,{color:"inherit",href:e.loginState.rootUri},"Durable Functions Monitor")),r.createElement(d.a,{color:"inherit"},r.createElement(h.a,{color:"inherit",href:e.loginState.locationPathName},"/ ",e.loginState.taskHubName),e.orchestrationDetailsState?r.createElement(u.a,{color:"inherit"},r.createElement(h.a,{color:"inherit",href:window.location.pathname},e.orchestrationDetailsState.orchestrationId)):r.createElement(b.a,{className:"instance-id-input",freeSolo:!0,options:e.isExactMatch?[]:e.suggestions,value:e.typedInstanceId,onChange:(t,a)=>{e.typedInstanceId=null!==a&&void 0!==a?a:"",a&&e.goto()},renderInput:t=>r.createElement(p.a,Object.assign({},t,{className:e.isExactMatch?"instance-id-valid":null,size:"small",label:"instanceId to go to...",variant:"outlined",onChange:t=>e.typedInstanceId=t.target.value,onKeyPress:e=>this.handleKeyPress(e)}))})),r.createElement(u.a,{style:{flex:1}}),r.createElement(j,{state:e.loginState}))),!!e.orchestrationsState&&(!e.loginState||e.loginState.isLoggedIn)&&r.createElement(Ta,{state:e.orchestrationsState}),!!e.orchestrationDetailsState&&(!e.loginState||e.loginState.isLoggedIn)&&r.createElement(za,{state:e.orchestrationDetailsState}),!!e.functionGraphState&&(!e.loginState||e.loginState.isLoggedIn)&&r.createElement(Wa,{state:e.functionGraphState}),r.createElement(Ka,{state:e.purgeHistoryDialogState}),r.createElement($a,{state:e.cleanEntityStorageDialogState})))}handleKeyPress(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.goto())}})||Qa;var en,tn,an,nn,rn,sn,on;let ln=(en=class extends Me{get inProgress(){return this._inProgress}get isReadonly(){return this._isReadOnly}get isDirty(){return this.connectionString!==this._oldConnectionString||this.hubName!==this._oldHubName}constructor(e,t,a){super(),this._backendClient=e,this._purgeHistoryDialogState=t,this._cleanEntityStorageDialogState=a,Object(te.a)(this,"menuAnchorElement",tn,this),Object(te.a)(this,"hubName",an,this),Object(te.a)(this,"connectionString",nn,this),Object(te.a)(this,"connectionParamsDialogOpen",rn,this),Object(te.a)(this,"_inProgress",sn,this),Object(te.a)(this,"_isReadOnly",on,this),this._oldConnectionString=void 0,this._oldHubName=void 0}showConnectionParamsDialog(){this.menuAnchorElement=void 0,this.connectionParamsDialogOpen=!0,this._inProgress=!0,this._backendClient.call("GET","/manage-connection").then((e=>{this.connectionString=this._oldConnectionString=e.connectionString,this.hubName=this._oldHubName=e.hubName,this._isReadOnly=e.isReadOnly}),(e=>{this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})).finally((()=>{this._inProgress=!1}))}saveConnectionParams(){this._inProgress=!0,this._backendClient.call("PUT","/manage-connection",{connectionString:this.connectionString!==this._oldConnectionString?this.connectionString:"",hubName:this.hubName}).then((()=>{this.connectionParamsDialogOpen=!1,alert("Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.")}),(e=>{this.errorMessage="Save failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})).finally((()=>{this._inProgress=!1}))}showPurgeHistoryDialog(){this.menuAnchorElement=void 0,this._purgeHistoryDialogState.dialogOpen=!0}showCleanEntityStorageDialog(){this.menuAnchorElement=void 0,this._cleanEntityStorageDialogState.dialogOpen=!0}setWindowTitle(){this._backendClient.call("GET","/about").then((e=>{document.title="Durable Functions Monitor (".concat(e.accountName,"/").concat(e.hubName,") v").concat(e.version)}))}},tn=Object(V.a)(en.prototype,"menuAnchorElement",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=Object(V.a)(en.prototype,"hubName",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=Object(V.a)(en.prototype,"connectionString",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rn=Object(V.a)(en.prototype,"connectionParamsDialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(V.a)(en.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(en.prototype,"inProgress"),en.prototype),Object(V.a)(en.prototype,"isReadonly",[U.e],Object.getOwnPropertyDescriptor(en.prototype,"isReadonly"),en.prototype),Object(V.a)(en.prototype,"isDirty",[U.e],Object.getOwnPropertyDescriptor(en.prototype,"isDirty"),en.prototype),sn=Object(V.a)(en.prototype,"_inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),on=Object(V.a)(en.prototype,"_isReadOnly",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),en);var cn;let mn=(cn=class extends Xe{get description(){return this._diagramCode}get rawHtml(){return this._diagramSvg}constructor(e){super(),this._loadHistory=e,this.name="Diagram",this.isMermaidDiagram=!0}load(e,t){return this.initMermaidWhenNeeded(),this._loadHistory(e.instanceId).then((a=>{if(a.length&&!t.isCancelled)return this.buildDiagram(e,a,t)}))}},Object(V.a)(cn.prototype,"description",[U.e],Object.getOwnPropertyDescriptor(cn.prototype,"description"),cn.prototype),Object(V.a)(cn.prototype,"rawHtml",[U.e],Object.getOwnPropertyDescriptor(cn.prototype,"rawHtml"),cn.prototype),cn);class un extends mn{constructor(...e){super(...e),this.name="Sequence Diagram"}buildDiagram(e,t,a){return new Promise(((n,r)=>{Promise.all(this.getSequenceForOrchestration(e.name,".",t)).then((e=>{if(a.isCancelled)n();else{this._diagramCode="sequenceDiagram \n"+e.join("");try{this._diagramSvg="",Qe.a.render("mermaidSvgId",this._diagramCode,(e=>{this._diagramSvg=e,n()}))}catch(t){r(t)}}}),r)}))}getSequenceForOrchestration(e,t,a){const n=".",r=[];for(var i,s=0;s<a.length;){const c=a[s];switch(c.EventType){case"ExecutionStarted":i="".concat(t,"->>+").concat(e,":[ExecutionStarted] \n")+"Note over ".concat(t,",").concat(e,": ").concat(this.formatTimestamp(c.Timestamp)," \n"),r.push(Promise.resolve(i));break;case"SubOrchestrationInstanceCompleted":if(c.SubOrchestrationId){const t=c.SubOrchestrationId,a=c.FunctionName;r.push(new Promise(((n,r)=>{this._loadHistory(t).then((t=>{Promise.all(this.getSequenceForOrchestration(a,e,t)).then((e=>{n(e.join(""))}),r)}),(t=>{console.log("Failed to load ".concat(a,". ").concat(t.message)),n("".concat(e,"-x").concat(a,":[FailedToLoad] \n"))}))})))}break;case"SubOrchestrationInstanceFailed":i="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(c.FunctionName,":[SubOrchestrationInstanceFailed] \n")+"end \n",r.push(Promise.resolve(i));break;case"TaskCompleted":for(var o=c.DurationInMs,l=s+1;l<a.length&&"TaskCompleted"===a[l].EventType&&a[l].FunctionName===c.FunctionName&&a[l].ScheduledTime.substr(0,23)===c.ScheduledTime.substr(0,23);l++)o<a[l].DurationInMs&&(o=a[l].DurationInMs);if(l===s+1){const t="".concat(e,"->>").concat(e,":").concat(c.FunctionName," \n")+"Note over ".concat(e,": ").concat(this.formatDuration(c.DurationInMs)," \n");r.push(Promise.resolve(t))}else{const t="par ".concat(l-s," calls \n")+"".concat(e,"->>").concat(e,":").concat(c.FunctionName," \n")+"Note over ".concat(e,": ").concat(this.formatDuration(o)," \n")+"end \n";r.push(Promise.resolve(t)),s=l-1}break;case"TaskFailed":i="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(e,":").concat(c.FunctionName," \n")+"end \n",r.push(Promise.resolve(i));break;case"EventRaised":i="".concat(n,"->>").concat(e,":").concat(c.Name," \n")+"Note over ".concat(n,",").concat(e,": ").concat(this.formatTimestamp(c.Timestamp)," \n"),r.push(Promise.resolve(i));break;case"TimerFired":i="".concat(n,"->>").concat(e,":[TimerFired] \n")+"Note over ".concat(n,",").concat(e,": ").concat(this.formatTimestamp(c.Timestamp)," \n"),r.push(Promise.resolve(i));break;case"ExecutionTerminated":i="".concat(n,"->>").concat(e,":[ExecutionTerminated] \n")+"Note over ".concat(n,",").concat(e,": ").concat(this.formatTimestamp(c.Timestamp)," \n"),r.push(Promise.resolve(i));break;case"ExecutionCompleted":i="".concat(e,"--\x3e>-").concat(t,":[ExecutionCompleted] \n")+"Note over ".concat(e,",").concat(t,": ").concat(this.formatDuration(c.DurationInMs)," \n"),r.push(Promise.resolve(i))}s++}return r}formatTimestamp(e){return e.length<=11?e:se.showTimeAsLocal?ne()(e).format("(HH:mm:ss.SSS)"):"("+e.substr(11,12)+"Z)"}}class hn extends mn{constructor(...e){super(...e),this.name="Gantt Chart"}buildDiagram(e,t,a){return new Promise(((n,r)=>{Promise.all(this.renderOrchestration(e.instanceId,e.name,t,!0)).then((t=>{if(a.isCancelled)n();else{this._diagramCode="gantt \n"+"title ".concat(e.name,"(").concat(e.instanceId,") \n")+"dateFormat YYYY-MM-DDTHH:mm:ss.SSS \n"+t.join(""),this._diagramSvg="";try{Qe.a.render("mermaidSvgId",this._diagramCode,(e=>{this._diagramSvg=e,n()}))}catch(i){r(i)}}}),r)}))}renderOrchestration(e,t,a,n){const r=[],i=a.find((e=>"ExecutionStarted"===e.EventType)),s=a.find((e=>"ExecutionCompleted"===e.EventType));var o,l=n;if(i&&s){if(l){o=s.DurationInMs>864e5?"axisFormat %Y-%m-%d %H:%M \n":"axisFormat %H:%M:%S \n",r.push(Promise.resolve(o)),l=!1}o=n?"":"section ".concat(t,"(").concat(this.escapeTitle(e),") \n");var c=this.formatDuration(s.DurationInMs);c||(c=t),o+="".concat(c,": ").concat(n?"":"active,"," ").concat(this.formatDateTime(i.Timestamp),", ").concat(this.formatDurationInSeconds(s.DurationInMs)," \n"),r.push(Promise.resolve(o))}l&&(o="axisFormat %H:%M:%S \n",r.push(Promise.resolve(o)));var m,u=Object(je.a)(a);try{for(u.s();!(m=u.n()).done;){var h=m.value;switch(h.EventType){case"SubOrchestrationInstanceCompleted":if(h.SubOrchestrationId){const e=h.SubOrchestrationId,t=h.FunctionName;r.push(new Promise(((a,n)=>{this._loadHistory(e).then((r=>{Promise.all(this.renderOrchestration(e,t,r,!1)).then((e=>{a(e.join(""))}),n)}),(e=>{console.log("Failed to load ".concat(t,". ").concat(e.message)),a("%% Failed to load ".concat(t,". ").concat(e.message," \n"))}))})))}break;case"TaskCompleted":o="".concat(h.FunctionName," ").concat(this.formatDuration(h.DurationInMs),": done, ").concat(this.formatDateTime(h.ScheduledTime),", ").concat(this.formatDurationInSeconds(h.DurationInMs)," \n"),r.push(Promise.resolve(o));break;case"TaskFailed":o="".concat(h.FunctionName," ").concat(this.formatDuration(h.DurationInMs),": crit, ").concat(this.formatDateTime(h.ScheduledTime),", ").concat(this.formatDurationInSeconds(h.DurationInMs)," \n"),r.push(Promise.resolve(o))}}}catch(d){u.e(d)}finally{u.f()}return r}formatDateTime(e){return se.showTimeAsLocal?ne()(e).format("YYYY-MM-DDTHH:mm:ss.SSS"):e.substr(0,23)}}var dn,pn;let gn=(dn=class{get rawHtml(){return this._rawHtml}constructor(e,t){this._orchestrationId=e,this._backendClient=t,this.name="",this.description="",this.isMermaidDiagram=!1,Object(te.a)(this,"_rawHtml",pn,this)}load(e,t){const a="/orchestrations('".concat(this._orchestrationId,"')/custom-tab-markup('").concat(this.name,"')");return this._backendClient.call("POST",a).then((e=>{t.isCancelled||(this._rawHtml=e)}))}},Object(V.a)(dn.prototype,"rawHtml",[U.e],Object.getOwnPropertyDescriptor(dn.prototype,"rawHtml"),dn.prototype),pn=Object(V.a)(dn.prototype,"_rawHtml",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn);var bn,yn,fn,_n,En,On,vn,Cn,Sn,wn,Tn,Pn,kn,In,Dn,Nn,jn,xn,Mn,Fn;let Ln=(bn=class extends Me{get tabIndex(){return this._tabIndex}set tabIndex(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.selectedTab?this.loadCustomTab():this._history.length||this.loadHistory())}get selectedTab(){return this._tabIndex?this._tabStates[this._tabIndex-1]:null}get details(){return this._details}get history(){return this._history}get historyTotalCount(){return this._historyTotalCount}get orchestrationId(){return this._orchestrationId}get loadInProgress(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}get inProgress(){return this._inProgress||this.loadInProgress}get autoRefresh(){return this._autoRefresh}set autoRefresh(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadDetails()}get raiseEventDialogOpen(){return this._raiseEventDialogOpen}set raiseEventDialogOpen(e){this._raiseEventDialogOpen=e,this.eventName="",this.eventData=""}get setCustomStatusDialogOpen(){return this._setCustomStatusDialogOpen}set setCustomStatusDialogOpen(e){this._setCustomStatusDialogOpen=e,this.newCustomStatus=this._details.customStatus?JSON.stringify(this._details.customStatus):""}get restartDialogOpen(){return this._restartDialogOpen}set restartDialogOpen(e){this._restartDialogOpen=e,this.restartWithNewInstanceId=!0}get isCustomStatusDirty(){return this._details.customStatus?this.newCustomStatus!==JSON.stringify(this._details.customStatus):!!this.newCustomStatus}get functionNames(){return this._functionNames}get functionGraphAvailable(){const e=ke.getFunctionName(this._details);if(!e)return!1;return Object.keys(this._functionNames).map((e=>e.toLowerCase())).includes(e.toLowerCase())}get tabStates(){return this._tabStates}get backendClient(){return this._backendClient}constructor(e,t,a,n){super(),this._orchestrationId=e,this._backendClient=a,this._localStorage=n,Object(te.a)(this,"rewindConfirmationOpen",yn,this),Object(te.a)(this,"terminateConfirmationOpen",fn,this),Object(te.a)(this,"purgeConfirmationOpen",_n,this),Object(te.a)(this,"eventName",En,this),Object(te.a)(this,"eventData",On,this),Object(te.a)(this,"newCustomStatus",vn,this),Object(te.a)(this,"restartWithNewInstanceId",Cn,this),Object(te.a)(this,"_tabStates",Sn,this),Object(te.a)(this,"_details",wn,this),Object(te.a)(this,"_history",Tn,this),Object(te.a)(this,"_tabIndex",Pn,this),Object(te.a)(this,"_inProgress",kn,this),Object(te.a)(this,"_cancelToken",In,this),Object(te.a)(this,"_raiseEventDialogOpen",Dn,this),Object(te.a)(this,"_setCustomStatusDialogOpen",Nn,this),Object(te.a)(this,"_restartDialogOpen",jn,this),Object(te.a)(this,"_autoRefresh",xn,this),Object(te.a)(this,"_historyTotalCount",Mn,this),Object(te.a)(this,"_functionNames",Fn,this),this._autoRefreshToken=void 0,this._noMorePagesToLoad=!1,this._pageSize=200;const r=this._localStorage.getItem("autoRefresh");r&&(this._autoRefresh=Number(r));const i=this._localStorage.getItem("tabIndex");i&&(this._tabIndex=Number(i)),t&&this._backendClient.call("TraverseFunctionProject",t).then((e=>{this._functionNames=e.functions}),(e=>{console.log("Failed to traverse: ".concat(e.message,".").concat(e.response?e.response.data:""," "))}))}rewind(){this.rewindConfirmationOpen=!1;const e="/orchestrations('".concat(this._orchestrationId,"')/rewind");this._inProgress=!0,this._backendClient.call("POST",e).then((()=>{this._inProgress=!1,this.loadDetails()}),(e=>{this._inProgress=!1,this.errorMessage="Failed to rewind: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}terminate(){this.terminateConfirmationOpen=!1;const e="/orchestrations('".concat(this._orchestrationId,"')/terminate");this._inProgress=!0,this._backendClient.call("POST",e).then((()=>{this._inProgress=!1,this.loadDetails()}),(e=>{this._inProgress=!1,this.errorMessage="Failed to terminate: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}purge(){this.purgeConfirmationOpen=!1;const e="/orchestrations('".concat(this._orchestrationId,"')/purge");this._inProgress=!0,this._backendClient.call("POST",e).then((()=>{this._inProgress=!1,this._history=[],this._details=new ke,this._tabStates=[]}),(e=>{this._inProgress=!1,this.errorMessage="Failed to purge: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}restart(){this.restartDialogOpen=!1;const e="/orchestrations('".concat(this._orchestrationId,"')/restart"),t={restartWithNewInstanceId:this.restartWithNewInstanceId};this._inProgress=!0,this._backendClient.call("POST",e,t).then((()=>{this._inProgress=!1,this.loadDetails()}),(e=>{this._inProgress=!1,this.errorMessage="Failed to restart: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}raiseEvent(){const e="/orchestrations('".concat(this._orchestrationId,"')/raise-event"),t={name:this.eventName,data:null};try{t.data=JSON.parse(this.eventData)}catch(a){return void(this.errorMessage="Failed to parse event data: ".concat(a.message))}finally{this.raiseEventDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",e,t).then((()=>{this._inProgress=!1,this.loadDetails()}),(e=>{this._inProgress=!1,this.errorMessage="Failed to raise an event: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}setCustomStatus(){const e="/orchestrations('".concat(this._orchestrationId,"')/set-custom-status");var t=null;try{this.newCustomStatus&&(t=JSON.parse(this.newCustomStatus))}catch(a){return void(this.errorMessage="Failed to parse custom status: ".concat(a.message))}finally{this.setCustomStatusDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",e,t).then((()=>{this._inProgress=!1,this.loadDetails()}),(e=>{this._inProgress=!1,this.errorMessage="Failed to set custom status: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}loadDetails(){if(this.inProgress)return void this.setAutoRefresh();this._inProgress=!0,this._noMorePagesToLoad=!1,this._autoRefresh||this.selectedTab||(this._history=[],this._historyTotalCount=0);const e="/orchestrations('".concat(this._orchestrationId,"')");return this._backendClient.call("GET",e).then((e=>{this._details=e,this.setAutoRefresh();var t=0;if("Orchestration"===this._details.entityType&&(this._tabStates.length<=t&&(this._tabStates.push(new un((e=>this.loadAllHistory(e)))),this._tabStates.push(new hn((e=>this.loadAllHistory(e))))),t+=2),this._details.tabTemplateNames){var a,n=Object(je.a)(this._details.tabTemplateNames);try{for(n.s();!(a=n.n()).done;){var r=a.value;this._tabStates.length<=t&&this._tabStates.push(new gn(this._orchestrationId,this._backendClient)),this._tabStates[t].name=r,t++}}catch(i){n.e(i)}finally{n.f()}}(this._tabIndex<0||this._tabIndex>this._tabStates.length)&&(this._tabIndex=0),this._inProgress=!1,this.selectedTab?this.loadCustomTab():this.loadHistory(!!this._autoRefresh)}),(e=>{this._inProgress=!1,this._autoRefresh=0,this.errorMessage="Load failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")}))}cancel(){this._cancelToken.isCancelled=!0,this._cancelToken=new Re}loadHistory(e=!1){if(this.inProgress||this.selectedTab||this._noMorePagesToLoad)return;const t=this._cancelToken;t.inProgress=!0;const a=e?0:this._history.length,n="/orchestrations('".concat(this._orchestrationId,"')/history?$top=").concat(this._pageSize,"&$skip=").concat(a);this._backendClient.call("GET",n).then((a=>{t.isCancelled||(this._historyTotalCount=a.totalCount,e?this._history=a.history:(this._history.push(...a.history),a.history.length<this._pageSize&&(this._noMorePagesToLoad=!0)))}),(e=>{this._autoRefresh=0,t.isCancelled||(this.errorMessage="Failed to load history: ".concat(e.message,".").concat(e.response?e.response.data:""," "))})).finally((()=>{t.inProgress=!1}))}gotoFunctionCode(e){this.backendClient.call("GotoFunctionCode",e).then((()=>{}),(e=>{console.log("Failed to goto function code: ".concat(e.message))}))}showFunctionsGraph(){this.backendClient.call("VisualizeFunctionsAsAGraph","").then((()=>{}),(e=>{console.log("Failed to goto functions graph: ".concat(e.message))}))}loadCustomTab(){if(this.inProgress)return;const e=this._cancelToken;e.inProgress=!0,this.selectedTab.load(this._details,e).then((()=>{}),(t=>{this._autoRefresh=0,e.isCancelled||(this.errorMessage="Failed to load tab: ".concat(t.message,".").concat(t.response?t.response.data:""," "))})).finally((()=>{e.inProgress=!1}))}setAutoRefresh(){this._autoRefresh&&(this._autoRefreshToken&&clearTimeout(this._autoRefreshToken),this._autoRefreshToken=setTimeout((()=>this.loadDetails()),1e3*this._autoRefresh))}loadAllHistory(e){const t="/orchestrations('".concat(e,"')/history");return this._backendClient.call("GET",t).then((e=>e.history))}},Object(V.a)(bn.prototype,"tabIndex",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"tabIndex"),bn.prototype),Object(V.a)(bn.prototype,"details",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"details"),bn.prototype),Object(V.a)(bn.prototype,"history",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"history"),bn.prototype),Object(V.a)(bn.prototype,"historyTotalCount",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"historyTotalCount"),bn.prototype),Object(V.a)(bn.prototype,"orchestrationId",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"orchestrationId"),bn.prototype),Object(V.a)(bn.prototype,"loadInProgress",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"loadInProgress"),bn.prototype),Object(V.a)(bn.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"inProgress"),bn.prototype),Object(V.a)(bn.prototype,"autoRefresh",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"autoRefresh"),bn.prototype),Object(V.a)(bn.prototype,"raiseEventDialogOpen",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"raiseEventDialogOpen"),bn.prototype),Object(V.a)(bn.prototype,"setCustomStatusDialogOpen",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"setCustomStatusDialogOpen"),bn.prototype),Object(V.a)(bn.prototype,"restartDialogOpen",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"restartDialogOpen"),bn.prototype),Object(V.a)(bn.prototype,"isCustomStatusDirty",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"isCustomStatusDirty"),bn.prototype),Object(V.a)(bn.prototype,"functionNames",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"functionNames"),bn.prototype),Object(V.a)(bn.prototype,"functionGraphAvailable",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"functionGraphAvailable"),bn.prototype),yn=Object(V.a)(bn.prototype,"rewindConfirmationOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fn=Object(V.a)(bn.prototype,"terminateConfirmationOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_n=Object(V.a)(bn.prototype,"purgeConfirmationOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),En=Object(V.a)(bn.prototype,"eventName",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=Object(V.a)(bn.prototype,"eventData",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=Object(V.a)(bn.prototype,"newCustomStatus",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Object(V.a)(bn.prototype,"restartWithNewInstanceId",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Object(V.a)(bn.prototype,"tabStates",[U.e],Object.getOwnPropertyDescriptor(bn.prototype,"tabStates"),bn.prototype),Sn=Object(V.a)(bn.prototype,"_tabStates",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),wn=Object(V.a)(bn.prototype,"_details",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ke}}),Tn=Object(V.a)(bn.prototype,"_history",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Pn=Object(V.a)(bn.prototype,"_tabIndex",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),kn=Object(V.a)(bn.prototype,"_inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),In=Object(V.a)(bn.prototype,"_cancelToken",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Re}}),Dn=Object(V.a)(bn.prototype,"_raiseEventDialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Nn=Object(V.a)(bn.prototype,"_setCustomStatusDialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),jn=Object(V.a)(bn.prototype,"_restartDialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xn=Object(V.a)(bn.prototype,"_autoRefresh",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Mn=Object(V.a)(bn.prototype,"_historyTotalCount",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fn=Object(V.a)(bn.prototype,"_functionNames",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),bn);var Hn=a(383);const Rn="#32;";function An(e){var t,a,n,r,i,s,o;switch(e.type){case"httpTrigger":return"http".concat(e.methods?":["+e.methods.join(",")+"]":"").concat(e.route?":"+e.route:"");case"blobTrigger":return"blob:".concat(null!==(t=e.path)&&void 0!==t?t:"");case"cosmosDBTrigger":return"cosmosDB:".concat(null!==(a=e.databaseName)&&void 0!==a?a:"",":").concat(null!==(n=e.collectionName)&&void 0!==n?n:"");case"eventHubTrigger":return"eventHub:".concat(null!==(r=e.eventHubName)&&void 0!==r?r:"");case"serviceBusTrigger":return"serviceBus:".concat(e.queueName?e.queueName:null!==(i=e.topicName)&&void 0!==i?i:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queueTrigger":return"queue:".concat(null!==(s=e.queueName)&&void 0!==s?s:"");case"timerTrigger":return"timer:".concat(null!==(o=e.schedule)&&void 0!==o?o:"");default:return e.type}}function zn(e){var t,a,n,r,i,s,o;switch(e.type){case"table":return"table:".concat(null!==(t=e.tableName)&&void 0!==t?t:"");case"blob":return"blob:".concat(null!==(a=e.path)&&void 0!==a?a:"");case"cosmosDB":return"cosmosDB:".concat(null!==(n=e.databaseName)&&void 0!==n?n:"",":").concat(null!==(r=e.collectionName)&&void 0!==r?r:"");case"eventHub":return"eventHub:".concat(null!==(i=e.eventHubName)&&void 0!==i?i:"");case"serviceBus":return"serviceBus:".concat(e.queueName?e.queueName:null!==(s=e.topicName)&&void 0!==s?s:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queue":return"queue:".concat(null!==(o=e.queueName)&&void 0!==o?o:"");default:return e.type}}var Bn,Wn,Yn;let Vn=(Bn=class extends Xe{get diagramCode(){return this._diagramCode}get diagramSvg(){return this._diagramSvg}get inProgress(){return this._inProgress}get projectPath(){return this._projectPath}get backendClient(){return this._backendClient}constructor(e,t){super(),this._projectPath=e,this._backendClient=t,Object(te.a)(this,"errorMessage",Wn,this),Object(te.a)(this,"_inProgress",Yn,this)}gotoFunctionCode(e){this.backendClient.call("GotoFunctionCode",e).then((()=>{}),(e=>{console.log("Failed to goto function code: ".concat(e.message))}))}load(){this._inProgress||(this.initMermaidWhenNeeded(),this._inProgress=!0,this.errorMessage="",this._diagramCode="",this._diagramSvg="",this._backendClient.call("TraverseFunctionProject",this._projectPath).then((e=>{try{const t=function(e){const t=[];for(const w in e){const c=e[w];var a,n=void 0,r=[],i=[],s=[],o="".concat(w,'{{"').concat(Rn).concat(w,'"}}:::function'),l=Object(je.a)(c.bindings);try{for(l.s();!(a=l.n()).done;){const e=a.value;"orchestrationTrigger"===e.type?o="".concat(w,'[["').concat(Rn).concat(w,'"]]:::orchestrator'):"activityTrigger"===e.type?o="".concat(w,'[/"').concat(Rn).concat(w,'"/]:::activity'):"entityTrigger"===e.type&&(o="".concat(w,'[("').concat(Rn).concat(w,'")]:::entity')),e.type.endsWith("Trigger")?n=e:"in"===e.direction?r.push(e):"out"===e.direction?i.push(e):s.push(e)}}catch(S){l.e(S)}finally{l.f()}t.push(Object(Hn.a)({name:w,nodeCode:o,triggerBinding:n,inputBindings:r,outputBindings:i,otherBindings:s},c))}t.sort(((e,t)=>{var a,n,r=!(null===(a=e.isCalledBy)||void 0===a?void 0:a.length)&&e.triggerBinding&&e.triggerBinding.type?e.triggerBinding.type:"";r+="~"+e.name;var i=!(null===(n=t.isCalledBy)||void 0===n?void 0:n.length)&&t.triggerBinding&&t.triggerBinding.type?t.triggerBinding.type:"";return r>(i+="~"+t.name)?1:i>r?-1:0}));for(var c="",m=0,u=t;m<u.length;m++){var h,d;const e=u[m];if(c+="".concat(e.nodeCode,"\n"),null===(h=e.isCalledBy)||void 0===h?void 0:h.length){var p,g=Object(je.a)(e.isCalledBy);try{for(g.s();!(p=g.n()).done;){const t=p.value;c+="".concat(t," --\x3e ").concat(e.name,"\n")}}catch(S){g.e(S)}finally{g.f()}}else e.triggerBinding&&(c+="".concat(e.name,".").concat(e.triggerBinding.type,'>"').concat(Rn).concat(An(e.triggerBinding),'"]:::').concat(e.triggerBinding.type," --\x3e ").concat(e.name,"\n"));var b,y=Object(je.a)(e.inputBindings);try{for(y.s();!(b=y.n()).done;){const t=b.value;c+="".concat(e.name,".").concat(t.type,'(["').concat(Rn).concat(zn(t),'"]):::').concat(t.type," -.-> ").concat(e.name,"\n")}}catch(S){y.e(S)}finally{y.f()}var f,_=Object(je.a)(e.outputBindings);try{for(_.s();!(f=_.n()).done;){const t=f.value;c+="".concat(e.name," -.-> ").concat(e.name,".").concat(t.type,'(["').concat(Rn).concat(zn(t),'"]):::').concat(t.type,"\n")}}catch(S){_.e(S)}finally{_.f()}var E,O=Object(je.a)(e.otherBindings);try{for(O.s();!(E=O.n()).done;){const t=E.value;c+="".concat(e.name," -.- ").concat(e.name,".").concat(t.type,'(["').concat(Rn).concat(zn(t),'"]):::').concat(t.type,"\n")}}catch(S){O.e(S)}finally{O.f()}if(null===(d=e.isSignalledBy)||void 0===d?void 0:d.length){var v,C=Object(je.a)(e.isSignalledBy);try{for(C.s();!(v=C.n()).done;){const t=v.value;c+="".concat(t.name,' -. "#9889; ').concat(t.signalName,'" .-> ').concat(e.name,"\n")}}catch(S){C.e(S)}finally{C.f()}}e.isCalledByItself&&(c+="".concat(e.name,' -- "[ContinueAsNew]" --\x3e ').concat(e.name,"\n"))}return c}(e.functions);if(!t)return void(this._inProgress=!1);this._diagramCode="graph LR\n".concat(t);const a=Object.keys(e.functions).filter((t=>!!e.functions[t].filePath)).map((e=>"click ".concat(e," null\n"))).join("");Qe.a.render("mermaidSvgId",this._diagramCode+a,(t=>{this._diagramSvg=this.applyIcons(t,e.pathToIcons),this._inProgress=!1}))}catch(t){this.errorMessage="Failed to render: ".concat(t.message),this._inProgress=!1}}),(e=>{this._inProgress=!1,this.errorMessage="Failed to traverse: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})))}applyIcons(e,t){return e=e.replace(/<g class="node (\w+).*?<g class="label" transform="translate\([0-9,.-]+\)"><g transform="translate\([0-9,.-]+\)">/g,'$&<image href="'.concat(t,'/$1.svg" width="20px"/>'))}},Wn=Object(V.a)(Bn.prototype,"errorMessage",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(V.a)(Bn.prototype,"diagramCode",[U.e],Object.getOwnPropertyDescriptor(Bn.prototype,"diagramCode"),Bn.prototype),Object(V.a)(Bn.prototype,"diagramSvg",[U.e],Object.getOwnPropertyDescriptor(Bn.prototype,"diagramSvg"),Bn.prototype),Object(V.a)(Bn.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(Bn.prototype,"inProgress"),Bn.prototype),Yn=Object(V.a)(Bn.prototype,"_inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bn);var Un,qn,Gn,Kn,Jn,Zn,$n,Qn;let Xn=(Un=class extends Me{get dialogOpen(){return this._dialogOpen}set dialogOpen(e){this._dialogOpen=e,e&&(this._instancesDeleted=null,this.timeFrom=ne()().subtract(1,"days").utc(),this.timeTill=ne()().utc(),this._statuses=new Set(["Completed","Terminated"]),this.entityType="Orchestration")}get instancesDeleted(){return this._instancesDeleted}get inProgress(){return this._inProgress}get isValid(){return this._statuses.size>0&&xe.isValidMoment(this.timeFrom)&&xe.isValidMoment(this.timeTill)}constructor(e){super(),this._backendClient=e,Object(te.a)(this,"timeFrom",qn,this),Object(te.a)(this,"timeTill",Gn,this),Object(te.a)(this,"entityType",Kn,this),Object(te.a)(this,"_statuses",Jn,this),Object(te.a)(this,"_dialogOpen",Zn,this),Object(te.a)(this,"_inProgress",$n,this),Object(te.a)(this,"_instancesDeleted",Qn,this)}purgeHistory(){this._inProgress=!0,this._backendClient.call("POST","/purge-history",{entityType:this.entityType,timeFrom:this.timeFrom.toISOString(),timeTill:this.timeTill.toISOString(),statuses:Array.from(this._statuses.values())}).then((e=>{this._instancesDeleted=e.instancesDeleted}),(e=>{this.errorMessage="Purge history failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})).finally((()=>{this._inProgress=!1}))}getStatusIncluded(e){return this._statuses.has(e)}setStatusIncluded(e,t){t?this._statuses.add(e):this._statuses.delete(e)}},Object(V.a)(Un.prototype,"dialogOpen",[U.e],Object.getOwnPropertyDescriptor(Un.prototype,"dialogOpen"),Un.prototype),Object(V.a)(Un.prototype,"instancesDeleted",[U.e],Object.getOwnPropertyDescriptor(Un.prototype,"instancesDeleted"),Un.prototype),Object(V.a)(Un.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(Un.prototype,"inProgress"),Un.prototype),Object(V.a)(Un.prototype,"isValid",[U.e],Object.getOwnPropertyDescriptor(Un.prototype,"isValid"),Un.prototype),qn=Object(V.a)(Un.prototype,"timeFrom",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Object(V.a)(Un.prototype,"timeTill",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kn=Object(V.a)(Un.prototype,"entityType",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Orchestration"}}),Jn=Object(V.a)(Un.prototype,"_statuses",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),Zn=Object(V.a)(Un.prototype,"_dialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),$n=Object(V.a)(Un.prototype,"_inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qn=Object(V.a)(Un.prototype,"_instancesDeleted",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Un);var er,tr,ar,nr,rr,ir;let sr=(er=class extends Me{get dialogOpen(){return this._dialogOpen}set dialogOpen(e){this._dialogOpen=e,e&&(this._response=null,this.removeEmptyEntities=!0,this.releaseOrphanedLocks=!0)}get response(){return this._response}get inProgress(){return this._inProgress}get isValid(){return!0}constructor(e){super(),this._backendClient=e,Object(te.a)(this,"removeEmptyEntities",tr,this),Object(te.a)(this,"releaseOrphanedLocks",ar,this),Object(te.a)(this,"_dialogOpen",nr,this),Object(te.a)(this,"_inProgress",rr,this),Object(te.a)(this,"_response",ir,this)}clean(){this._inProgress=!0,this._backendClient.call("POST","/clean-entity-storage",{removeEmptyEntities:this.removeEmptyEntities,releaseOrphanedLocks:this.releaseOrphanedLocks}).then((e=>{this._response=e}),(e=>{this.errorMessage="Clean Entity Storage failed: ".concat(e.message,".").concat(e.response?e.response.data:""," ")})).finally((()=>{this._inProgress=!1}))}},Object(V.a)(er.prototype,"dialogOpen",[U.e],Object.getOwnPropertyDescriptor(er.prototype,"dialogOpen"),er.prototype),Object(V.a)(er.prototype,"response",[U.e],Object.getOwnPropertyDescriptor(er.prototype,"response"),er.prototype),Object(V.a)(er.prototype,"inProgress",[U.e],Object.getOwnPropertyDescriptor(er.prototype,"inProgress"),er.prototype),Object(V.a)(er.prototype,"isValid",[U.e],Object.getOwnPropertyDescriptor(er.prototype,"isValid"),er.prototype),tr=Object(V.a)(er.prototype,"removeEmptyEntities",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ar=Object(V.a)(er.prototype,"releaseOrphanedLocks",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Object(V.a)(er.prototype,"_dialogOpen",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rr=Object(V.a)(er.prototype,"_inProgress",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ir=Object(V.a)(er.prototype,"_response",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),er);class or{constructor(e){this._prefix=e}setItem(e,t){localStorage.setItem("".concat(this._prefix,"::").concat(e),t);const a=new ot;a.values[e]=t,a.apply()}setItems(e){const t=new ot;var a,n=Object(je.a)(e);try{for(n.s();!(a=n.n()).done;){const e=a.value;null===e.value?(localStorage.removeItem("".concat(this._prefix,"::").concat(e.fieldName)),delete t.values[e.fieldName]):(localStorage.setItem("".concat(this._prefix,"::").concat(e.fieldName),e.value),t.values[e.fieldName]=e.value)}}catch(r){n.e(r)}finally{n.f()}t.apply()}getItem(e){const t=new ot;return t.values[e]?t.values[e]:localStorage.getItem("".concat(this._prefix,"::").concat(e))}removeItem(e){localStorage.removeItem("".concat(this._prefix,"::").concat(e));const t=new ot;delete t.values[e],t.apply()}}class lr{get isVsCode(){return!0}get routePrefixAndTaskHubName(){return null}constructor(e){this._vsCodeApi=e,this._handlers={},this._requests={},window.addEventListener("message",(e=>{const t=e.data,a=this._handlers[t.id];if(a){try{a(t.data)}catch(r){console.log("Failed to handle response from VsCode: "+r)}return}const n=this._requests[t.id];n&&(t.err?n.reject(t.err):n.resolve(t.data),delete this._requests[t.id])}))}call(e,t,a){const n=Math.random().toString();return this._vsCodeApi.postMessage({id:n,method:e,url:t,data:a}),new Promise(((e,t)=>{this._requests[n]={resolve:e,reject:t}}))}setCustomHandlers(e,t){this._handlers.purgeHistory=e,this._handlers.cleanEntityStorage=t,this._vsCodeApi.postMessage({method:"IAmReady"})}}class cr{constructor(e,t){this._prefix=e,this._vsCodeApi=t,this._state=void 0,this._state=StateFromVsCode[this._prefix],this._state||(this._state={})}setItem(e,t){this._state[e]=t,this.save()}setItems(e){var t,a=Object(je.a)(e);try{for(a.s();!(t=a.n()).done;){const e=t.value;null===e.value?delete this._state[e.fieldName]:this._state[e.fieldName]=e.value}}catch(n){a.e(n)}finally{a.f()}this.save()}getItem(e){return this._state[e]}removeItem(e){delete this._state[e],this.save()}save(){this._vsCodeApi.postMessage({method:"PersistState",key:this._prefix,data:this._state})}}var mr,ur,hr;let dr=(mr=class{get typedInstanceId(){return this._typedInstanceId}set typedInstanceId(e){this._typedInstanceId=e,this.reloadSuggestions()}get suggestions(){return this._suggestions}get isExactMatch(){return 1===this._suggestions.length&&this._suggestions[0]===this._typedInstanceId}constructor(){this.loginState=void 0,this.mainMenuState=void 0,this.orchestrationsState=void 0,this.orchestrationDetailsState=void 0,this.functionGraphState=void 0,this.purgeHistoryDialogState=void 0,this.cleanEntityStorageDialogState=void 0,Object(te.a)(this,"_suggestions",ur,this),Object(te.a)(this,"_typedInstanceId",hr,this),this._backendClient=void 0;var e=void 0;try{e=acquireVsCodeApi()}catch(t){}if(e){const t=new lr(e);this._backendClient=t,this.purgeHistoryDialogState=new Xn(t),this.cleanEntityStorageDialogState=new sr(t),this.instanceId?this.orchestrationDetailsState=new Ln(this.instanceId,this.functionProjectPath,t,new cr("OrchestrationDetailsState",e)):this.functionProjectPath?this.functionGraphState=new Vn(this.functionProjectPath,t):(this.orchestrationsState=new Ct(t,new cr("OrchestrationsState",e)),t.setCustomHandlers((()=>this.purgeHistoryDialogState.dialogOpen=!0),(()=>this.cleanEntityStorageDialogState.dialogOpen=!0)))}else{this.loginState=new qt;const e=new Rt((()=>this.loginState.taskHubName),(()=>this.loginState.getAuthorizationHeaderAsync()));this._backendClient=e,this.purgeHistoryDialogState=new Xn(e),this.cleanEntityStorageDialogState=new sr(e),this.instanceId?this.orchestrationDetailsState=new Ln(this.instanceId,null,e,new or("OrchestrationDetailsState")):(this.mainMenuState=new ln(e,this.purgeHistoryDialogState,this.cleanEntityStorageDialogState),this.orchestrationsState=new Ct(e,new or("OrchestrationsState")))}}goto(){window.open("".concat(this._backendClient.routePrefixAndTaskHubName).concat(Ut).concat(this._typedInstanceId)),this._typedInstanceId="",this._suggestions=[]}get functionProjectPath(){return DfmFunctionProjectPath||""}get instanceId(){if(OrchestrationIdFromVsCode)return OrchestrationIdFromVsCode;const e=window.location.pathname.lastIndexOf(Ut);return e<0?"":window.location.pathname.substr(e+Ut.length)}reloadSuggestions(){if(!this._typedInstanceId||this._typedInstanceId.length<2)return void(this._suggestions=[]);const e="/id-suggestions(prefix='".concat(this._typedInstanceId,"')");this._backendClient.call("GET",e).then((e=>{e&&this._typedInstanceId?this._suggestions=e:this._suggestions=[]}))}},Object(V.a)(mr.prototype,"typedInstanceId",[U.e],Object.getOwnPropertyDescriptor(mr.prototype,"typedInstanceId"),mr.prototype),Object(V.a)(mr.prototype,"suggestions",[U.e],Object.getOwnPropertyDescriptor(mr.prototype,"suggestions"),mr.prototype),Object(V.a)(mr.prototype,"isExactMatch",[U.e],Object.getOwnPropertyDescriptor(mr.prototype,"isExactMatch"),mr.prototype),ur=Object(V.a)(mr.prototype,"_suggestions",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),hr=Object(V.a)(mr.prototype,"_typedInstanceId",[U.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),mr);document.body.style.backgroundColor=Jt.palette.background.paper;const pr=new dr;i.render(r.createElement(s.a,{theme:Jt},r.createElement(Xa,{state:pr})),document.getElementById("root"))}},[[683,1,2]]]);
//# sourceMappingURL=main.ef04832a.chunk.js.map