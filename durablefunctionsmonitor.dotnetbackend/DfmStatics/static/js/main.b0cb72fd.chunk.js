(this["webpackJsonpdurablefunctionsmonitor.react"]=this["webpackJsonpdurablefunctionsmonitor.react"]||[]).push([[0],{420:function(e,t,n){},422:function(e,t,n){},423:function(e,t,n){},427:function(e,t,n){},428:function(e,t,n){},430:function(e,t,n){},665:function(e,t,n){var a={"./locale":368,"./locale.js":368};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=665},689:function(e,t,n){},690:function(e,t,n){},691:function(e,t,n){},692:function(e,t,n){},693:function(e,t,n){"use strict";n.r(t);var a,r,i,o,s,l,c,u,m,d,h,p=n(0),g=n(25),f=n(770),b=(n(420),n(421),n(9)),y=n(12),v=n(18),O=n(17),E=n(23),_=n(774),k=n(767),C=n(766),j=n(223),S=n(753),w=n(780),T=n(759),P=n(42),I=n(776),D=n(379),N=(n(422),n(740)),x=n(744),F=n(390),M=n(747),L=n(779),H=n(748),A=n(749),R=n(750),z=n(751),B=n(752),W=n(746),Y=n(696),V=n(743),U=n(754),q=(n(423),Object(E.a)(a=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement("div",null,p.createElement(N.a,{color:e.isLoggedInAnonymously?"secondary":"inherit",onClick:function(t){return e.menuAnchorElement=t.currentTarget}},p.createElement(V.a,null),p.createElement(_.a,{width:5}),p.createElement(x.a,{title:e.isLoggedInAnonymously?"Ensure this endpoint is not exposed to the public!":""},p.createElement(j.a,{color:e.isLoggedInAnonymously?"secondary":"inherit"},e.isLoggedInAnonymously?"Anonymous":e.userName))),!e.isLoggedInAnonymously&&p.createElement(F.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:function(){return e.menuAnchorElement=void 0}},p.createElement(M.a,{onClick:function(){return e.logout()}},"Login under a different name")),p.createElement(L.a,{open:!e.isLoggedIn},p.createElement(H.a,null,e.errorMessage?p.createElement(p.Fragment,null,p.createElement(A.a,{className:"login-progress"},p.createElement(U.a,{color:"secondary",fontSize:"large"})),p.createElement(z.a,{color:"secondary"},"Login failed. ",e.errorMessage)):e.allowedTaskHubNames?p.createElement(p.Fragment,null,p.createElement(B.a,null,"Select your Task Hub"),p.createElement(W.a,{className:"task-hub-list"},e.allowedTaskHubNames.map((function(t){return p.createElement(Y.a,{button:!0,key:t},p.createElement(S.a,{href:e.locationPathName+t},t))})))):p.createElement(p.Fragment,null,p.createElement(A.a,{className:"login-progress"},p.createElement(R.a,null)),p.createElement(z.a,null,"Login in progress...")))))}}]),n}(p.Component))||a),G=n(697),J=n(756),K=n(757),Z=n(777),$=n(758),Q=n(760),X=(n(427),n(385)),ee=n.n(X),te=n(7),ne=n(6),ae=n(781),re=n(755),ie=n(214),oe=n.n(ie),se=n(384),le=n.n(se),ce=(n(428),r=ne.d.bound,Object(E.a)((o=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(ae.a,{className:"message-snackbar",anchorOrigin:{vertical:"top",horizontal:"right"},open:!!e.errorMessage,autoHideDuration:6e3,onClose:this.handleClose},p.createElement(re.a,{className:"error-snackbar-content",message:p.createElement("span",null,p.createElement(le.a,{className:"error-icon"}),e.errorMessage),action:[p.createElement(G.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},p.createElement(oe.a,null))]}))}},{key:"handleClose",value:function(){this.props.state.errorMessage=""}}]),n}(p.Component),Object(te.a)(o.prototype,"handleClose",[r],Object.getOwnPropertyDescriptor(o.prototype,"handleClose"),o.prototype),i=o))||i),ue=n(11),me=(n(46),n(24)),de=n.n(me),he=(s=function(){function e(){var t;(Object(b.a)(this,e),Object(ue.a)(this,"_showTimeAsLocal",l,this),"Local"!==DfmClientConfig.showTimeAs)?this._showTimeAsLocal="Local"===(null===(t=localStorage)||void 0===t?void 0:t.getItem("showTimeAs")):this._showTimeAsLocal=!0}return Object(y.a)(e,[{key:"theme",get:function(){return DfmClientConfig.theme}},{key:"showTimeAsLocal",get:function(){return this._showTimeAsLocal},set:function(e){var t;null===(t=localStorage)||void 0===t||t.setItem("showTimeAs",e?"Local":"UTC"),this._showTimeAsLocal=e}},{key:"getMoment",value:function(e){return e&&e.isValid()?(this._showTimeAsLocal?e.local():e.utc(),e):e}},{key:"setMoment",value:function(e){return e&&e.isValid()&&!this._showTimeAsLocal?de()(e.toISOString(!0).slice(0,19)+"Z"):e}},{key:"formatDateTimeString",value:function(e){if(!this._showTimeAsLocal||!e||e.length<11)return e;var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1,e.length-1):"";return de()(e).format("YYYY-MM-DDTHH:mm:ss")+n}}]),e}(),Object(te.a)(s.prototype,"showTimeAsLocal",[ne.e],Object.getOwnPropertyDescriptor(s.prototype,"showTimeAsLocal"),s.prototype),l=Object(te.a)(s.prototype,"_showTimeAsLocal",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s),pe=p.createContext(new he),ge=new he,fe=Object(E.a)((m=u=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"componentDidMount",value:function(){this.props.state.setWindowTitle()}},{key:"render",value:function(){var e=this,t=this.props.state;return p.createElement(p.Fragment,null,p.createElement(G.a,{color:"inherit",onClick:function(e){return t.menuAnchorElement=e.currentTarget}},p.createElement(ee.a,null)),p.createElement(F.a,{anchorEl:t.menuAnchorElement,keepMounted:!0,open:!!t.menuAnchorElement,onClose:function(){return t.menuAnchorElement=void 0}},p.createElement(J.a,{row:!0,value:this.context.showTimeAsLocal.toString(),onChange:function(n){e.context.showTimeAsLocal="true"===n.target.value,t.menuAnchorElement=void 0,e.props.doRefresh()}},p.createElement(j.a,{className:"show-time-as-typography"},"Show time as:"),p.createElement(K.a,{control:p.createElement(Z.a,{color:"primary"}),label:"UTC",value:"false"}),p.createElement(K.a,{control:p.createElement(Z.a,{color:"primary"}),label:"Local",value:"true"})),p.createElement(M.a,{onClick:function(){return t.showConnectionParamsDialog()}},"Manage Storage Connection Settings..."),p.createElement(M.a,{onClick:function(){return t.showPurgeHistoryDialog()}},"Purge Instance History..."),p.createElement(M.a,{onClick:function(){return t.showCleanEntityStorageDialog()}},"Clean Entity Storage...")),p.createElement(L.a,{open:t.connectionParamsDialogOpen,onClose:function(){return t.connectionParamsDialogOpen=!1}},p.createElement(B.a,null,"Manage Storage Connection Settings"),p.createElement(H.a,null,t.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(z.a,null,t.isReadonly?"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)":"The below values will be saved to local.settings.json file."),p.createElement(T.a,{autoFocus:!0,margin:"dense",label:"Hub Name",fullWidth:!0,disabled:t.inProgress,InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},value:t.hubName,onChange:function(e){return t.hubName=e.target.value}}),p.createElement(T.a,{autoFocus:!0,margin:"dense",label:"Azure Storage Connection String",fullWidth:!0,disabled:t.inProgress,InputProps:{readOnly:t.isReadonly},InputLabelProps:{shrink:!0},value:t.connectionString,onChange:function(e){return t.connectionString=e.target.value}}),p.createElement(ce,{state:t})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return t.connectionParamsDialogOpen=!1},color:"primary"},"Cancel"),!t.isReadonly&&p.createElement(N.a,{onClick:function(){return t.saveConnectionParams()},disabled:!t.isDirty||!t.hubName||!t.connectionString||t.inProgress,color:"secondary"},"Save"))))}}]),n}(p.Component),u.contextType=pe,c=m))||c,be=n(768),ye=n(701),ve=n(778),Oe=n(702),Ee=n(705),_e=n(698),ke=n(775),Ce=n(769),je=n(772),Se=n(143),we=n.n(Se),Te=n(221),Pe=n.n(Te),Ie=n(387),De=n.n(Ie),Ne=(n(430),["Timestamp","EventType","Name","ScheduledTime","Result","Details"]),xe=["Completed","Running","Failed","Pending","Terminated","Canceled","ContinuedAsNew"],Fe=function(){function e(){Object(b.a)(this,e),this.instanceId=void 0,this.name=void 0,this.entityId=void 0,this.runtimeStatus=void 0,this.entityType=void 0,this.lastEvent=void 0,this.input=void 0,this.customStatus=void 0,this.output=void 0,this.createdTime=void 0,this.lastUpdatedTime=void 0,this.duration=void 0,this.tabTemplateNames=void 0}return Object(y.a)(e,null,[{key:"getFunctionName",value:function(e){return"DurableEntity"===e.entityType?e.entityId.name:e.name}}]),e}(),Me=["instanceId","name","createdTime","lastUpdatedTime","duration","runtimeStatus","lastEvent","input","output","customStatus"],Le=n(35),He=n(16),Ae=function(){function e(){Object(b.a)(this,e)}return Object(y.a)(e,null,[{key:"isValidMoment",value:function(t){return!!t&&t.isValid()&&t.isAfter(e.MinMoment)&&t.isBefore(e.MaxMoment)}},{key:"formatDuration",value:function(e){if(isNaN(e)||e<0)return"";var t=Math.floor(e/864e5),n=0,a="";t>0&&(a+=t.toFixed(0)+"d",++n,e%=864e5);var r=Math.floor(e/36e5);if(r>0){if(a+=r.toFixed(0)+"h",++n>1)return a;e%=36e5}var i=Math.floor(e/6e4);if(i>0){if(a+=i.toFixed(0)+"m",++n>1)return a;e%=6e4}var o=Math.floor(e/1e3);if(o>0){if(a+=o.toFixed(0)+"s",++n>1)return a;e%=1e3}return e>0&&(a+=e.toFixed(0)+"ms"),a||(a="0ms"),a}}]),e}();Ae.MinMoment=de()("1900-01-01"),Ae.MaxMoment=de()("2100-01-01");var Re,ze,Be,We,Ye,Ve,Ue,qe,Ge,Je,Ke,Ze,$e,Qe,Xe,et,tt,nt,at,rt,it,ot,st,lt,ct,ut,mt,dt,ht,pt,gt,ft,bt,yt,vt,Ot,Et,_t,kt,Ct,jt,St=(d=function e(){Object(b.a)(this,e),Object(ue.a)(this,"errorMessage",h,this)},h=Object(te.a)(d.prototype,"errorMessage",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),d),wt=(Re=function e(){Object(b.a)(this,e),Object(ue.a)(this,"inProgress",ze,this),Object(ue.a)(this,"isCancelled",Be,this)},ze=Object(te.a)(Re.prototype,"inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Be=Object(te.a)(Re.prototype,"isCancelled",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Re),Tt=n(222),Pt=(We=function(){function e(t,n,a){Object(b.a)(this,e),this._backendClient=t,this._localStorage=n,this._refresh=a,Object(ue.a)(this,"longJsonDialogState",Ye,this),Object(ue.a)(this,"columnUnderMouse",Ve,this),Object(ue.a)(this,"_orchestrations",Ue,this),Object(ue.a)(this,"_orderByDirection",qe,this),Object(ue.a)(this,"_orderBy",Ge,this),Object(ue.a)(this,"_hiddenColumns",Je,this),this._noMorePagesToLoad=!1,this._pageSize=50;var r=this._localStorage.getItem("orderBy");r&&(this._orderBy=r);var i=this._localStorage.getItem("orderByDirection");i&&(this._orderByDirection=i);var o=this._localStorage.getItem("hiddenColumns");o&&(this._hiddenColumns=o.split("|"))}return Object(y.a)(e,[{key:"hiddenColumns",get:function(){return this._hiddenColumns}},{key:"orchestrations",get:function(){return this._orchestrations}},{key:"orderByDirection",get:function(){return this._orderByDirection}},{key:"orderBy",get:function(){return this._orderBy},set:function(e){this._orderBy!==e?(this._orderBy=e,this._orderByDirection="asc"):"desc"===this._orderByDirection?this.resetOrderBy():this._orderByDirection="desc",this._refresh()}},{key:"backendClient",get:function(){return this._backendClient}},{key:"hideColumn",value:function(e){this._hiddenColumns.push(e),this._localStorage.setItem("hiddenColumns",this._hiddenColumns.join("|"))}},{key:"unhide",value:function(){this._hiddenColumns=[],this._localStorage.removeItem("hiddenColumns"),this._refresh()}},{key:"resetOrderBy",value:function(){this._orderBy="",this._orderByDirection="asc"}},{key:"reset",value:function(){this._orchestrations=[],this._noMorePagesToLoad=!1}},{key:"load",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a)this._noMorePagesToLoad=!1;else{if(this._noMorePagesToLoad)return Promise.resolve();this._localStorage.setItems([{fieldName:"orderBy",value:this._orderBy},{fieldName:"orderByDirection",value:this._orderByDirection}])}var r=a?0:this._orchestrations.length,i=this._orderBy?"&$orderby=".concat(this._orderBy," ").concat(this.orderByDirection):"",o=this._hiddenColumns.length?"&hidden-columns=".concat(this._hiddenColumns.join("|")):"",s="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(r).concat(e).concat(i).concat(o);return this._backendClient.call("GET",s).then((function(e){if(!t.isCancelled){var r;if(a)n._orchestrations=e;else(r=n._orchestrations).push.apply(r,Object(Tt.a)(e));e.length||(n._noMorePagesToLoad=!0)}}))}}]),e}(),Ye=Object(te.a)(We.prototype,"longJsonDialogState",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ve=Object(te.a)(We.prototype,"columnUnderMouse",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(te.a)(We.prototype,"hiddenColumns",[ne.e],Object.getOwnPropertyDescriptor(We.prototype,"hiddenColumns"),We.prototype),Object(te.a)(We.prototype,"orchestrations",[ne.e],Object.getOwnPropertyDescriptor(We.prototype,"orchestrations"),We.prototype),Object(te.a)(We.prototype,"orderByDirection",[ne.e],Object.getOwnPropertyDescriptor(We.prototype,"orderByDirection"),We.prototype),Object(te.a)(We.prototype,"orderBy",[ne.e],Object.getOwnPropertyDescriptor(We.prototype,"orderBy"),We.prototype),Ue=Object(te.a)(We.prototype,"_orchestrations",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),qe=Object(te.a)(We.prototype,"_orderByDirection",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"asc"}}),Ge=Object(te.a)(We.prototype,"_orderBy",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Je=Object(te.a)(We.prototype,"_hiddenColumns",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),We),It=n(78),Dt=n.n(It),Nt=n(123),xt=n.n(Nt),Ft=n(771),Mt=DfmRoutePrefix?"/".concat(DfmRoutePrefix,"/"):"/",Lt=Mt+"a/p/i",Ht=function(){function e(t,n){Object(b.a)(this,e),this._getTaskHubName=t,this._getAuthorizationHeaderAsync=n}return Object(y.a)(e,[{key:"isVsCode",get:function(){return!1}},{key:"routePrefixAndTaskHubName",get:function(){return Mt+this._getTaskHubName()}},{key:"call",value:function(e,t,n){var a=this;return["get","post","put"].includes(e.toLowerCase())?new Promise((function(r,i){a._getAuthorizationHeaderAsync().then((function(o){xt.a.request({url:Lt+"/"+a._getTaskHubName()+t,method:e,data:n,headers:o}).then((function(e){r(e.data)}),i)}))})):Promise.reject(new Error("Method ".concat(e," not supported")))}}]),e}(),At="/orchestrations/",Rt=(Ke=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(b.a)(this,n),e=t.call(this),Object(ue.a)(e,"menuAnchorElement",Ze,Object(He.a)(e)),Object(ue.a)(e,"_isLoggedIn",$e,Object(He.a)(e)),Object(ue.a)(e,"_userName",Qe,Object(He.a)(e)),Object(ue.a)(e,"_taskHubName",Xe,Object(He.a)(e)),Object(ue.a)(e,"_allowedTaskHubNames",et,Object(He.a)(e)),e._aadApp=void 0,xt.a.defaults.maxRedirects=0,e.login(),e}return Object(y.a)(n,[{key:"isLoggedIn",get:function(){return this._isLoggedIn}},{key:"isLoggedInAnonymously",get:function(){return!this._userName}},{key:"userName",get:function(){return this._userName}},{key:"taskHubName",get:function(){return this._taskHubName}},{key:"allowedTaskHubNames",get:function(){return this._allowedTaskHubNames}},{key:"locationPathName",get:function(){var e=window.location.pathname,t=e.lastIndexOf(At);return t>=0&&(e=e.substring(0,t)),e.endsWith("/")||(e+="/"),e}},{key:"rootUri",get:function(){var e=this.tryGetTaskHubName();if(e){var t=window.location.href.toLowerCase().lastIndexOf("/"+e.toLowerCase());if(t>=0)return window.location.href.substring(0,t)}return window.location.origin+(window.location.pathname.endsWith("/")?window.location.pathname.substr(0,window.location.pathname.length-1):window.location.pathname)}},{key:"login",value:function(){var e=this,t="".concat(Lt,"/easyauth-config");xt.a.get(t).then((function(t){return e.loginWithEasyAuthConfig(t.data)}),(function(t){e.errorMessage="".concat(t.message,".").concat(t.response?t.response.data:"")}))}},{key:"logout",value:function(){this.menuAnchorElement=void 0,this._aadApp?this._aadApp.logout():window.location.replace("/.auth/logout")}},{key:"getAuthorizationHeaderAsync",value:function(){var e=this;return this._aadApp?new Promise((function(t,n){var a={scopes:[e._aadApp.getCurrentConfiguration().auth.clientId]};e._aadApp.acquireTokenSilent(a).then((function(e){var n=e.accessToken;n||(console.log("DFM: accessToken is null, so using idToken.rawIdToken instead"),n=e.idToken.rawIdToken),t({Authorization:"Bearer ".concat(n)})}),(function(t){console.log("DFM: acquireTokenSilent() failed (".concat(t,"), so calling acquireTokenRedirect()...")),e._aadApp.acquireTokenRedirect(a)}))})):new Promise((function(e,t){return e(void 0)}))}},{key:"loginWithEasyAuthConfig",value:function(e){if(!e.clientId)return this._userName=e.userName,xt.a.interceptors.response.use((function(e){return e}),(function(e){return"Network Error"===e.message&&window.location.reload(!0),Promise.reject(e)})),void this.initializeTaskHubNameAndConfirmLogin();this._aadApp=new Ft.a({auth:{clientId:e.clientId,authority:e.authority,redirectUri:this.rootUri}}),this._aadApp.handleRedirectCallback((function(){}),(function(e,t){console.log("Failed to handle login redirect. name: ".concat(e.name,", message: ").concat(e.message,", errorCode: ").concat(e.errorCode,", errorMessage: ").concat(e.errorMessage,", accountState: ").concat(t))}));var t=this._aadApp.getAccount();t?(this._userName=t.userName,this.initializeTaskHubNameAndConfirmLogin()):this._aadApp.loginRedirect()}},{key:"initializeTaskHubNameAndConfirmLogin",value:function(){var e=this,t=this.tryGetTaskHubName();if(t)return this._taskHubName=t,void(this._isLoggedIn=!0);this.getAuthorizationHeaderAsync().then((function(t){var n="".concat(Lt,"/task-hub-names");xt.a.get(n,{headers:t}).then((function(t){var n=t.data;1===n.length?window.location.pathname=e.locationPathName+n[0]:e._allowedTaskHubNames=n}),(function(t){e.errorMessage="".concat(t.message,".").concat(t.response?t.response.data:"")}))}))}},{key:"tryGetTaskHubName",value:function(){var e=this.locationPathName;if(e.toLowerCase().endsWith("/".concat(DfmRoutePrefix.toLowerCase(),"/")))return null;var t=e.split("/").filter((function(e){return!!e}));return t.length<1?null:t[t.length-1]}}]),n}(St),Object(te.a)(Ke.prototype,"isLoggedIn",[ne.e],Object.getOwnPropertyDescriptor(Ke.prototype,"isLoggedIn"),Ke.prototype),Object(te.a)(Ke.prototype,"isLoggedInAnonymously",[ne.e],Object.getOwnPropertyDescriptor(Ke.prototype,"isLoggedInAnonymously"),Ke.prototype),Object(te.a)(Ke.prototype,"userName",[ne.e],Object.getOwnPropertyDescriptor(Ke.prototype,"userName"),Ke.prototype),Object(te.a)(Ke.prototype,"taskHubName",[ne.e],Object.getOwnPropertyDescriptor(Ke.prototype,"taskHubName"),Ke.prototype),Object(te.a)(Ke.prototype,"allowedTaskHubNames",[ne.e],Object.getOwnPropertyDescriptor(Ke.prototype,"allowedTaskHubNames"),Ke.prototype),Ze=Object(te.a)(Ke.prototype,"menuAnchorElement",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Object(te.a)(Ke.prototype,"_isLoggedIn",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Qe=Object(te.a)(Ke.prototype,"_userName",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Object(te.a)(Ke.prototype,"_taskHubName",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=Object(te.a)(Ke.prototype,"_allowedTaskHubNames",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke),zt=(it=rt=function(){function e(){Object(b.a)(this,e),Object(ue.a)(this,"_diagramCode",nt,this),Object(ue.a)(this,"_diagramSvg",at,this)}return Object(y.a)(e,[{key:"initMermaidWhenNeeded",value:function(){e._mermaidInitialized||(Dt.a.initialize({startOnLoad:!0,sequence:{noteMargin:0,boxMargin:5,boxTextMargin:5},flowchart:{curve:"Basis",useMaxWidth:!0,htmlLabels:!1}}),e._mermaidInitialized=!0)}},{key:"escapeTitle",value:function(e){return e.replace(/[@:;]/g," ")}},{key:"formatDuration",value:function(e){var t=Ae.formatDuration(e);return t?"(".concat(t,")"):""}},{key:"formatDurationInSeconds",value:function(e){return Math.ceil(e/1e3).toFixed(0)+"s"}}]),e}(),rt._mermaidInitialized=!1,tt=it,nt=Object(te.a)(tt.prototype,"_diagramCode",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),at=Object(te.a)(tt.prototype,"_diagramSvg",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt),Bt=(ot=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this))._backendClient=e,a._instances=[],a}return Object(y.a)(n,[{key:"rawHtml",get:function(){return this._diagramSvg}},{key:"diagramCode",get:function(){return this._diagramCode}},{key:"reset",value:function(){this._diagramCode="",this._diagramSvg="",this._instances=[]}},{key:"load",value:function(e,t,n){var a=this;return this.initMermaidWhenNeeded(),new Promise((function(n,r){var i="/orchestrations?$top=500&$orderby=createdTime asc".concat(e);a._backendClient.call("GET",i).then((function(e){if(a._instances=e,t.isCancelled)n();else{a._diagramCode="gantt \n"+"title Gantt Chart (".concat(e.length," instances shown) \n")+"dateFormat YYYY-MM-DDTHH:mm:ss \n"+a.renderDiagram(e),a._diagramSvg="";try{Dt.a.render("mermaidSvgId",a._diagramCode,(function(e){a._diagramSvg=e,n()}))}catch(i){r(i)}}}),r)}))}},{key:"goto",value:function(e){if(e&&e<=this._instances.length){var t=this._instances[e-1].instanceId;this._backendClient.isVsCode?this._backendClient.call("OpenInNewWindow",t):window.open("".concat(this._backendClient.routePrefixAndTaskHubName).concat(At).concat(t))}}},{key:"renderDiagram",value:function(e){var t,n="",a="",r=0,i=Object(Le.a)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,s="",l=Fe.getFunctionName(o);l!==a&&(s="section ".concat(++r,". ").concat(this.escapeTitle(l)," \n"),a=l);var c="DurableEntity"===o.entityType?o.entityId.key:o.instanceId,u=new Date(o.lastUpdatedTime).getTime()-new Date(o.createdTime).getTime();n+=s+="".concat(this.escapeTitle(c)," ").concat(this.formatDuration(u),": active, ").concat(this.formatDateTime(o.createdTime),", ").concat(this.formatDurationInSeconds(u)," \n")}}catch(m){i.e(m)}finally{i.f()}return n}},{key:"formatDateTime",value:function(e){return ge.showTimeAsLocal?de()(e).format("YYYY-MM-DDTHH:mm:ss"):e.substr(0,19)}}]),n}(zt),Object(te.a)(ot.prototype,"rawHtml",[ne.e],Object.getOwnPropertyDescriptor(ot.prototype,"rawHtml"),ot.prototype),Object(te.a)(ot.prototype,"diagramCode",[ne.e],Object.getOwnPropertyDescriptor(ot.prototype,"diagramCode"),ot.prototype),ot),Wt=(st=function(){function e(t,n){Object(b.a)(this,e),this._backendClient=t,this._filterState=n,Object(ue.a)(this,"_histograms",lt,this),this._counts={},Object(ue.a)(this,"_numOfInstancesShown",ct,this),Object(ue.a)(this,"_zoomedIn",ut,this),this._originalTimeInterval=null,this._applyingZoom=!1,this._timeRangeInMilliseconds=0,this._numOfIntervals=200,this._pageSize=1e3}return Object(y.a)(e,[{key:"zoomedIn",get:function(){return this._zoomedIn}},{key:"histograms",get:function(){return this._histograms}},{key:"numOfInstancesShown",get:function(){return this._numOfInstancesShown}},{key:"counts",get:function(){return this._counts}},{key:"timeRangeInMilliseconds",get:function(){return this._timeRangeInMilliseconds}},{key:"reset",value:function(){}},{key:"load",value:function(e,t,n){this._applyingZoom||this._zoomedIn||(this._originalTimeInterval={timeFrom:this._filterState.timeFrom,timeTill:this._filterState.timeTill,timeRange:this._filterState.timeRange}),this._numOfInstancesShown=0,this._histograms={},this._counts={};var a=this._filterState.timeFrom.valueOf(),r=Math.ceil((this._filterState.timeTill.valueOf()-a)/this._numOfIntervals);return r<=0&&(r=1),this._timeRangeInMilliseconds=this._filterState.timeTill.valueOf()-this._filterState.timeFrom.valueOf(),this.loadNextBatch(e,a,r,0,t)}},{key:"applyZoom",value:function(e,t){this._numOfInstancesShown=0,this._filterState.cancel();var n=1e3*Math.floor(e.getTime()/1e3),a=1e3*Math.ceil(t.getTime()/1e3);this._filterState.timeFrom=de()(n),this._filterState.timeTill=de()(a),this._applyingZoom=!0;try{this._filterState.reloadOrchestrations()}finally{this._applyingZoom=!1}this._zoomedIn=!0}},{key:"resetZoom",value:function(){this._zoomedIn&&this._originalTimeInterval&&(this._zoomedIn=!1,this._filterState.cancel(),this._filterState.timeFrom=this._originalTimeInterval.timeFrom,this._filterState.timeTill=this._originalTimeInterval.timeTill,this._filterState.timeRange=this._originalTimeInterval.timeRange)}},{key:"loadNextBatch",value:function(e,t,n,a,r){var i=this,o="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(this._numOfInstancesShown).concat(e);return this._backendClient.call("GET",o).then((function(o){if(r.isCancelled)return Promise.resolve();var s,l=Object(Le.a)(o);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=Fe.getFunctionName(c);if(!i._histograms[u]){for(var m=[],d=0;d<i._numOfIntervals;d++)m[d]={x0:t+d*n,x:t+(d+1)*n,y:0};i._histograms[u]=m}var h=Math.floor((new Date(c.createdTime).getTime()-t)/n);h<0||h>=i._numOfIntervals||(i._histograms[u][h].y+=1,i._counts[u]?i._counts[u]+=1:i._counts[u]=1)}}catch(p){l.e(p)}finally{l.f()}return i._numOfInstancesShown+=o.length,o.length===i._pageSize?i.loadNextBatch(e,t,n,a+1,r):void 0}))}}]),e}(),Object(te.a)(st.prototype,"zoomedIn",[ne.e],Object.getOwnPropertyDescriptor(st.prototype,"zoomedIn"),st.prototype),Object(te.a)(st.prototype,"histograms",[ne.e],Object.getOwnPropertyDescriptor(st.prototype,"histograms"),st.prototype),Object(te.a)(st.prototype,"numOfInstancesShown",[ne.e],Object.getOwnPropertyDescriptor(st.prototype,"numOfInstancesShown"),st.prototype),lt=Object(te.a)(st.prototype,"_histograms",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ct=Object(te.a)(st.prototype,"_numOfInstancesShown",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ut=Object(te.a)(st.prototype,"_zoomedIn",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),st),Yt=function(){function e(){Object(b.a)(this,e),this._values={};var t,n=window.location.search.substr(1).split("&"),a=Object(Le.a)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value.split("=");r.length>1&&(this._values[r[0]]=decodeURIComponent(r[1]))}}catch(i){a.e(i)}finally{a.f()}}return Object(y.a)(e,[{key:"values",get:function(){return this._values}},{key:"apply",value:function(){var e="";for(var t in this._values)e&&(e+="&"),e+=t+"="+encodeURIComponent(this._values[t]);window.history.replaceState(null,null,e?"?"+e:"")}}]),e}();!function(e){e[e.Equals=0]="Equals",e[e.StartsWith=1]="StartsWith",e[e.Contains=2]="Contains",e[e.NotEquals=3]="NotEquals",e[e.NotStartsWith=4]="NotStartsWith",e[e.NotContains=5]="NotContains"}(kt||(kt={})),function(e){e[e.List=0]="List",e[e.Histogram=1]="Histogram",e[e.Gantt=2]="Gantt"}(Ct||(Ct={})),function(e){e[e.Custom=0]="Custom",e[e.LastMinute=1]="LastMinute",e[e.Last10Minutes=2]="Last10Minutes",e[e.LastHour=3]="LastHour",e[e.Last24Hours=4]="Last24Hours",e[e.Last7Days=5]="Last7Days",e[e.Last30Days=6]="Last30Days",e[e.Last90Days=7]="Last90Days"}(jt||(jt={}));var Vt,Ut,qt,Gt=(mt=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e,a){var r,i;Object(b.a)(this,n),(r=t.call(this))._backendClient=e,r._localStorage=a,Object(ue.a)(r,"menuAnchorElement",dt,Object(He.a)(r)),Object(ue.a)(r,"_tabIndex",ht,Object(He.a)(r)),Object(ue.a)(r,"_cancelToken",pt,Object(He.a)(r)),Object(ue.a)(r,"_autoRefresh",gt,Object(He.a)(r)),Object(ue.a)(r,"_timeFrom",ft,Object(He.a)(r)),Object(ue.a)(r,"_timeTill",bt,Object(He.a)(r)),Object(ue.a)(r,"_timeRange",yt,Object(He.a)(r)),Object(ue.a)(r,"_filterValue",vt,Object(He.a)(r)),Object(ue.a)(r,"_filterOperator",Ot,Object(He.a)(r)),Object(ue.a)(r,"_filteredColumn",Et,Object(He.a)(r)),Object(ue.a)(r,"_showStatuses",_t,Object(He.a)(r)),r._tabStates=[new Pt(r._backendClient,r._localStorage,(function(){return r.reloadOrchestrations()})),new Wt(r._backendClient,Object(He.a)(r)),new Bt(r._backendClient)],r._refreshToken=void 0,r._delayedRefreshDelay=2500,r._oldFilterValue="",r._oldTimeFrom=void 0,r._oldTimeTill=void 0;var o=r._localStorage.getItem("timeFrom");i=o?de()(o):de()().subtract(1,"days"),r._timeFrom=i,r._oldTimeFrom=i;var s=r._localStorage.getItem("timeTill");s&&(r._timeTill=de()(s),r._oldTimeTill=r._timeTill);var l=r._localStorage.getItem("timeRange");if(l){var c=new Yt;c.values.timeFrom||c.values.timeTill||(r._timeRange=jt[l])}var u=r._localStorage.getItem("filteredColumn");u&&(r._filteredColumn=u);var m=r._localStorage.getItem("filterOperator");m&&(r._filterOperator=kt[m]);var d=r._localStorage.getItem("filterValue");d&&(r._filterValue=d,r._oldFilterValue=d);var h=r._localStorage.getItem("showStatuses");h&&(r._showStatuses=JSON.parse(h));var p=r._localStorage.getItem("autoRefresh");p&&(r._autoRefresh=Number(p));var g=r._localStorage.getItem("tabIndex");if(g){var f=Number(g);f>=0&&f<r._tabStates.length&&(r._tabIndex=f)}return r}return Object(y.a)(n,[{key:"tabIndex",get:function(){return this._tabIndex},set:function(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.reloadOrchestrations())}},{key:"selectedTabState",get:function(){return this._tabStates[this._tabIndex]}},{key:"inProgress",get:function(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}},{key:"autoRefresh",get:function(){return this._autoRefresh},set:function(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadOrchestrations(!0)}},{key:"timeFrom",get:function(){switch(this._timeRange){case jt.LastMinute:return de()().subtract(1,"minutes");case jt.Last10Minutes:return de()().subtract(10,"minutes");case jt.LastHour:return de()().subtract(1,"hours");case jt.Last24Hours:return de()().subtract(1,"days");case jt.Last7Days:return de()().subtract(7,"days");case jt.Last30Days:return de()().subtract(30,"days");case jt.Last90Days:return de()().subtract(90,"days");default:return this._timeFrom}},set:function(e){this._timeFrom=e,this._timeRange=jt.Custom,this.listState.resetOrderBy()}},{key:"timeTill",get:function(){return this._timeRange||!this._timeTill?de()():this._timeTill},set:function(e){this._timeTill=e,this._timeRange=jt.Custom,this.listState.resetOrderBy()}},{key:"timeTillEnabled",get:function(){return!!this._timeTill},set:function(e){this._timeTill=e?de()():null,e||(this.listState.resetOrderBy(),this.reloadOrchestrations())}},{key:"timeRange",get:function(){return this._timeRange},set:function(e){this.menuAnchorElement=void 0,this._timeRange=e,this.listState.resetOrderBy(),this.reloadOrchestrations()}},{key:"filterValue",get:function(){return this._filterValue},set:function(e){this._filterValue=e}},{key:"filterOperator",get:function(){return this._filterOperator},set:function(e){this._filterOperator=e,this._filterValue&&"0"!==this._filteredColumn&&this.reloadOrchestrations()}},{key:"filteredColumn",get:function(){return this._filteredColumn},set:function(e){this._filteredColumn=e,this._filterValue&&("0"===this._filteredColumn&&(this._filterValue=""),this.reloadOrchestrations())}},{key:"showStatuses",get:function(){return this._showStatuses}},{key:"isStatusChecked",value:function(e){return e?!this._showStatuses||!!this._showStatuses.includes(e):!this._showStatuses}},{key:"setStatusChecked",value:function(e,t){var n=this;if(e)t?(this._showStatuses||(this._showStatuses=[]),this._showStatuses.push(t)):this._showStatuses=null;else if(t){this._showStatuses||(this._showStatuses=[]);var a=this._showStatuses.indexOf(t);a>=0&&this._showStatuses.splice(a,1)}else this._showStatuses=[];this._refreshToken&&clearTimeout(this._refreshToken),this._refreshToken=setTimeout((function(){return n.reloadOrchestrations()}),this._delayedRefreshDelay)}},{key:"rescheduleDelayedRefresh",value:function(){var e=this;this._refreshToken&&(clearTimeout(this._refreshToken),this._refreshToken=setTimeout((function(){return e.reloadOrchestrations()}),this._delayedRefreshDelay))}},{key:"showLastEventColumn",get:function(){return"lastEvent"===this._filteredColumn&&!!this._oldFilterValue}},{key:"backendClient",get:function(){return this._backendClient}},{key:"applyTimeFrom",value:function(){Ae.isValidMoment(this._timeFrom)&&this._oldTimeFrom!==this._timeFrom&&this.reloadOrchestrations()}},{key:"applyTimeTill",value:function(){Ae.isValidMoment(this._timeTill)&&this._oldTimeTill!==this._timeTill&&this.reloadOrchestrations()}},{key:"applyFilterValue",value:function(){this._oldFilterValue!==this._filterValue&&this.reloadOrchestrations()}},{key:"reloadOrchestrations",value:function(){this._refreshToken&&(clearTimeout(this._refreshToken),this._refreshToken=null);var e,t=Object(Le.a)(this._tabStates);try{for(t.s();!(e=t.n()).done;){e.value.reset()}}catch(n){t.e(n)}finally{t.f()}Ae.isValidMoment(this._timeFrom)||(this._timeFrom=this._oldTimeFrom),this._timeTill&&!Ae.isValidMoment(this._timeTill)&&(this._timeTill=this._oldTimeTill),this._localStorage.setItems([{fieldName:"timeFrom",value:this._timeRange?null:this._timeFrom.toISOString()},{fieldName:"timeTill",value:this._timeTill&&!this._timeRange?this._timeTill.toISOString():null},{fieldName:"timeRange",value:this._timeRange?jt[this._timeRange]:null},{fieldName:"filteredColumn",value:this._filteredColumn},{fieldName:"filterOperator",value:kt[this._filterOperator]},{fieldName:"filterValue",value:this._filterValue?this._filterValue:null},{fieldName:"showStatuses",value:this._showStatuses?JSON.stringify(this._showStatuses):null}]),this.loadOrchestrations(),this._oldFilterValue=this._filterValue,this._oldTimeFrom=this._timeFrom,this._oldTimeTill=this._timeTill}},{key:"cancel",value:function(){this._cancelToken.isCancelled=!0,this._cancelToken=new wt}},{key:"loadOrchestrations",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._cancelToken;if(!n.inProgress){n.inProgress=!0;var a="&$filter=createdTime ge '".concat(this.timeFrom.toISOString(),"' and createdTime le '").concat(this.timeTill.toISOString(),"'");if(this._showStatuses&&(a+=" and runtimeStatus in (".concat(this._showStatuses.map((function(e){return"'".concat(e,"'")})).join(","),")")),this._filterValue&&"0"!==this._filteredColumn){a+=" and ";var r=encodeURIComponent(this._filterValue);switch(this._filterOperator){case kt.Equals:a+="".concat(this._filteredColumn," eq '").concat(r,"'");break;case kt.StartsWith:a+="startswith(".concat(this._filteredColumn,", '").concat(r,"')");break;case kt.Contains:a+="contains(".concat(this._filteredColumn,", '").concat(r,"')");break;case kt.NotEquals:a+="".concat(this._filteredColumn," ne '").concat(r,"'");break;case kt.NotStartsWith:a+="startswith(".concat(this._filteredColumn,", '").concat(r,"') eq false");break;case kt.NotContains:a+="contains(".concat(this._filteredColumn,", '").concat(r,"') eq false")}}this.selectedTabState.load(a,n,t).then((function(){e._refreshToken&&clearTimeout(e._refreshToken),e._autoRefresh&&(e._refreshToken=setTimeout((function(){e.loadOrchestrations(!0)}),1e3*e._autoRefresh))}),(function(t){e._autoRefresh=0,n.isCancelled||(e.errorMessage="Load failed: ".concat(t.message,".").concat(t.response?t.response.data:""," "))})).finally((function(){n.inProgress=!1}))}}},{key:"listState",get:function(){return this._tabStates[0]}}]),n}(St),Object(te.a)(mt.prototype,"tabIndex",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"tabIndex"),mt.prototype),Object(te.a)(mt.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"inProgress"),mt.prototype),Object(te.a)(mt.prototype,"autoRefresh",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"autoRefresh"),mt.prototype),Object(te.a)(mt.prototype,"timeFrom",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"timeFrom"),mt.prototype),Object(te.a)(mt.prototype,"timeTill",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"timeTill"),mt.prototype),Object(te.a)(mt.prototype,"timeTillEnabled",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"timeTillEnabled"),mt.prototype),Object(te.a)(mt.prototype,"timeRange",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"timeRange"),mt.prototype),dt=Object(te.a)(mt.prototype,"menuAnchorElement",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(te.a)(mt.prototype,"filterValue",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"filterValue"),mt.prototype),Object(te.a)(mt.prototype,"filterOperator",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"filterOperator"),mt.prototype),Object(te.a)(mt.prototype,"filteredColumn",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"filteredColumn"),mt.prototype),Object(te.a)(mt.prototype,"showStatuses",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"showStatuses"),mt.prototype),Object(te.a)(mt.prototype,"showLastEventColumn",[ne.e],Object.getOwnPropertyDescriptor(mt.prototype,"showLastEventColumn"),mt.prototype),ht=Object(te.a)(mt.prototype,"_tabIndex",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ct.List}}),pt=Object(te.a)(mt.prototype,"_cancelToken",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new wt}}),gt=Object(te.a)(mt.prototype,"_autoRefresh",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ft=Object(te.a)(mt.prototype,"_timeFrom",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt=Object(te.a)(mt.prototype,"_timeTill",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt=Object(te.a)(mt.prototype,"_timeRange",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return jt.Custom}}),vt=Object(te.a)(mt.prototype,"_filterValue",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ot=Object(te.a)(mt.prototype,"_filterOperator",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return kt.Equals}}),Et=Object(te.a)(mt.prototype,"_filteredColumn",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0"}}),_t=Object(te.a)(mt.prototype,"_showStatuses",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mt),Jt=n(704),Kt=n(265),Zt=n(761),$t=n(762),Qt=n(763),Xt=n(764),en=n(782),tn=n(765),nn=n(389),an=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME:ge.theme,rn=Object(nn.a)({palette:{type:"dark"===an?"dark":"light"}}),on="dark"===rn.palette.type?{backgroundColor:"#aaa"}:{};function sn(e){var t=null;switch(e){case"Failed":t=ln(rn.palette.error.light,.2);break;case"Completed":t=ln(rn.palette.success.light,.2);break;case"Running":t=ln(rn.palette.warning.light,.2);break;case"Terminated":t=ln(rn.palette.background.paper,.1)}return t?{backgroundColor:t}:{}}function ln(e,t){return e.length>4?"rgba(".concat(parseInt(e.slice(1,3),16),", ").concat(parseInt(e.slice(3,5),16),", ").concat(parseInt(e.slice(5,7),16),", ").concat(t.toFixed(1),")"):"rgba(".concat(parseInt(e.slice(1,2),16),", ").concat(parseInt(e.slice(2,3),16),", ").concat(parseInt(e.slice(3,4),16),", ").concat(t.toFixed(1),")")}var cn,un,mn,dn,hn,pn,gn,fn,bn=(Vt=ne.d.bound,Object(E.a)((qt=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e,t;return this.props.backendClient.isVsCode?p.createElement(S.a,{color:"dark"===rn.palette.type?"inherit":"primary",href:"/",onClick:this.onLinkClicked},null!==(e=this.props.title)&&void 0!==e?e:this.props.orchestrationId):p.createElement(S.a,{color:"dark"===rn.palette.type?"inherit":"primary",href:"".concat(this.props.backendClient.routePrefixAndTaskHubName).concat(At).concat(this.extraSanitizeHrefComponent(this.props.orchestrationId)),target:"_blank"},null!==(t=this.props.title)&&void 0!==t?t:this.props.orchestrationId)}},{key:"onLinkClicked",value:function(){this.props.backendClient.call("OpenInNewWindow",this.props.orchestrationId)}},{key:"extraSanitizeHrefComponent",value:function(e){return e.replace(/javascript:/gi,"")}}]),n}(p.Component),Object(te.a)(qt.prototype,"onLinkClicked",[Vt],Object.getOwnPropertyDescriptor(qt.prototype,"onLinkClicked"),qt.prototype),Ut=qt))||Ut),yn=n(395),vn=Object(E.a)(cn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(L.a,{fullWidth:!0,maxWidth:"md",open:!!e.jsonString,onClose:function(){return e.jsonString=""}},p.createElement(B.a,null,e.title),p.createElement(H.a,null,p.createElement(yn.a,{multiline:!0,fullWidth:!0,readOnly:!0,value:e.jsonString})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.jsonString=""},color:"primary"},"Close")))}}],[{key:"renderJson",value:function(e,t,n){if(!e)return null;var a="string"===typeof e?e:JSON.stringify(e);if(a.length<=512)return p.createElement(yn.a,{className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:5,readOnly:!0,value:a});var r="string"===typeof e?e:JSON.stringify(e,null,3);return p.createElement(S.a,{component:"button",variant:"inherit",onClick:function(){n.title=t,n.jsonString=r}},a.substr(0,20),"...")}}]),n}(p.Component))||cn,On=Object(E.a)((dn=mn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(p.Fragment,null,p.createElement(Jt.a,{className:"items-count-label"},!!e.orchestrations.length&&p.createElement(p.Fragment,null,"".concat(e.orchestrations.length," items shown"),!!e.hiddenColumns.length&&p.createElement(p.Fragment,null,", ".concat(e.hiddenColumns.length," columns hidden "),"(",p.createElement(S.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:function(){return e.unhide()}},"unhide"),")"))),p.createElement(Kt.a,{elevation:0},this.renderTable(e)),p.createElement(vn,{state:e.longJsonDialogState}))}},{key:"renderTable",value:function(e){var t=this;if(!e.orchestrations.length)return p.createElement(j.a,{variant:"h5",className:"empty-table-placeholder"},"This list is empty");var n=Me.filter((function(e){return!!t.props.showLastEventColumn||"lastEvent"!==e}));return p.createElement(Zt.a,{size:"small"},p.createElement($t.a,null,p.createElement(Qt.a,null,n.map((function(t){var a=n.length<=e.hiddenColumns.length+1;return!e.hiddenColumns.includes(t)&&p.createElement(Xt.a,{key:t,onMouseEnter:function(){return e.columnUnderMouse=t},onMouseLeave:function(){return e.columnUnderMouse=""}},p.createElement(en.a,{active:e.orderBy===t,direction:e.orderByDirection,onClick:function(){return e.orderBy=t}},t),e.columnUnderMouse===t&&!a&&p.createElement(G.a,{color:"inherit",size:"small",className:"column-hide-button",onClick:function(){return e.hideColumn(t)}},p.createElement(oe.a,null)))})))),p.createElement(tn.a,null,e.orchestrations.map((function(n){var a=sn(n.runtimeStatus),r={verticalAlign:"top"};return p.createElement(Qt.a,{key:n.instanceId,style:a},!e.hiddenColumns.includes("instanceId")&&p.createElement(Xt.a,{className:"instance-id-cell",style:r},p.createElement(bn,{orchestrationId:n.instanceId,backendClient:t.props.backendClient})),!e.hiddenColumns.includes("name")&&p.createElement(Xt.a,{className:"name-cell",style:r},n.name),!e.hiddenColumns.includes("createdTime")&&p.createElement(Xt.a,{className:"datetime-cell",style:r},t.context.formatDateTimeString(n.createdTime)),!e.hiddenColumns.includes("lastUpdatedTime")&&p.createElement(Xt.a,{className:"datetime-cell",style:r},t.context.formatDateTimeString(n.lastUpdatedTime)),!e.hiddenColumns.includes("duration")&&p.createElement(Xt.a,{style:r},Ae.formatDuration(n.duration)),!e.hiddenColumns.includes("runtimeStatus")&&p.createElement(Xt.a,{style:r},n.runtimeStatus),!e.hiddenColumns.includes("lastEvent")&&t.props.showLastEventColumn&&p.createElement(Xt.a,{style:r},n.lastEvent),!e.hiddenColumns.includes("input")&&p.createElement(Xt.a,{className:"long-text-cell",style:r},vn.renderJson(n.input,"".concat(n.instanceId," / input"),e.longJsonDialogState)),!e.hiddenColumns.includes("output")&&p.createElement(Xt.a,{className:"output-cell",style:r},vn.renderJson(n.output,"".concat(n.instanceId," / output"),e.longJsonDialogState)),!e.hiddenColumns.includes("customStatus")&&p.createElement(Xt.a,{className:"output-cell",style:r},vn.renderJson(n.customStatus,"".concat(n.instanceId," / customStatus"),e.longJsonDialogState)))}))))}}]),n}(p.Component),mn.contextType=pe,un=dn))||un,En=n(124),_n=Object(E.a)((gn=pn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state,n=Object.keys(t.histograms).sort();return p.createElement(p.Fragment,null,p.createElement(Jt.a,{className:"items-count-label"},"".concat(t.numOfInstancesShown," items shown"),t.zoomedIn&&p.createElement(p.Fragment,null,", ",p.createElement(S.a,{className:"unhide-button",component:"button",variant:"inherit",onClick:function(){return t.resetZoom()}},"reset zoom (Ctrl+Z)"))),p.createElement(En.e,{width:window.innerWidth-40,height:window.innerHeight-400,xType:"time",stackBy:"y",margin:{left:80,right:10,top:20}},!!t.numOfInstancesShown&&p.createElement(En.f,{tickTotal:7}),p.createElement(En.d,{tickTotal:7,tickFormat:function(n){return e.formatTimeTick(n,t.timeRangeInMilliseconds)}}),n.map((function(n){return p.createElement(En.c,{key:n,stroke:"white",color:e.getColorCodeForInstanceType(n),data:t.histograms[n]})})),!!t.numOfInstancesShown&&p.createElement(En.b,{color:"#829AE3",drag:!0,enableY:!1,onDragEnd:function(e){e&&t.applyZoom(e.left,e.right)}})),p.createElement(En.a,{className:"histogram-legend",colors:n.map((function(t){return e.getColorCodeForInstanceType(t)})),items:n.map((function(e){return"".concat(e," (").concat(t.counts[e],")")})),orientation:"horizontal"}))}},{key:"getColorCodeForInstanceType",value:function(e){for(var t=0,n=e.length-1;n>=0;n--)t=(t<<5)-t+e.charCodeAt(n),t&=2147483647;return t|=1048576,"#"+(t&=16777199).toString(16)}},{key:"formatTimeTick",value:function(e,t){var n=de()(e);return this.context.showTimeAsLocal||n.utc(),t>432e6?n.format("YYYY-MM-DD"):t>864e5?n.format("YYYY-MM-DD HH:mm"):t>1e4?0===n.second()?n.format("HH:mm"):n.format("HH:mm:ss"):0===n.millisecond()?n.format("HH:mm:ss"):n.format(":SSS")}}]),n}(p.Component),pn.contextType=pe,hn=gn))||hn,kn=n(142),Cn=n.n(kn),jn=n(263),Sn=n.n(jn),wn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this;return this.props.backendClient.isVsCode?p.createElement(N.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return e.props.backendClient.call("SaveAs",e.props.fileName+".svg",e.props.svg)}},p.createElement(Sn.a,null),p.createElement(_.a,{width:20}),p.createElement(j.a,{color:"inherit"},"Save as .SVG")):p.createElement(N.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,href:URL.createObjectURL(new Blob([this.props.svg],{type:"image/svg+xml"})),download:this.props.fileName+".svg"},p.createElement(Sn.a,null),p.createElement(_.a,{width:20}),p.createElement(j.a,{color:"inherit"},"Save as .SVG"))}}]),n}(p.Component);function Tn(e){return e.replace("</style>",".note { stroke: none !important; fill: none !important; } .noteText { font-size: 9px !important; } </style>")}var Pn,In,Dn,Nn,xn,Fn,Mn,Ln,Hn,An,Rn,zn,Bn,Wn,Yn,Vn,Un,qn,Gn,Jn,Kn,Zn,$n,Qn,Xn,ea,ta,na,aa,ra,ia,oa,sa,la,ca,ua,ma,da,ha,pa,ga,fa,ba,ya,va,Oa,Ea,_a,ka,Ca,ja,Sa,wa,Ta=Object(E.a)(fn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("task")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideLeft")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideRight")))}},{key:"render",value:function(){var e=this.props.state;return e.rawHtml?p.createElement(p.Fragment,null,p.createElement("div",{className:"raw-html-div",style:on,dangerouslySetInnerHTML:{__html:Tn(e.rawHtml)}}),p.createElement(C.a,{variant:"dense"},p.createElement(j.a,{style:{flex:1}}),p.createElement(N.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},p.createElement(Cn.a,null),p.createElement(_.a,{width:10}),p.createElement(j.a,{color:"inherit"},"Copy diagram code to Clipboard")),p.createElement(_.a,{width:20}),p.createElement(wn,{svg:Tn(e.rawHtml),fileName:this.props.fileName,inProgress:this.props.inProgress,backendClient:this.props.backendClient}),p.createElement(_.a,{width:20}))):null}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=function(){var n=e[a],r=parseInt(n.id.substr(4));n.onclick=function(){return t.goto(r)},n.style.cursor="pointer"},a=0;a<e.length;a++)n()}}]),n}(p.Component))||fn,Pa=(Pn=ne.d.bound,Object(E.a)((xn=Nn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.state.loadOrchestrations(),document.addEventListener("scroll",(function(t){var n=e.props.state;if(n.tabIndex===Ct.List){var a=t.target.scrollingElement;if(a){a.scrollHeight-window.innerHeight-a.scrollTop<100&&n.loadOrchestrations()}}})),document.addEventListener("keydown",(function(t){var n=e.props.state;n.tabIndex===Ct.Histogram&&t.ctrlKey&&90===t.keyCode&&n.selectedTabState.resetZoom()}))}},{key:"render",value:function(){var e=this,t=this.props.state,n=t.selectedTabState,a=t.selectedTabState,r=t.selectedTabState,i=this.context.showTimeAsLocal?"Local":"UTC";return p.createElement(p.Fragment,null,p.createElement(F.a,{anchorEl:t.menuAnchorElement,keepMounted:!0,open:!!t.menuAnchorElement,onClose:function(){return t.menuAnchorElement=void 0}},p.createElement(M.a,{onClick:function(){return t.timeRange=jt.LastMinute}},"Last Minute"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Last10Minutes}},"Last 10 Minutes"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.LastHour}},"Last Hour"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Last24Hours}},"Last 24 Hours"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Last7Days}},"Last 7 Days"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Last30Days}},"Last 30 Days"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Last90Days}},"Last 90 Days"),p.createElement(M.a,{onClick:function(){return t.timeRange=jt.Custom}},"Custom")),p.createElement(k.a,{color:"inherit",position:"static",className:"top-appbar"},t.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(C.a,{variant:"dense",className:"top-toolbar"},p.createElement(be.a,{container:!0,className:"toolbar-grid1"},p.createElement(be.a,{item:!0,xs:12},p.createElement(N.a,{size:"small",variant:"outlined",className:"time-period-menu-drop-btn",onClick:function(e){return t.menuAnchorElement=e.currentTarget}},p.createElement(De.a,null)),t.timeRange?p.createElement(T.a,{className:"from-input",label:"Time Range",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},type:"text",value:this.timeRangeToString(t.timeRange)}):p.createElement(je.a,{className:"from-input",ampm:!1,autoOk:!0,label:"From (".concat(i,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:t.inProgress,value:this.context.getMoment(t.timeFrom),onChange:function(n){return t.timeFrom=e.context.setMoment(n)},onBlur:function(){return t.applyTimeFrom()},onAccept:function(){return t.applyTimeFrom()},onKeyPress:this.handleKeyPress})),p.createElement(be.a,{item:!0,xs:12,className:"toolbar-grid1-item2"},!t.timeRange&&p.createElement(p.Fragment,null,p.createElement(ye.a,null,p.createElement(ve.a,{id:"till-checkbox",className:"till-checkbox",disabled:t.inProgress,checked:t.timeTillEnabled,onChange:function(e){return t.timeTillEnabled=e.target.checked}})),t.timeTillEnabled?p.createElement(je.a,{className:"till-input",ampm:!1,autoOk:!0,label:"Till (".concat(i,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:t.inProgress,value:this.context.getMoment(t.timeTill),onChange:function(n){return t.timeTill=e.context.setMoment(n)},onBlur:function(){return t.applyTimeTill()},onAccept:function(){return t.applyTimeTill()},onKeyPress:this.handleKeyPress}):p.createElement(T.a,{className:"till-input",label:"Till (".concat(i,")"),placeholder:"[Now]",InputLabelProps:{shrink:!0},type:"text",disabled:!0})))),p.createElement(be.a,{container:!0,className:"toolbar-grid2"},p.createElement(be.a,{item:!0,xs:12},p.createElement(ye.a,null,p.createElement(Oe.a,{htmlFor:"filtered-column-select"},"Filtered Column"),p.createElement(Ee.a,{className:"toolbar-select filtered-column-input",disabled:t.inProgress,value:t.filteredColumn,onChange:function(e){return t.filteredColumn=e.target.value},inputProps:{id:"filtered-column-select"}},p.createElement(M.a,{value:"0"},"[Not Selected]"),Me.map((function(e){return p.createElement(M.a,{key:e,value:e},e)})))),p.createElement(ye.a,{className:"toolbar-grid2-item1-select"},p.createElement(Oe.a,{htmlFor:"filter-operator-select"},"Filter Operator"),p.createElement(Ee.a,{className:"toolbar-select",disabled:t.inProgress,value:t.filterOperator,onChange:function(e){return t.filterOperator=e.target.value},inputProps:{id:"filter-operator-select"}},p.createElement(M.a,{value:kt.Equals},"Equals"),p.createElement(M.a,{value:kt.StartsWith},"Starts With"),p.createElement(M.a,{value:kt.Contains},"Contains"),p.createElement(M.a,{value:kt.NotEquals},"Not Equals"),p.createElement(M.a,{value:kt.NotStartsWith},"Not Starts With"),p.createElement(M.a,{value:kt.NotContains},"Not Contains")))),p.createElement(be.a,{item:!0,xs:12,className:"toolbar-grid2-item2"},p.createElement(T.a,{className:"filter-value-input",label:"Filter Value",InputLabelProps:{shrink:!0},placeholder:"[some text or 'null']",disabled:"0"===t.filteredColumn||t.inProgress,value:t.filterValue,onChange:function(e){return t.filterValue=e.target.value},onBlur:function(){return t.applyFilterValue()},onKeyPress:this.handleKeyPress}))),p.createElement(_e.a,{className:"toolbar-runtime-status-group"},p.createElement(Oe.a,{className:"toolbar-runtime-status-group-label",shrink:!0},"Type/Status ",t.showStatuses?" (".concat(t.showStatuses.length," selected)"):""),p.createElement(_e.a,{className:"toolbar-runtime-status-checkbox-group",onScroll:function(){return t.rescheduleDelayedRefresh()}},p.createElement(K.a,{control:p.createElement(ve.a,{className:"status-checkbox",disabled:t.inProgress,checked:t.isStatusChecked(),onChange:function(e){return t.setStatusChecked(e.target.checked)}}),label:"[All]"}),xe.map((function(e){return p.createElement(K.a,{key:e,control:p.createElement(ve.a,{className:"status-checkbox",disabled:t.inProgress,checked:t.isStatusChecked(e),onChange:function(n){return t.setStatusChecked(n.target.checked,e)}}),label:"Orchestations:"+e})})),p.createElement(K.a,{control:p.createElement(ve.a,{className:"status-checkbox",disabled:t.inProgress,checked:t.isStatusChecked("DurableEntities"),onChange:function(e){return t.setStatusChecked(e.target.checked,"DurableEntities")}}),label:"Durable Entities"}))),p.createElement(j.a,{style:{flex:1}}),p.createElement(be.a,{container:!0,className:"toolbar-grid3"},p.createElement(be.a,{item:!0,xs:12},p.createElement(ye.a,{className:"form-control-float-right"},p.createElement(Oe.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),p.createElement(Ee.a,{className:"autorefresh-select",inputProps:{id:"auto-refresh-select"},value:t.autoRefresh,onChange:function(e){return t.autoRefresh=e.target.value}},p.createElement(M.a,{value:0},"Never"),p.createElement(M.a,{value:1},"Every 1 sec."),p.createElement(M.a,{value:5},"Every 5 sec."),p.createElement(M.a,{value:10},"Every 10 sec.")))),p.createElement(be.a,{item:!0,xs:12,className:"toolbar-grid3-item2"},p.createElement(N.a,{className:"refresh-button form-control-float-right",variant:"outlined",color:"default",size:"large",onClick:function(){return t.inProgress?t.cancel():t.reloadOrchestrations()}},t.inProgress?p.createElement(Pe.a,null):p.createElement(we.a,null)))))),p.createElement(k.a,{color:"inherit",position:"static"},p.createElement(ke.a,{className:"tab-buttons",value:t.tabIndex,onChange:function(e,n){return t.tabIndex=n}},p.createElement(Ce.a,{className:"tab-buttons",disabled:t.inProgress,label:p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},"List")}),p.createElement(Ce.a,{className:"tab-buttons",disabled:t.inProgress,label:p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},"Time Histogram")}),p.createElement(Ce.a,{className:"tab-buttons",disabled:t.inProgress,label:p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},"Gantt Chart")}))),t.tabIndex===Ct.List&&p.createElement(p.Fragment,null,p.createElement(On,{state:n,showLastEventColumn:t.showLastEventColumn,backendClient:t.backendClient}),t.inProgress&&n.orchestrations.length?p.createElement($.a,null):p.createElement(_.a,{height:4})),t.tabIndex===Ct.Histogram&&p.createElement(_n,{state:a}),t.tabIndex===Ct.Gantt&&p.createElement(Ta,{state:r,inProgress:t.inProgress,fileName:"gantt-chart-".concat(t.timeFrom.format("YYYY-MM-DD-HH-mm-ss"),"-").concat(t.timeTill.format("YYYY-MM-DD-HH-mm-ss")),backendClient:t.backendClient}),p.createElement(C.a,{variant:"dense"}),p.createElement(ce,{state:this.props.state}))}},{key:"timeRangeToString",value:function(e){switch(e){case jt.LastMinute:return"Last Minute";case jt.Last10Minutes:return"Last 10 Minutes";case jt.LastHour:return"Last Hour";case jt.Last24Hours:return"Last 24 Hours";case jt.Last7Days:return"Last 7 Days";case jt.Last30Days:return"Last 30 Days";case jt.Last90Days:return"Last 90 Days";default:return""}}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.reloadOrchestrations())}}]),n}(p.Component),Nn.contextType=pe,Dn=xn,Object(te.a)(Dn.prototype,"handleKeyPress",[Pn],Object.getOwnPropertyDescriptor(Dn.prototype,"handleKeyPress"),Dn.prototype),In=Dn))||In),Ia=n(388),Da=n.n(Ia),Na=(n(689),Object(E.a)(Fn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(p.Fragment,null,this.renderDialogs(e),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.purgeConfirmationOpen=!0}},"Purge"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.raiseEventDialogOpen=!0}},"Send Signal"))}},{key:"renderDialogs",value:function(e){return p.createElement(p.Fragment,null,p.createElement(L.a,{open:e.purgeConfirmationOpen,onClose:function(){return e.purgeConfirmationOpen=!1}},p.createElement(B.a,null,"Confirm Purge"),p.createElement(H.a,null,p.createElement(z.a,null,"You're about to purge entity '",e.orchestrationId,"'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.purgeConfirmationOpen=!1},color:"primary",autoFocus:!0},"Cancel"),p.createElement(N.a,{onClick:function(){return e.purge()},color:"secondary"},"Yes, purge"))),p.createElement(L.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:function(){return e.raiseEventDialogOpen=!1}},p.createElement(B.a,null,"Send Signal"),p.createElement(H.a,null,p.createElement(z.a,null,"Provide signal name and some additional data"),p.createElement(T.a,{autoFocus:!0,margin:"dense",label:"Signal Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:function(t){return e.eventName=t.target.value}}),p.createElement(T.a,{margin:"dense",label:"Signal Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:function(t){return e.eventData=t.target.value}})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.raiseEventDialogOpen=!1},color:"primary"},"Cancel"),p.createElement(N.a,{onClick:function(){return e.raiseEvent()},disabled:!e.eventName,color:"secondary"},"Send"))))}}]),n}(p.Component))||Fn),xa=Object(E.a)(Mn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e,t,n=this.props.details,a=sn(n.runtimeStatus);return p.createElement(p.Fragment,null,p.createElement(be.a,{container:!0,className:"grid-container"},p.createElement(be.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"entityId.name",value:null===(e=n.entityId)||void 0===e?void 0:e.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:6,md:3,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"entityId.key",value:null===(t=n.entityId)||void 0===t?void 0:t.key,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"createdTime",value:n.createdTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"lastUpdatedTime",value:n.lastUpdatedTime,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"runtimeStatus",value:n.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:a})),p.createElement(be.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"input",value:JSON.stringify(n.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10})),p.createElement(be.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"customStatus",value:JSON.stringify(n.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10}))))}}]),n}(p.Component))||Mn,Fa=Object(E.a)(Ln=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(p.Fragment,null,this.renderDialogs(e),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.restartDialogOpen=!0}},"Restart"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.rewindConfirmationOpen=!0}},"Rewind"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.terminateConfirmationOpen=!0}},"Terminate"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.raiseEventDialogOpen=!0}},"Raise Event"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.setCustomStatusDialogOpen=!0}},"Set Custom Status"),p.createElement(_.a,{width:10}),p.createElement(N.a,{variant:"outlined",color:"primary",size:"medium",disabled:this.props.disabled,onClick:function(){return e.purgeConfirmationOpen=!0}},"Purge"))}},{key:"renderDialogs",value:function(e){return p.createElement(p.Fragment,null,p.createElement(L.a,{open:e.rewindConfirmationOpen,onClose:function(){return e.rewindConfirmationOpen=!1}},p.createElement(B.a,null,"Confirm Rewind"),p.createElement(H.a,null,p.createElement(z.a,null,"You're about to rewind orchestration '",e.orchestrationId,"'. Are you sure?")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.rewindConfirmationOpen=!1},color:"primary",autoFocus:!0},"Cancel"),p.createElement(N.a,{onClick:function(){return e.rewind()},color:"secondary"},"Yes, rewind"))),p.createElement(L.a,{open:e.terminateConfirmationOpen,onClose:function(){return e.terminateConfirmationOpen=!1}},p.createElement(B.a,null,"Confirm Terminate"),p.createElement(H.a,null,p.createElement(z.a,null,"You're about to terminate orchestration '",e.orchestrationId,"'. This operation cannot be undone. Are you sure?")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.terminateConfirmationOpen=!1},color:"primary",autoFocus:!0},"Cancel"),p.createElement(N.a,{onClick:function(){return e.terminate()},color:"secondary"},"Yes, terminate"))),p.createElement(L.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:function(){return e.raiseEventDialogOpen=!1}},p.createElement(B.a,null,"Raise Event"),p.createElement(H.a,null,p.createElement(z.a,null,"Provide event name and some additional data"),p.createElement(T.a,{autoFocus:!0,margin:"dense",label:"Event Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:function(t){return e.eventName=t.target.value}}),p.createElement(T.a,{margin:"dense",label:"Event Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:function(t){return e.eventData=t.target.value}})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.raiseEventDialogOpen=!1},color:"primary"},"Cancel"),p.createElement(N.a,{onClick:function(){return e.raiseEvent()},disabled:!e.eventName,color:"secondary"},"Raise"))),p.createElement(L.a,{fullWidth:!0,open:e.setCustomStatusDialogOpen,onClose:function(){return e.setCustomStatusDialogOpen=!1}},p.createElement(B.a,null,"Set customStatus"),p.createElement(H.a,null,p.createElement(z.a,null,"customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself."),p.createElement(T.a,{margin:"dense",InputLabelProps:{shrink:!0},label:"New customStatus (JSON)",fullWidth:!0,multiline:!0,rows:10,value:e.newCustomStatus,onChange:function(t){return e.newCustomStatus=t.target.value}})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.setCustomStatusDialogOpen=!1},color:"primary"},"Cancel"),p.createElement(N.a,{onClick:function(){return e.setCustomStatus()},disabled:!e.isCustomStatusDirty,color:"secondary"},"Apply"))),p.createElement(L.a,{open:e.purgeConfirmationOpen,onClose:function(){return e.purgeConfirmationOpen=!1}},p.createElement(B.a,null,"Confirm Purge"),p.createElement(H.a,null,p.createElement(z.a,null,"You're about to purge orchestration '",e.orchestrationId,"'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.purgeConfirmationOpen=!1},color:"primary",autoFocus:!0},"Cancel"),p.createElement(N.a,{onClick:function(){return e.purge()},color:"secondary"},"Yes, purge"))),p.createElement(L.a,{open:e.restartDialogOpen,onClose:function(){return e.restartDialogOpen=!1}},p.createElement(B.a,null,"Confirm Restart"),p.createElement(H.a,null,p.createElement(z.a,null,"You're about to restart orchestration '",e.orchestrationId,"'. Are you sure?"),p.createElement(K.a,{control:p.createElement(ve.a,{checked:e.restartWithNewInstanceId,onChange:function(t){return e.restartWithNewInstanceId=t.target.checked}}),label:"Restart with new instanceId"})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.restartDialogOpen=!1},color:"primary",autoFocus:!0},"Cancel"),p.createElement(N.a,{onClick:function(){return e.restart()},color:"secondary"},"Restart"))))}}]),n}(p.Component))||Ln,Ma=Object(E.a)((Rn=An=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("scroll",(function(t){var n=t.target.scrollingElement;if(n){n.scrollHeight-window.innerHeight-n.scrollTop<50&&e.props.state.loadHistory()}}))}},{key:"render",value:function(){var e=this.props.state,t=e.historyTotalCount,n=e.details,a=e.history,r=a.length,i=sn(n.runtimeStatus);return p.createElement(p.Fragment,null,p.createElement(be.a,{container:!0,className:"grid-container"},p.createElement(be.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"instanceId",value:n.instanceId,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"name",value:n.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"createdTime",value:this.context.formatDateTimeString(n.createdTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"lastUpdatedTime",value:this.context.formatDateTimeString(n.lastUpdatedTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),p.createElement(be.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"runtimeStatus",value:n.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:i})),p.createElement(be.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"input",value:JSON.stringify(n.input,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),p.createElement(be.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"output",value:JSON.stringify(n.output,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),p.createElement(be.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},p.createElement(T.a,{label:"customStatus",value:JSON.stringify(n.customStatus,null,3),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8}))),p.createElement(Jt.a,{className:"history-events-count-label"},"historyEvents: ",t===r?"".concat(r," items"):"".concat(r," of ").concat(t," items shown")),!!a.length&&this.renderTable(a),p.createElement(vn,{state:e.longJsonDialogState}))}},{key:"getFunctionName",value:function(e){var t;return e.Name?e.Name:null!==(t=e.FunctionName)&&void 0!==t?t:""}},{key:"renderEventLink",value:function(e){var t=this.props.state;if(e.SubOrchestrationId)return p.createElement(bn,{orchestrationId:e.SubOrchestrationId,title:e.FunctionName,backendClient:t.backendClient});var n=this.getFunctionName(e);return t.functionNames[n]?p.createElement(S.a,{href:"/",color:"dark"===rn.palette.type?"inherit":"primary",onClick:function(){t.gotoFunctionCode(n)}},n):n}},{key:"renderTable",value:function(e){var t=this;return p.createElement(Zt.a,{size:"small"},p.createElement($t.a,null,p.createElement(Qt.a,null,Ne.map((function(e){return p.createElement(Xt.a,{key:e},e)})))),p.createElement(tn.a,null,e.map((function(e,n){var a={verticalAlign:"top"};return p.createElement(Qt.a,{key:n},p.createElement(Xt.a,{style:a},t.context.formatDateTimeString(e.Timestamp)),p.createElement(Xt.a,{style:a},e.EventType),p.createElement(Xt.a,{className:"name-cell",style:a},t.renderEventLink(e)),p.createElement(Xt.a,{style:a},t.context.formatDateTimeString(e.ScheduledTime)),p.createElement(Xt.a,{className:"long-text-cell",style:a},vn.renderJson(e.Result,"".concat(e.EventType," / ").concat(t.getFunctionName(e)," / ").concat(Ne[4]),t.props.state.longJsonDialogState)),p.createElement(Xt.a,{className:"long-text-cell",style:a},vn.renderJson(e.Details,"".concat(e.EventType," / ").concat(t.getFunctionName(e)," / ").concat(Ne[5]),t.props.state.longJsonDialogState)))}))))}}]),n}(p.Component),An.contextType=pe,Hn=Rn))||Hn,La=Object(E.a)(zn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"componentDidMount",value:function(){this.props.state.loadDetails()}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("actor")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("messageText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("task")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideLeft")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideRight")))}},{key:"render",value:function(){var e=this.props.state;return p.createElement(p.Fragment,null,p.createElement(k.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(C.a,{variant:"dense",className:"details-top-toolbar"},"Orchestration"===e.details.entityType&&p.createElement(Fa,{state:e,disabled:e.inProgress}),"DurableEntity"===e.details.entityType&&p.createElement(Na,{state:e,disabled:e.inProgress}),p.createElement(_.a,{width:20}),p.createElement(j.a,{style:{flex:1}}),p.createElement(ye.a,null,p.createElement(Oe.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),p.createElement(Ee.a,{className:"toolbar-select",value:e.autoRefresh,onChange:function(t){return e.autoRefresh=t.target.value},inputProps:{id:"auto-refresh-select"}},p.createElement(M.a,{value:0},"Never"),p.createElement(M.a,{value:1},"Every 1 sec."),p.createElement(M.a,{value:5},"Every 5 sec."),p.createElement(M.a,{value:10},"Every 10 sec."))),p.createElement(_.a,{width:20}),p.createElement(N.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress&&!e.loadInProgress,onClick:function(){return e.loadInProgress?e.cancel():e.loadDetails()}},e.loadInProgress?p.createElement(Pe.a,null):p.createElement(we.a,null)))),(!!e.tabStates.length||e.functionGraphAvailable)&&p.createElement(p.Fragment,null,p.createElement(k.a,{color:"inherit",position:"static"},p.createElement(ke.a,{className:"tab-buttons",value:e.tabIndex,onChange:function(t,n){"functions-graph-link"!==n&&(e.tabIndex=n)}},p.createElement(Ce.a,{className:"tab-buttons",disabled:e.inProgress,label:p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},"Details")}),e.tabStates.map((function(t){return p.createElement(Ce.a,{className:"tab-buttons",key:t.name,disabled:e.inProgress,label:p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},t.name)})})),e.functionGraphAvailable&&p.createElement(Ce.a,{className:"tab-buttons",disabled:e.inProgress,value:"functions-graph-link",onClick:function(t){t.preventDefault(),e.showFunctionsGraph()},label:p.createElement("span",{className:"functions-graph-tab-span"},p.createElement(j.a,{color:"textPrimary",variant:"subtitle2"},"Functions Graph"),p.createElement(Da.a,{className:"functions-graph-link-icon"}))})))),!e.tabIndex&&"Orchestration"===e.details.entityType&&p.createElement(p.Fragment,null,p.createElement(Ma,{state:e}),e.inProgress&&e.history.length?p.createElement($.a,null):p.createElement(_.a,{height:4})),!e.tabIndex&&"DurableEntity"===e.details.entityType&&p.createElement(xa,{details:e.details}),!!e.selectedTab&&!!e.selectedTab.rawHtml&&p.createElement(p.Fragment,null,p.createElement("div",{className:"raw-html-div",style:on,dangerouslySetInnerHTML:{__html:Tn(e.selectedTab.rawHtml)}}),e.selectedTab.isMermaidDiagram&&p.createElement(C.a,{variant:"dense"},p.createElement(j.a,{style:{flex:1}}),p.createElement(N.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.selectedTab.description)}},p.createElement(Cn.a,null),p.createElement(_.a,{width:10}),p.createElement(j.a,{color:"inherit"},"Copy diagram code to Clipboard")),p.createElement(_.a,{width:20}),p.createElement(wn,{svg:Tn(e.selectedTab.rawHtml),fileName:e.orchestrationId,inProgress:e.inProgress,backendClient:e.backendClient}),p.createElement(_.a,{width:20}))),p.createElement(ce,{state:this.props.state}))}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=0;n<e.length;n++){var a=e[n],r=a.getAttribute("data-function-name");if(!r){r=a.innerHTML;var i=/>(.+)</.exec(r);i&&(r=i[1])}t.functionNames[r]&&function(){var e=r;a.onclick=function(){return t.gotoFunctionCode(e)},a.style.cursor="pointer"}()}}}]),n}(p.Component))||zn,Ha=(n(690),Object(E.a)(Bn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"componentDidMount",value:function(){this.props.state.load()}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("orchestrator")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")))}},{key:"render",value:function(){var e=this.props.state;return p.createElement(p.Fragment,null,p.createElement(k.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(C.a,{variant:"dense",className:"details-top-toolbar"},p.createElement(_.a,{width:20}),p.createElement(T.a,{fullWidth:!0,label:"Function Project Path",disabled:!0,InputLabelProps:{shrink:!0},type:"text",value:e.projectPath}),p.createElement(_.a,{width:20}),p.createElement(j.a,{style:{flex:1}}),p.createElement(N.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress,onClick:function(){return e.load()}},p.createElement(we.a,null)))),p.createElement(Jt.a,{className:"link-to-az-func-as-a-graph"},"powered by ",p.createElement(S.a,{variant:"inherit",href:"https://github.com/scale-tone/az-func-as-a-graph"},"az-func-as-a-graph"),")"),!!e.diagramSvg&&p.createElement(p.Fragment,null,p.createElement("div",{className:"diagram-div",style:on,dangerouslySetInnerHTML:{__html:Tn(e.diagramSvg)}}),p.createElement(C.a,{variant:"dense"},p.createElement(N.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},p.createElement(Cn.a,null),p.createElement(_.a,{width:10}),p.createElement(j.a,{color:"inherit"},"Copy diagram code to Clipboard")),p.createElement(_.a,{width:20}),p.createElement(wn,{svg:Tn(e.diagramSvg),fileName:"functions.svg",inProgress:e.inProgress,backendClient:e.backendClient}))),p.createElement(ce,{state:this.props.state}))}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=0;n<e.length;n++){var a=e[n],r=/flowchart-(.+)-/.exec(a.id);r&&function(){var e=r[1];a.onclick=function(){return t.gotoFunctionCode(e)}}()}}}]),n}(p.Component))||Bn),Aa=n(703),Ra=(n(691),Object(E.a)((Vn=Yn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state,n=this.context.showTimeAsLocal?"Local":"UTC";return p.createElement(L.a,{open:t.dialogOpen,onClose:function(){t.inProgress||(t.dialogOpen=!1)}},p.createElement(B.a,null,"Purge Instance History"),null===t.instancesDeleted&&p.createElement("div",null,p.createElement(H.a,null,t.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(z.a,null,"WARNING: this operation drops instance states from the underlying storage and cannot be undone.","DurableEntity"===t.entityType&&p.createElement(j.a,{color:"error"},"It might as well remove Durable Entities, that are still active. Ensure that you specify the correct time frame! To clean up deleted Entities use the 'Clean Entity Storage' command instead.")),p.createElement(ye.a,{className:"purge-history-statuses",disabled:t.inProgress,fullWidth:!0},p.createElement(Aa.a,null,"Apply to:"),p.createElement(J.a,{row:!0,value:t.entityType,onChange:function(e){return t.entityType=e.target.value}},p.createElement(K.a,{disabled:t.inProgress,value:"Orchestration",control:p.createElement(Z.a,null),label:"Orchestrations"}),p.createElement(K.a,{disabled:t.inProgress,value:"DurableEntity",control:p.createElement(Z.a,null),label:"Durable Entities"}))),p.createElement(je.a,{className:"purge-history-from-input",ampm:!1,autoOk:!0,label:"DurableEntity"===t.entityType?"Last Updated From (".concat(n,")"):"From (".concat(n,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:t.inProgress,value:this.context.getMoment(t.timeFrom),onChange:function(n){return t.timeFrom=e.context.setMoment(n)}}),p.createElement(je.a,{className:"purge-history-till-input",ampm:!1,autoOk:!0,label:"DurableEntity"===t.entityType?"Last Updated Till (".concat(n,")"):"Till (".concat(n,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:t.inProgress,value:this.context.getMoment(t.timeTill),onChange:function(n){return t.timeTill=e.context.setMoment(n)}}),p.createElement(ye.a,{className:"purge-history-statuses",disabled:t.inProgress},p.createElement(Aa.a,null,"With the following status:"),"Orchestration"===t.entityType&&p.createElement(_e.a,{row:!0},p.createElement(za,{state:t,runtimeStatus:"Completed"}),p.createElement(za,{state:t,runtimeStatus:"Failed"}),p.createElement(za,{state:t,runtimeStatus:"Terminated"})),"DurableEntity"===t.entityType&&p.createElement(_e.a,{row:!0},p.createElement(x.a,{title:"Durable Entities are always in 'Running' state"},p.createElement(K.a,{control:p.createElement(ve.a,{checked:!0}),label:"Running",disabled:!0})))),p.createElement(ce,{state:t})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return t.dialogOpen=!1},disabled:t.inProgress,color:"primary"},"Cancel"),p.createElement(N.a,{onClick:function(){return t.purgeHistory()},disabled:!t.isValid||t.inProgress,color:"secondary"},"Purge"))),null!==t.instancesDeleted&&p.createElement("div",null,p.createElement(H.a,null,p.createElement(z.a,{className:"success-message"},t.instancesDeleted," instances were deleted.")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return t.dialogOpen=!1},color:"primary"},"Close"))))}}]),n}(p.Component),Yn.contextType=pe,Wn=Vn))||Wn),za=Object(E.a)(Un=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state,t=this.props.runtimeStatus;return p.createElement(K.a,{control:p.createElement(ve.a,{checked:e.getStatusIncluded(t),onChange:function(n){return e.setStatusIncluded(t,n.target.checked)}}),label:t})}}]),n}(p.Component))||Un,Ba=(n(692),Object(E.a)(qn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this.props.state;return p.createElement(L.a,{open:e.dialogOpen,onClose:function(){e.inProgress||(e.dialogOpen=!1)}},p.createElement(B.a,null,"Clean Entity Storage"),!e.response&&p.createElement(p.Fragment,null,p.createElement(H.a,null,e.inProgress?p.createElement($.a,null):p.createElement(_.a,{height:4}),p.createElement(z.a,null,"An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than EntityMessageReorderWindowInMinutes. Locks are considered orphaned, and are released, if the orchestration that holds them is not in state Running."),p.createElement(ye.a,{className:"purge-history-statuses",disabled:e.inProgress},p.createElement(_e.a,{row:!0},p.createElement(K.a,{control:p.createElement(ve.a,{checked:e.removeEmptyEntities,onChange:function(t){return e.removeEmptyEntities=t.target.checked}}),label:"Remove Empty Entities"}),p.createElement(K.a,{control:p.createElement(ve.a,{checked:e.releaseOrphanedLocks,onChange:function(t){return e.releaseOrphanedLocks=t.target.checked}}),label:"Release Orphaned Locks"}))),p.createElement(ce,{state:e})),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.dialogOpen=!1},disabled:e.inProgress,color:"primary"},"Cancel"),p.createElement(N.a,{onClick:function(){return e.clean()},disabled:!e.isValid||e.inProgress,color:"secondary"},"Clean"))),!!e.response&&p.createElement(p.Fragment,null,p.createElement(H.a,null,p.createElement(z.a,{className:"success-message"},e.response.numberOfEmptyEntitiesRemoved," empty entities removed."),p.createElement(z.a,{className:"success-message"},e.response.numberOfOrphanedLocksRemoved," orphaned locks removed.")),p.createElement(Q.a,null,p.createElement(N.a,{onClick:function(){return e.dialogOpen=!1},color:"primary"},"Close"))))}}]),n}(p.Component))||qn),Wa=Object(E.a)(Gn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(y.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state;return p.createElement(P.a,{utils:D.a},p.createElement(pe.Provider,{value:ge},!t.loginState&&p.createElement(_.a,{height:20}),!!t.loginState&&p.createElement(k.a,{position:"static",color:"default",className:"app-bar"},p.createElement(C.a,null,t.loginState.isLoggedIn&&!!t.mainMenuState&&p.createElement(fe,{state:t.mainMenuState,doRefresh:function(){return t.orchestrationsState.reloadOrchestrations()}}),p.createElement("img",{src:"".concat(DfmRoutePrefix?"/":"").concat(DfmRoutePrefix,"/logo.svg"),width:"30px"}),p.createElement(_.a,{width:5}),p.createElement(j.a,{variant:"h6",color:"inherit",className:"title-typography"},p.createElement(S.a,{color:"inherit",href:t.loginState.rootUri},"Durable Functions Monitor")),p.createElement(w.a,{color:"inherit"},p.createElement(S.a,{color:"inherit",href:t.loginState.locationPathName},"/ ",t.loginState.taskHubName),t.orchestrationDetailsState?p.createElement(j.a,{color:"inherit"},p.createElement(S.a,{color:"inherit",href:window.location.pathname},t.orchestrationDetailsState.orchestrationId)):p.createElement(I.a,{className:"instance-id-input",freeSolo:!0,options:t.isExactMatch?[]:t.suggestions,value:t.typedInstanceId,onChange:function(e,n){t.typedInstanceId=null!==n&&void 0!==n?n:"",n&&t.goto()},renderInput:function(n){return p.createElement(T.a,Object.assign({},n,{className:t.isExactMatch?"instance-id-valid":null,size:"small",label:"instanceId to go to...",variant:"outlined",onChange:function(e){return t.typedInstanceId=e.target.value},onKeyPress:function(t){return e.handleKeyPress(t)}}))}})),p.createElement(j.a,{style:{flex:1}}),p.createElement(q,{state:t.loginState}))),!!t.orchestrationsState&&(!t.loginState||t.loginState.isLoggedIn)&&p.createElement(Pa,{state:t.orchestrationsState}),!!t.orchestrationDetailsState&&(!t.loginState||t.loginState.isLoggedIn)&&p.createElement(La,{state:t.orchestrationDetailsState}),!!t.functionGraphState&&(!t.loginState||t.loginState.isLoggedIn)&&p.createElement(Ha,{state:t.functionGraphState}),p.createElement(Ra,{state:t.purgeHistoryDialogState}),p.createElement(Ba,{state:t.cleanEntityStorageDialogState})))}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.goto())}}]),n}(p.Component))||Gn,Ya=(Jn=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e,a,r){var i;return Object(b.a)(this,n),(i=t.call(this))._backendClient=e,i._purgeHistoryDialogState=a,i._cleanEntityStorageDialogState=r,Object(ue.a)(i,"menuAnchorElement",Kn,Object(He.a)(i)),Object(ue.a)(i,"hubName",Zn,Object(He.a)(i)),Object(ue.a)(i,"connectionString",$n,Object(He.a)(i)),Object(ue.a)(i,"connectionParamsDialogOpen",Qn,Object(He.a)(i)),Object(ue.a)(i,"_inProgress",Xn,Object(He.a)(i)),Object(ue.a)(i,"_isReadOnly",ea,Object(He.a)(i)),i._oldConnectionString=void 0,i._oldHubName=void 0,i}return Object(y.a)(n,[{key:"inProgress",get:function(){return this._inProgress}},{key:"isReadonly",get:function(){return this._isReadOnly}},{key:"isDirty",get:function(){return this.connectionString!==this._oldConnectionString||this.hubName!==this._oldHubName}},{key:"showConnectionParamsDialog",value:function(){var e=this;this.menuAnchorElement=void 0,this.connectionParamsDialogOpen=!0,this._inProgress=!0,this._backendClient.call("GET","/manage-connection").then((function(t){e.connectionString=e._oldConnectionString=t.connectionString,e.hubName=e._oldHubName=t.hubName,e._isReadOnly=t.isReadOnly}),(function(t){e.errorMessage="Load failed: ".concat(t.message,".").concat(t.response?t.response.data:""," ")})).finally((function(){e._inProgress=!1}))}},{key:"saveConnectionParams",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("PUT","/manage-connection",{connectionString:this.connectionString!==this._oldConnectionString?this.connectionString:"",hubName:this.hubName}).then((function(){e.connectionParamsDialogOpen=!1,alert("Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.")}),(function(t){e.errorMessage="Save failed: ".concat(t.message,".").concat(t.response?t.response.data:""," ")})).finally((function(){e._inProgress=!1}))}},{key:"showPurgeHistoryDialog",value:function(){this.menuAnchorElement=void 0,this._purgeHistoryDialogState.dialogOpen=!0}},{key:"showCleanEntityStorageDialog",value:function(){this.menuAnchorElement=void 0,this._cleanEntityStorageDialogState.dialogOpen=!0}},{key:"setWindowTitle",value:function(){this._backendClient.call("GET","/about").then((function(e){document.title="Durable Functions Monitor (".concat(e.accountName,"/").concat(e.hubName,") v").concat(e.version)}))}}]),n}(St),Kn=Object(te.a)(Jn.prototype,"menuAnchorElement",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn=Object(te.a)(Jn.prototype,"hubName",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$n=Object(te.a)(Jn.prototype,"connectionString",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qn=Object(te.a)(Jn.prototype,"connectionParamsDialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(te.a)(Jn.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(Jn.prototype,"inProgress"),Jn.prototype),Object(te.a)(Jn.prototype,"isReadonly",[ne.e],Object.getOwnPropertyDescriptor(Jn.prototype,"isReadonly"),Jn.prototype),Object(te.a)(Jn.prototype,"isDirty",[ne.e],Object.getOwnPropertyDescriptor(Jn.prototype,"isDirty"),Jn.prototype),Xn=Object(te.a)(Jn.prototype,"_inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ea=Object(te.a)(Jn.prototype,"_isReadOnly",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Jn),Va=(ta=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this))._loadHistory=e,a.name="Diagram",a.isMermaidDiagram=!0,a}return Object(y.a)(n,[{key:"description",get:function(){return this._diagramCode}},{key:"rawHtml",get:function(){return this._diagramSvg}},{key:"load",value:function(e,t){var n=this;return this.initMermaidWhenNeeded(),this._loadHistory(e.instanceId).then((function(a){if(a.length&&!t.isCancelled)return n.buildDiagram(e,a,t)}))}}]),n}(zt),Object(te.a)(ta.prototype,"description",[ne.e],Object.getOwnPropertyDescriptor(ta.prototype,"description"),ta.prototype),Object(te.a)(ta.prototype,"rawHtml",[ne.e],Object.getOwnPropertyDescriptor(ta.prototype,"rawHtml"),ta.prototype),ta),Ua=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="Sequence Diagram",e}return Object(y.a)(n,[{key:"buildDiagram",value:function(e,t,n){var a=this;return new Promise((function(r,i){Promise.all(a.getSequenceForOrchestration(e.name,".",t)).then((function(e){if(n.isCancelled)r();else{a._diagramCode="sequenceDiagram \n"+e.join("");try{a._diagramSvg="",Dt.a.render("mermaidSvgId",a._diagramCode,(function(e){a._diagramSvg=e,r()}))}catch(t){i(t)}}}),i)}))}},{key:"getSequenceForOrchestration",value:function(e,t,n){for(var a,r=this,i=".",o=[],s=0;s<n.length;){var l=n[s];switch(l.EventType){case"ExecutionStarted":a="".concat(t,"->>+").concat(e,":[ExecutionStarted] \n")+"Note over ".concat(t,",").concat(e,": ").concat(this.formatTimestamp(l.Timestamp)," \n"),o.push(Promise.resolve(a));break;case"SubOrchestrationInstanceCompleted":l.SubOrchestrationId&&function(){var t=l.SubOrchestrationId,n=l.FunctionName;o.push(new Promise((function(a,i){r._loadHistory(t).then((function(t){Promise.all(r.getSequenceForOrchestration(n,e,t)).then((function(e){a(e.join(""))}),i)}),(function(t){console.log("Failed to load ".concat(n,". ").concat(t.message)),a("".concat(e,"-x").concat(n,":[FailedToLoad] \n"))}))})))}();break;case"SubOrchestrationInstanceFailed":a="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(l.FunctionName,":[SubOrchestrationInstanceFailed] \n")+"end \n",o.push(Promise.resolve(a));break;case"TaskCompleted":for(var c=l.DurationInMs,u=s+1;u<n.length&&"TaskCompleted"===n[u].EventType&&n[u].FunctionName===l.FunctionName&&n[u].ScheduledTime.substr(0,23)===l.ScheduledTime.substr(0,23);u++)c<n[u].DurationInMs&&(c=n[u].DurationInMs);if(u===s+1){var m="".concat(e,"->>").concat(e,":").concat(l.FunctionName," \n")+"Note over ".concat(e,": ").concat(this.formatDuration(l.DurationInMs)," \n");o.push(Promise.resolve(m))}else{var d="par ".concat(u-s," calls \n")+"".concat(e,"->>").concat(e,":").concat(l.FunctionName," \n")+"Note over ".concat(e,": ").concat(this.formatDuration(c)," \n")+"end \n";o.push(Promise.resolve(d)),s=u-1}break;case"TaskFailed":a="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(e,":").concat(l.FunctionName," \n")+"end \n",o.push(Promise.resolve(a));break;case"EventRaised":a="".concat(i,"->>").concat(e,":").concat(l.Name," \n")+"Note over ".concat(i,",").concat(e,": ").concat(this.formatTimestamp(l.Timestamp)," \n"),o.push(Promise.resolve(a));break;case"TimerFired":a="".concat(i,"->>").concat(e,":[TimerFired] \n")+"Note over ".concat(i,",").concat(e,": ").concat(this.formatTimestamp(l.Timestamp)," \n"),o.push(Promise.resolve(a));break;case"ExecutionTerminated":a="".concat(i,"->>").concat(e,":[ExecutionTerminated] \n")+"Note over ".concat(i,",").concat(e,": ").concat(this.formatTimestamp(l.Timestamp)," \n"),o.push(Promise.resolve(a));break;case"ExecutionCompleted":a="".concat(e,"--\x3e>-").concat(t,":[ExecutionCompleted] \n")+"Note over ".concat(e,",").concat(t,": ").concat(this.formatDuration(l.DurationInMs)," \n"),o.push(Promise.resolve(a))}s++}return o}},{key:"formatTimestamp",value:function(e){return e.length<=11?e:ge.showTimeAsLocal?de()(e).format("(HH:mm:ss.SSS)"):"("+e.substr(11,12)+"Z)"}}]),n}(Va),qa=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;Object(b.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="Gantt Chart",e}return Object(y.a)(n,[{key:"buildDiagram",value:function(e,t,n){var a=this;return new Promise((function(r,i){Promise.all(a.renderOrchestration(e.instanceId,e.name,t,!0)).then((function(t){if(n.isCancelled)r();else{var o=t.flat(),s=o.filter((function(e){return!!e.functionName}));a._diagramCode="gantt \n"+"title ".concat(e.name,"(").concat(e.instanceId,") \n")+"dateFormat YYYY-MM-DDTHH:mm:ss.SSS \n"+o.map((function(e){return e.nextLine})).join(""),a._diagramSvg="";try{Dt.a.render("mermaidSvgId",a._diagramCode,(function(e){e=a.injectFunctionNameAttributes(e,s),e=a.adjustIntervalsSmallerThanOneSecond(e,s),a._diagramSvg=e,r()}))}catch(l){i(l)}}}),i)}))}},{key:"injectFunctionNameAttributes",value:function(e,t){return e.replace(new RegExp('<(rect|text) id="task([0-9]+)(-text)?"',"gi"),(function(e,n,a){var r=parseInt(a);if(r<=0||r>t.length)return e;var i=t[r-1];return i.functionName?e+' data-function-name="'.concat(i.functionName,'"'):e}))}},{key:"adjustIntervalsSmallerThanOneSecond",value:function(e,t){return e.replace(new RegExp('<rect id="task([0-9]+)" [^>]+ width="([0-9]+)"',"gi"),(function(n,a,r){var i=parseInt(a);if(i<=0||i>t.length)return n;var o=t[i-1];if(!o.parentInstanceId||!o.widthPercentage||o.duration>1e4)return n;var s=t.findIndex((function(e){return e.instanceId===o.parentInstanceId}));if(s<0)return n;var l=new RegExp('<rect id="task'.concat(s+1,'" [^>]+ width="([0-9]+)"'),"i").exec(e);if(!l)return n;var c=parseInt(l[1]),u=o.widthPercentage>1?c:Math.ceil(c*o.widthPercentage);return n.replace('width="'.concat(r,'"'),'width="'.concat(u.toFixed(0),'"'))}))}},{key:"renderOrchestration",value:function(e,t,n,a){var r,i=this,o=[],s=n.find((function(e){return"ExecutionStarted"===e.EventType})),l=n.find((function(e){return"ExecutionCompleted"===e.EventType})),c=a,u=0;if(s&&l){if(c){var m=l.DurationInMs>864e5;r=m?"axisFormat %Y-%m-%d %H:%M \n":"axisFormat %H:%M:%S \n",o.push(Promise.resolve([{nextLine:r}])),c=!1}r=a?"":"section ".concat(t,"(").concat(this.escapeTitle(e),") \n");var d=this.formatDuration(l.DurationInMs);d||(d=t),r+="".concat(d,": ").concat(a?"":"active,"," ").concat(this.formatDateTime(s.Timestamp),", ").concat(this.formatDurationInSeconds(l.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:t,instanceId:e}])),u=l.DurationInMs}c&&(r="axisFormat %H:%M:%S \n",o.push(Promise.resolve([{nextLine:r}])));var h,p=Object(Le.a)(n);try{for(p.s();!(h=p.n()).done;){var g=h.value,f=g.ScheduledTime;switch(s&&Date.parse(f)<Date.parse(s.Timestamp)&&(f=s.Timestamp),g.EventType){case"SubOrchestrationInstanceCompleted":case"SubOrchestrationInstanceFailed":g.SubOrchestrationId&&function(){var n=g.SubOrchestrationId,a=g.FunctionName;o.push(new Promise((function(e,t){i._loadHistory(n).then((function(r){Promise.all(i.renderOrchestration(n,a,r,!1)).then((function(t){e(t.flat())}),t)}),(function(t){console.log("Failed to load ".concat(a,". ").concat(t.message)),e([{nextLine:"%% Failed to load ".concat(a,". ").concat(t.message," \n")}])}))}))),r="section ".concat(t,"(").concat(i.escapeTitle(e),") \n"),o.push(Promise.resolve([{nextLine:r}]))}();break;case"TaskCompleted":r="".concat(g.FunctionName," ").concat(this.formatDuration(g.DurationInMs),": done, ").concat(this.formatDateTime(f),", ").concat(this.formatDurationInSeconds(g.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:g.FunctionName,parentInstanceId:e,duration:g.DurationInMs,widthPercentage:u?g.DurationInMs/u:0}]));break;case"TaskFailed":r="".concat(g.FunctionName," ").concat(this.formatDuration(g.DurationInMs),": crit, ").concat(this.formatDateTime(f),", ").concat(this.formatDurationInSeconds(g.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:g.FunctionName,parentInstanceId:e,duration:g.DurationInMs,widthPercentage:u?g.DurationInMs/u:0}]));break;case"TimerFired":r="[TimerFired]: done, ".concat(this.formatDateTime(g.Timestamp),", 1s \n"),o.push(Promise.resolve([{nextLine:r,functionName:t,parentInstanceId:e,duration:1,widthPercentage:1e-4}]))}}}catch(b){p.e(b)}finally{p.f()}return o}},{key:"formatDateTime",value:function(e){return ge.showTimeAsLocal?de()(e).format("YYYY-MM-DDTHH:mm:ss.SSS"):e.substr(0,23)}}]),n}(Va),Ga=(na=function(){function e(t,n){Object(b.a)(this,e),this._orchestrationId=t,this._backendClient=n,this.name="",this.description="",this.isMermaidDiagram=!1,Object(ue.a)(this,"_rawHtml",aa,this)}return Object(y.a)(e,[{key:"rawHtml",get:function(){return this._rawHtml}},{key:"load",value:function(e,t){var n=this,a="/orchestrations('".concat(this._orchestrationId,"')/custom-tab-markup('").concat(this.name,"')");return this._backendClient.call("POST",a).then((function(e){t.isCancelled||(n._rawHtml=e)}))}}]),e}(),Object(te.a)(na.prototype,"rawHtml",[ne.e],Object.getOwnPropertyDescriptor(na.prototype,"rawHtml"),na.prototype),aa=Object(te.a)(na.prototype,"_rawHtml",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),na),Ja=(ra=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e,a,r,i){var o;Object(b.a)(this,n),(o=t.call(this))._orchestrationId=e,o._backendClient=r,o._localStorage=i,Object(ue.a)(o,"rewindConfirmationOpen",ia,Object(He.a)(o)),Object(ue.a)(o,"terminateConfirmationOpen",oa,Object(He.a)(o)),Object(ue.a)(o,"purgeConfirmationOpen",sa,Object(He.a)(o)),Object(ue.a)(o,"eventName",la,Object(He.a)(o)),Object(ue.a)(o,"eventData",ca,Object(He.a)(o)),Object(ue.a)(o,"newCustomStatus",ua,Object(He.a)(o)),Object(ue.a)(o,"restartWithNewInstanceId",ma,Object(He.a)(o)),Object(ue.a)(o,"longJsonDialogState",da,Object(He.a)(o)),Object(ue.a)(o,"_tabStates",ha,Object(He.a)(o)),Object(ue.a)(o,"_details",pa,Object(He.a)(o)),Object(ue.a)(o,"_history",ga,Object(He.a)(o)),Object(ue.a)(o,"_tabIndex",fa,Object(He.a)(o)),Object(ue.a)(o,"_inProgress",ba,Object(He.a)(o)),Object(ue.a)(o,"_cancelToken",ya,Object(He.a)(o)),Object(ue.a)(o,"_raiseEventDialogOpen",va,Object(He.a)(o)),Object(ue.a)(o,"_setCustomStatusDialogOpen",Oa,Object(He.a)(o)),Object(ue.a)(o,"_restartDialogOpen",Ea,Object(He.a)(o)),Object(ue.a)(o,"_autoRefresh",_a,Object(He.a)(o)),Object(ue.a)(o,"_historyTotalCount",ka,Object(He.a)(o)),Object(ue.a)(o,"_functionNames",Ca,Object(He.a)(o)),o._autoRefreshToken=void 0,o._noMorePagesToLoad=!1,o._pageSize=200;var s=o._localStorage.getItem("autoRefresh");s&&(o._autoRefresh=Number(s));var l=o._localStorage.getItem("tabIndex");return l&&(o._tabIndex=Number(l)),a&&o._backendClient.call("TraverseFunctionProject",a).then((function(e){o._functionNames=e.functions}),(function(e){console.log("Failed to traverse: ".concat(e.message,".").concat(e.response?e.response.data:""," "))})),o}return Object(y.a)(n,[{key:"tabIndex",get:function(){return this._tabIndex},set:function(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.selectedTab?this.loadCustomTab():this._history.length||this.loadHistory())}},{key:"selectedTab",get:function(){return this._tabIndex?this._tabStates[this._tabIndex-1]:null}},{key:"details",get:function(){return this._details}},{key:"history",get:function(){return this._history}},{key:"historyTotalCount",get:function(){return this._historyTotalCount}},{key:"orchestrationId",get:function(){return this._orchestrationId}},{key:"loadInProgress",get:function(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}},{key:"inProgress",get:function(){return this._inProgress||this.loadInProgress}},{key:"autoRefresh",get:function(){return this._autoRefresh},set:function(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadDetails()}},{key:"raiseEventDialogOpen",get:function(){return this._raiseEventDialogOpen},set:function(e){this._raiseEventDialogOpen=e,this.eventName="",this.eventData=""}},{key:"setCustomStatusDialogOpen",get:function(){return this._setCustomStatusDialogOpen},set:function(e){this._setCustomStatusDialogOpen=e,this.newCustomStatus=this._details.customStatus?JSON.stringify(this._details.customStatus):""}},{key:"restartDialogOpen",get:function(){return this._restartDialogOpen},set:function(e){this._restartDialogOpen=e,this.restartWithNewInstanceId=!0}},{key:"isCustomStatusDirty",get:function(){return this._details.customStatus?this.newCustomStatus!==JSON.stringify(this._details.customStatus):!!this.newCustomStatus}},{key:"functionNames",get:function(){return this._functionNames}},{key:"functionGraphAvailable",get:function(){var e=Fe.getFunctionName(this._details);return!!e&&Object.keys(this._functionNames).map((function(e){return e.toLowerCase()})).includes(e.toLowerCase())}},{key:"tabStates",get:function(){return this._tabStates}},{key:"backendClient",get:function(){return this._backendClient}},{key:"rewind",value:function(){var e=this;this.rewindConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/rewind");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to rewind: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"terminate",value:function(){var e=this;this.terminateConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/terminate");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to terminate: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"purge",value:function(){var e=this;this.purgeConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/purge");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e._history=[],e._details=new Fe,e._tabStates=[]}),(function(t){e._inProgress=!1,e.errorMessage="Failed to purge: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"restart",value:function(){var e=this;this.restartDialogOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/restart"),n={restartWithNewInstanceId:this.restartWithNewInstanceId};this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to restart: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"raiseEvent",value:function(){var e=this,t="/orchestrations('".concat(this._orchestrationId,"')/raise-event"),n={name:this.eventName,data:null};try{n.data=JSON.parse(this.eventData)}catch(a){return void(this.errorMessage="Failed to parse event data: ".concat(a.message))}finally{this.raiseEventDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to raise an event: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"setCustomStatus",value:function(){var e=this,t="/orchestrations('".concat(this._orchestrationId,"')/set-custom-status"),n=null;try{this.newCustomStatus&&(n=JSON.parse(this.newCustomStatus))}catch(a){return void(this.errorMessage="Failed to parse custom status: ".concat(a.message))}finally{this.setCustomStatusDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to set custom status: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}},{key:"loadDetails",value:function(){var e=this;if(!this.inProgress){this._inProgress=!0,this._noMorePagesToLoad=!1,this._autoRefresh||this.selectedTab||(this._history=[],this._historyTotalCount=0);var t="/orchestrations('".concat(this._orchestrationId,"')");return this._backendClient.call("GET",t).then((function(t){e._details=t,e.setAutoRefresh();var n=0;if("Orchestration"===e._details.entityType&&(e._tabStates.length<=n&&(e._tabStates.push(new Ua((function(t){return e.loadAllHistory(t)}))),e._tabStates.push(new qa((function(t){return e.loadAllHistory(t)})))),n+=2),e._details.tabTemplateNames){var a,r=Object(Le.a)(e._details.tabTemplateNames);try{for(r.s();!(a=r.n()).done;){var i=a.value;e._tabStates.length<=n&&e._tabStates.push(new Ga(e._orchestrationId,e._backendClient)),e._tabStates[n].name=i,n++}}catch(o){r.e(o)}finally{r.f()}}(e._tabIndex<0||e._tabIndex>e._tabStates.length)&&(e._tabIndex=0),e._inProgress=!1,e.selectedTab?e.loadCustomTab():e.loadHistory(!!e._autoRefresh)}),(function(t){e._inProgress=!1,e._autoRefresh=0,e.errorMessage="Load failed: ".concat(t.message,".").concat(t.response?t.response.data:""," ")}))}this.setAutoRefresh()}},{key:"cancel",value:function(){this._cancelToken.isCancelled=!0,this._cancelToken=new wt}},{key:"loadHistory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(this.inProgress||this.selectedTab||this._noMorePagesToLoad)){var n=this._cancelToken;n.inProgress=!0;var a=t?0:this._history.length,r="/orchestrations('".concat(this._orchestrationId,"')/history?$top=").concat(this._pageSize,"&$skip=").concat(a);this._backendClient.call("GET",r).then((function(a){var r;n.isCancelled||(e._historyTotalCount=a.totalCount,t?e._history=a.history:((r=e._history).push.apply(r,Object(Tt.a)(a.history)),a.history.length<e._pageSize&&(e._noMorePagesToLoad=!0)))}),(function(t){e._autoRefresh=0,n.isCancelled||(e.errorMessage="Failed to load history: ".concat(t.message,".").concat(t.response?t.response.data:""," "))})).finally((function(){n.inProgress=!1}))}}},{key:"gotoFunctionCode",value:function(e){this.backendClient.call("GotoFunctionCode",e).then((function(){}),(function(e){console.log("Failed to goto function code: ".concat(e.message))}))}},{key:"showFunctionsGraph",value:function(){this.backendClient.call("VisualizeFunctionsAsAGraph","").then((function(){}),(function(e){console.log("Failed to goto functions graph: ".concat(e.message))}))}},{key:"loadCustomTab",value:function(){var e=this;if(!this.inProgress){var t=this._cancelToken;t.inProgress=!0,this.selectedTab.load(this._details,t).then((function(){}),(function(n){e._autoRefresh=0,t.isCancelled||(e.errorMessage="Failed to load tab: ".concat(n.message,".").concat(n.response?n.response.data:""," "))})).finally((function(){t.inProgress=!1}))}}},{key:"setAutoRefresh",value:function(){var e=this;this._autoRefresh&&(this._autoRefreshToken&&clearTimeout(this._autoRefreshToken),this._autoRefreshToken=setTimeout((function(){return e.loadDetails()}),1e3*this._autoRefresh))}},{key:"loadAllHistory",value:function(e){var t="/orchestrations('".concat(e,"')/history");return this._backendClient.call("GET",t).then((function(e){return e.history}))}}]),n}(St),Object(te.a)(ra.prototype,"tabIndex",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"tabIndex"),ra.prototype),Object(te.a)(ra.prototype,"details",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"details"),ra.prototype),Object(te.a)(ra.prototype,"history",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"history"),ra.prototype),Object(te.a)(ra.prototype,"historyTotalCount",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"historyTotalCount"),ra.prototype),Object(te.a)(ra.prototype,"orchestrationId",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"orchestrationId"),ra.prototype),Object(te.a)(ra.prototype,"loadInProgress",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"loadInProgress"),ra.prototype),Object(te.a)(ra.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"inProgress"),ra.prototype),Object(te.a)(ra.prototype,"autoRefresh",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"autoRefresh"),ra.prototype),Object(te.a)(ra.prototype,"raiseEventDialogOpen",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"raiseEventDialogOpen"),ra.prototype),Object(te.a)(ra.prototype,"setCustomStatusDialogOpen",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"setCustomStatusDialogOpen"),ra.prototype),Object(te.a)(ra.prototype,"restartDialogOpen",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"restartDialogOpen"),ra.prototype),Object(te.a)(ra.prototype,"isCustomStatusDirty",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"isCustomStatusDirty"),ra.prototype),Object(te.a)(ra.prototype,"functionNames",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"functionNames"),ra.prototype),Object(te.a)(ra.prototype,"functionGraphAvailable",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"functionGraphAvailable"),ra.prototype),ia=Object(te.a)(ra.prototype,"rewindConfirmationOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),oa=Object(te.a)(ra.prototype,"terminateConfirmationOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),sa=Object(te.a)(ra.prototype,"purgeConfirmationOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),la=Object(te.a)(ra.prototype,"eventName",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ca=Object(te.a)(ra.prototype,"eventData",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ua=Object(te.a)(ra.prototype,"newCustomStatus",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ma=Object(te.a)(ra.prototype,"restartWithNewInstanceId",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),da=Object(te.a)(ra.prototype,"longJsonDialogState",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Object(te.a)(ra.prototype,"tabStates",[ne.e],Object.getOwnPropertyDescriptor(ra.prototype,"tabStates"),ra.prototype),ha=Object(te.a)(ra.prototype,"_tabStates",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),pa=Object(te.a)(ra.prototype,"_details",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Fe}}),ga=Object(te.a)(ra.prototype,"_history",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fa=Object(te.a)(ra.prototype,"_tabIndex",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ba=Object(te.a)(ra.prototype,"_inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ya=Object(te.a)(ra.prototype,"_cancelToken",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new wt}}),va=Object(te.a)(ra.prototype,"_raiseEventDialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Oa=Object(te.a)(ra.prototype,"_setCustomStatusDialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ea=Object(te.a)(ra.prototype,"_restartDialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_a=Object(te.a)(ra.prototype,"_autoRefresh",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ka=Object(te.a)(ra.prototype,"_historyTotalCount",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ca=Object(te.a)(ra.prototype,"_functionNames",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ra),Ka=n(391),Za="#32;";function $a(e){var t,n,a,r,i,o,s;switch(e.type){case"httpTrigger":return"http".concat(e.methods?":["+e.methods.join(",")+"]":"").concat(e.route?":"+e.route:"");case"blobTrigger":return"blob:".concat(null!==(t=e.path)&&void 0!==t?t:"");case"cosmosDBTrigger":return"cosmosDB:".concat(null!==(n=e.databaseName)&&void 0!==n?n:"",":").concat(null!==(a=e.collectionName)&&void 0!==a?a:"");case"eventHubTrigger":return"eventHub:".concat(null!==(r=e.eventHubName)&&void 0!==r?r:"");case"serviceBusTrigger":return"serviceBus:".concat(e.queueName?e.queueName:null!==(i=e.topicName)&&void 0!==i?i:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queueTrigger":return"queue:".concat(null!==(o=e.queueName)&&void 0!==o?o:"");case"timerTrigger":return"timer:".concat(null!==(s=e.schedule)&&void 0!==s?s:"");default:return e.type}}function Qa(e){var t,n,a,r,i,o,s;switch(e.type){case"table":return"table:".concat(null!==(t=e.tableName)&&void 0!==t?t:"");case"blob":return"blob:".concat(null!==(n=e.path)&&void 0!==n?n:"");case"cosmosDB":return"cosmosDB:".concat(null!==(a=e.databaseName)&&void 0!==a?a:"",":").concat(null!==(r=e.collectionName)&&void 0!==r?r:"");case"eventHub":return"eventHub:".concat(null!==(i=e.eventHubName)&&void 0!==i?i:"");case"serviceBus":return"serviceBus:".concat(e.queueName?e.queueName:null!==(o=e.topicName)&&void 0!==o?o:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queue":return"queue:".concat(null!==(s=e.queueName)&&void 0!==s?s:"");default:return e.type}}var Xa,er,tr,nr,ar,rr,ir,or,sr,lr,cr,ur,mr,dr,hr,pr,gr,fr=(ja=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e,a){var r;return Object(b.a)(this,n),(r=t.call(this))._projectPath=e,r._backendClient=a,Object(ue.a)(r,"errorMessage",Sa,Object(He.a)(r)),Object(ue.a)(r,"_inProgress",wa,Object(He.a)(r)),r}return Object(y.a)(n,[{key:"diagramCode",get:function(){return this._diagramCode}},{key:"diagramSvg",get:function(){return this._diagramSvg}},{key:"inProgress",get:function(){return this._inProgress}},{key:"projectPath",get:function(){return this._projectPath}},{key:"backendClient",get:function(){return this._backendClient}},{key:"gotoFunctionCode",value:function(e){this.backendClient.call("GotoFunctionCode",e).then((function(){}),(function(e){console.log("Failed to goto function code: ".concat(e.message))}))}},{key:"load",value:function(){var e=this;this._inProgress||(this.initMermaidWhenNeeded(),this._inProgress=!0,this.errorMessage="",this._diagramCode="",this._diagramSvg="",this._backendClient.call("TraverseFunctionProject",this._projectPath).then((function(t){try{var n=function(e){var t=[];for(var n in e){var a,r=e[n],i=void 0,o=[],s=[],l=[],c="".concat(n,'{{"').concat(Za).concat(n,'"}}:::function'),u=Object(Le.a)(r.bindings);try{for(u.s();!(a=u.n()).done;){var m=a.value;"orchestrationTrigger"===m.type?c="".concat(n,'[["').concat(Za).concat(n,'"]]:::orchestrator'):"activityTrigger"===m.type?c="".concat(n,'[/"').concat(Za).concat(n,'"/]:::activity'):"entityTrigger"===m.type&&(c="".concat(n,'[("').concat(Za).concat(n,'")]:::entity')),m.type.endsWith("Trigger")?i=m:"in"===m.direction?o.push(m):"out"===m.direction?s.push(m):l.push(m)}}catch(x){u.e(x)}finally{u.f()}t.push(Object(Ka.a)({name:n,nodeCode:c,triggerBinding:i,inputBindings:o,outputBindings:s,otherBindings:l},r))}t.sort((function(e,t){var n,a,r=!(null===(n=e.isCalledBy)||void 0===n?void 0:n.length)&&e.triggerBinding&&e.triggerBinding.type?e.triggerBinding.type:"";r+="~"+e.name;var i=!(null===(a=t.isCalledBy)||void 0===a?void 0:a.length)&&t.triggerBinding&&t.triggerBinding.type?t.triggerBinding.type:"";return r>(i+="~"+t.name)?1:i>r?-1:0}));for(var d="",h=0,p=t;h<p.length;h++){var g,f,b=p[h];if(d+="".concat(b.nodeCode,"\n"),null===(g=b.isCalledBy)||void 0===g?void 0:g.length){var y,v=Object(Le.a)(b.isCalledBy);try{for(v.s();!(y=v.n()).done;){var O=y.value;d+="".concat(O," --\x3e ").concat(b.name,"\n")}}catch(x){v.e(x)}finally{v.f()}}else b.triggerBinding&&(d+="".concat(b.name,".").concat(b.triggerBinding.type,'>"').concat(Za).concat($a(b.triggerBinding),'"]:::').concat(b.triggerBinding.type," --\x3e ").concat(b.name,"\n"));var E,_=Object(Le.a)(b.inputBindings);try{for(_.s();!(E=_.n()).done;){var k=E.value;d+="".concat(b.name,".").concat(k.type,'(["').concat(Za).concat(Qa(k),'"]):::').concat(k.type," -.-> ").concat(b.name,"\n")}}catch(x){_.e(x)}finally{_.f()}var C,j=Object(Le.a)(b.outputBindings);try{for(j.s();!(C=j.n()).done;){var S=C.value;d+="".concat(b.name," -.-> ").concat(b.name,".").concat(S.type,'(["').concat(Za).concat(Qa(S),'"]):::').concat(S.type,"\n")}}catch(x){j.e(x)}finally{j.f()}var w,T=Object(Le.a)(b.otherBindings);try{for(T.s();!(w=T.n()).done;){var P=w.value;d+="".concat(b.name," -.- ").concat(b.name,".").concat(P.type,'(["').concat(Za).concat(Qa(P),'"]):::').concat(P.type,"\n")}}catch(x){T.e(x)}finally{T.f()}if(null===(f=b.isSignalledBy)||void 0===f?void 0:f.length){var I,D=Object(Le.a)(b.isSignalledBy);try{for(D.s();!(I=D.n()).done;){var N=I.value;d+="".concat(N.name,' -. "#9889; ').concat(N.signalName,'" .-> ').concat(b.name,"\n")}}catch(x){D.e(x)}finally{D.f()}}b.isCalledByItself&&(d+="".concat(b.name,' -- "[ContinueAsNew]" --\x3e ').concat(b.name,"\n"))}return d}(t.functions);if(!n)return void(e._inProgress=!1);e._diagramCode="graph LR\n".concat(n);var a=Object.keys(t.functions).filter((function(e){return!!t.functions[e].filePath})).map((function(e){return"click ".concat(e," null\n")})).join("");Dt.a.render("mermaidSvgId",e._diagramCode+a,(function(n){e._diagramSvg=e.applyIcons(n,t.iconsSvg),e._inProgress=!1}))}catch(r){e.errorMessage="Failed to render: ".concat(r.message),e._inProgress=!1}}),(function(t){e._inProgress=!1,e.errorMessage="Failed to traverse: ".concat(t.message,".").concat(t.response?t.response.data:""," ")})))}},{key:"applyIcons",value:function(e,t){return e=(e=e.replace("><style>",">\n<defs>\n".concat(t,"</defs>\n<style>"))).replace(/<g class="node (\w+).*?<g class="label" transform="translate\([0-9,.-]+\)"><g transform="translate\([0-9,.-]+\)">/g,'$&<use href="#az-icon-$1" width="20px" height="20px"/>')}}]),n}(zt),Sa=Object(te.a)(ja.prototype,"errorMessage",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(te.a)(ja.prototype,"diagramCode",[ne.e],Object.getOwnPropertyDescriptor(ja.prototype,"diagramCode"),ja.prototype),Object(te.a)(ja.prototype,"diagramSvg",[ne.e],Object.getOwnPropertyDescriptor(ja.prototype,"diagramSvg"),ja.prototype),Object(te.a)(ja.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(ja.prototype,"inProgress"),ja.prototype),wa=Object(te.a)(ja.prototype,"_inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ja),br=(Xa=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this))._backendClient=e,Object(ue.a)(a,"timeFrom",er,Object(He.a)(a)),Object(ue.a)(a,"timeTill",tr,Object(He.a)(a)),Object(ue.a)(a,"entityType",nr,Object(He.a)(a)),Object(ue.a)(a,"_statuses",ar,Object(He.a)(a)),Object(ue.a)(a,"_dialogOpen",rr,Object(He.a)(a)),Object(ue.a)(a,"_inProgress",ir,Object(He.a)(a)),Object(ue.a)(a,"_instancesDeleted",or,Object(He.a)(a)),a}return Object(y.a)(n,[{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){this._dialogOpen=e,e&&(this._instancesDeleted=null,this.timeFrom=de()().subtract(1,"days").utc(),this.timeTill=de()().utc(),this._statuses=new Set(["Completed","Terminated"]),this.entityType="Orchestration")}},{key:"instancesDeleted",get:function(){return this._instancesDeleted}},{key:"inProgress",get:function(){return this._inProgress}},{key:"isValid",get:function(){return this._statuses.size>0&&Ae.isValidMoment(this.timeFrom)&&Ae.isValidMoment(this.timeTill)}},{key:"purgeHistory",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("POST","/purge-history",{entityType:this.entityType,timeFrom:this.timeFrom.toISOString(),timeTill:this.timeTill.toISOString(),statuses:Array.from(this._statuses.values())}).then((function(t){e._instancesDeleted=t.instancesDeleted}),(function(t){e.errorMessage="Purge history failed: ".concat(t.message,".").concat(t.response?t.response.data:""," ")})).finally((function(){e._inProgress=!1}))}},{key:"getStatusIncluded",value:function(e){return this._statuses.has(e)}},{key:"setStatusIncluded",value:function(e,t){t?this._statuses.add(e):this._statuses.delete(e)}}]),n}(St),Object(te.a)(Xa.prototype,"dialogOpen",[ne.e],Object.getOwnPropertyDescriptor(Xa.prototype,"dialogOpen"),Xa.prototype),Object(te.a)(Xa.prototype,"instancesDeleted",[ne.e],Object.getOwnPropertyDescriptor(Xa.prototype,"instancesDeleted"),Xa.prototype),Object(te.a)(Xa.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(Xa.prototype,"inProgress"),Xa.prototype),Object(te.a)(Xa.prototype,"isValid",[ne.e],Object.getOwnPropertyDescriptor(Xa.prototype,"isValid"),Xa.prototype),er=Object(te.a)(Xa.prototype,"timeFrom",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tr=Object(te.a)(Xa.prototype,"timeTill",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Object(te.a)(Xa.prototype,"entityType",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Orchestration"}}),ar=Object(te.a)(Xa.prototype,"_statuses",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),rr=Object(te.a)(Xa.prototype,"_dialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ir=Object(te.a)(Xa.prototype,"_inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),or=Object(te.a)(Xa.prototype,"_instancesDeleted",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xa),yr=(sr=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var a;return Object(b.a)(this,n),(a=t.call(this))._backendClient=e,Object(ue.a)(a,"removeEmptyEntities",lr,Object(He.a)(a)),Object(ue.a)(a,"releaseOrphanedLocks",cr,Object(He.a)(a)),Object(ue.a)(a,"_dialogOpen",ur,Object(He.a)(a)),Object(ue.a)(a,"_inProgress",mr,Object(He.a)(a)),Object(ue.a)(a,"_response",dr,Object(He.a)(a)),a}return Object(y.a)(n,[{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){this._dialogOpen=e,e&&(this._response=null,this.removeEmptyEntities=!0,this.releaseOrphanedLocks=!0)}},{key:"response",get:function(){return this._response}},{key:"inProgress",get:function(){return this._inProgress}},{key:"isValid",get:function(){return!0}},{key:"clean",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("POST","/clean-entity-storage",{removeEmptyEntities:this.removeEmptyEntities,releaseOrphanedLocks:this.releaseOrphanedLocks}).then((function(t){e._response=t}),(function(t){e.errorMessage="Clean Entity Storage failed: ".concat(t.message,".").concat(t.response?t.response.data:""," ")})).finally((function(){e._inProgress=!1}))}}]),n}(St),Object(te.a)(sr.prototype,"dialogOpen",[ne.e],Object.getOwnPropertyDescriptor(sr.prototype,"dialogOpen"),sr.prototype),Object(te.a)(sr.prototype,"response",[ne.e],Object.getOwnPropertyDescriptor(sr.prototype,"response"),sr.prototype),Object(te.a)(sr.prototype,"inProgress",[ne.e],Object.getOwnPropertyDescriptor(sr.prototype,"inProgress"),sr.prototype),Object(te.a)(sr.prototype,"isValid",[ne.e],Object.getOwnPropertyDescriptor(sr.prototype,"isValid"),sr.prototype),lr=Object(te.a)(sr.prototype,"removeEmptyEntities",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cr=Object(te.a)(sr.prototype,"releaseOrphanedLocks",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ur=Object(te.a)(sr.prototype,"_dialogOpen",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),mr=Object(te.a)(sr.prototype,"_inProgress",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),dr=Object(te.a)(sr.prototype,"_response",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sr),vr=function(){function e(t){Object(b.a)(this,e),this._prefix=t}return Object(y.a)(e,[{key:"setItem",value:function(e,t){localStorage.setItem("".concat(this._prefix,"::").concat(e),t);var n=new Yt;n.values[e]=t,n.apply()}},{key:"setItems",value:function(e){var t,n=new Yt,a=Object(Le.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;null===r.value?(localStorage.removeItem("".concat(this._prefix,"::").concat(r.fieldName)),delete n.values[r.fieldName]):(localStorage.setItem("".concat(this._prefix,"::").concat(r.fieldName),r.value),n.values[r.fieldName]=r.value)}}catch(i){a.e(i)}finally{a.f()}n.apply()}},{key:"getItem",value:function(e){var t=new Yt;return t.values[e]?t.values[e]:localStorage.getItem("".concat(this._prefix,"::").concat(e))}},{key:"removeItem",value:function(e){localStorage.removeItem("".concat(this._prefix,"::").concat(e));var t=new Yt;delete t.values[e],t.apply()}}]),e}(),Or=function(){function e(t){var n=this;Object(b.a)(this,e),this._vsCodeApi=t,this._handlers={},this._requests={},window.addEventListener("message",(function(e){var t=e.data,a=n._handlers[t.id];if(a)try{a(t.data)}catch(i){console.log("Failed to handle response from VsCode: "+i)}else{var r=n._requests[t.id];r&&(t.err?r.reject(t.err):r.resolve(t.data),delete n._requests[t.id])}}))}return Object(y.a)(e,[{key:"isVsCode",get:function(){return!0}},{key:"routePrefixAndTaskHubName",get:function(){return null}},{key:"call",value:function(e,t,n){var a=this,r=Math.random().toString();return this._vsCodeApi.postMessage({id:r,method:e,url:t,data:n}),new Promise((function(e,t){a._requests[r]={resolve:e,reject:t}}))}},{key:"setCustomHandlers",value:function(e,t){this._handlers.purgeHistory=e,this._handlers.cleanEntityStorage=t,this._vsCodeApi.postMessage({method:"IAmReady"})}}]),e}(),Er=function(){function e(t,n){Object(b.a)(this,e),this._prefix=t,this._vsCodeApi=n,this._state=void 0,this._state=StateFromVsCode[this._prefix],this._state||(this._state={})}return Object(y.a)(e,[{key:"setItem",value:function(e,t){this._state[e]=t,this.save()}},{key:"setItems",value:function(e){var t,n=Object(Le.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;null===a.value?delete this._state[a.fieldName]:this._state[a.fieldName]=a.value}}catch(r){n.e(r)}finally{n.f()}this.save()}},{key:"getItem",value:function(e){return this._state[e]}},{key:"removeItem",value:function(e){delete this._state[e],this.save()}},{key:"save",value:function(){this._vsCodeApi.postMessage({method:"PersistState",key:this._prefix,data:this._state})}}]),e}(),_r=(hr=function(){function e(){var t=this;Object(b.a)(this,e),this.loginState=void 0,this.mainMenuState=void 0,this.orchestrationsState=void 0,this.orchestrationDetailsState=void 0,this.functionGraphState=void 0,this.purgeHistoryDialogState=void 0,this.cleanEntityStorageDialogState=void 0,Object(ue.a)(this,"_suggestions",pr,this),Object(ue.a)(this,"_typedInstanceId",gr,this),this._backendClient=void 0;var n=void 0;try{n=acquireVsCodeApi()}catch(i){}if(n){var a=new Or(n);this._backendClient=a,this.purgeHistoryDialogState=new br(a),this.cleanEntityStorageDialogState=new yr(a),this.instanceId?this.orchestrationDetailsState=new Ja(this.instanceId,this.functionProjectPath,a,new Er("OrchestrationDetailsState",n)):this.functionProjectPath?this.functionGraphState=new fr(this.functionProjectPath,a):(this.orchestrationsState=new Gt(a,new Er("OrchestrationsState",n)),a.setCustomHandlers((function(){return t.purgeHistoryDialogState.dialogOpen=!0}),(function(){return t.cleanEntityStorageDialogState.dialogOpen=!0})))}else{this.loginState=new Rt;var r=new Ht((function(){return t.loginState.taskHubName}),(function(){return t.loginState.getAuthorizationHeaderAsync()}));this._backendClient=r,this.purgeHistoryDialogState=new br(r),this.cleanEntityStorageDialogState=new yr(r),this.instanceId?this.orchestrationDetailsState=new Ja(this.instanceId,null,r,new vr("OrchestrationDetailsState")):(this.mainMenuState=new Ya(r,this.purgeHistoryDialogState,this.cleanEntityStorageDialogState),this.orchestrationsState=new Gt(r,new vr("OrchestrationsState")))}}return Object(y.a)(e,[{key:"typedInstanceId",get:function(){return this._typedInstanceId},set:function(e){this._typedInstanceId=e,this.reloadSuggestions()}},{key:"suggestions",get:function(){return this._suggestions}},{key:"isExactMatch",get:function(){return 1===this._suggestions.length&&this._suggestions[0]===this._typedInstanceId}},{key:"goto",value:function(){window.open("".concat(this._backendClient.routePrefixAndTaskHubName).concat(At).concat(this._typedInstanceId)),this._typedInstanceId="",this._suggestions=[]}},{key:"functionProjectPath",get:function(){return DfmFunctionProjectPath||""}},{key:"instanceId",get:function(){if(OrchestrationIdFromVsCode)return OrchestrationIdFromVsCode;var e=window.location.pathname.lastIndexOf(At);return e<0?"":window.location.pathname.substr(e+At.length)}},{key:"reloadSuggestions",value:function(){var e=this;if(!this._typedInstanceId||this._typedInstanceId.length<2)this._suggestions=[];else{var t="/id-suggestions(prefix='".concat(this._typedInstanceId,"')");this._backendClient.call("GET",t).then((function(t){t&&e._typedInstanceId?e._suggestions=t:e._suggestions=[]}))}}}]),e}(),Object(te.a)(hr.prototype,"typedInstanceId",[ne.e],Object.getOwnPropertyDescriptor(hr.prototype,"typedInstanceId"),hr.prototype),Object(te.a)(hr.prototype,"suggestions",[ne.e],Object.getOwnPropertyDescriptor(hr.prototype,"suggestions"),hr.prototype),Object(te.a)(hr.prototype,"isExactMatch",[ne.e],Object.getOwnPropertyDescriptor(hr.prototype,"isExactMatch"),hr.prototype),pr=Object(te.a)(hr.prototype,"_suggestions",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),gr=Object(te.a)(hr.prototype,"_typedInstanceId",[ne.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),hr);document.body.style.backgroundColor=rn.palette.background.paper;var kr=new _r;g.render(p.createElement(f.a,{theme:rn},p.createElement(Wa,{state:kr})),document.getElementById("root"))}},[[693,1,2]]]);
//# sourceMappingURL=main.b0cb72fd.chunk.js.map