(this["webpackJsonpdurablefunctionsmonitor.react"]=this["webpackJsonpdurablefunctionsmonitor.react"]||[]).push([[0],{377:function(e,t,n){},422:function(e,t,n){},424:function(e,t,n){},425:function(e,t,n){},429:function(e,t,n){},431:function(e,t,n){},432:function(e,t,n){},650:function(e,t,n){var a={"./locale":361,"./locale.js":361};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id=650},692:function(e,t,n){},693:function(e,t,n){},694:function(e,t,n){},695:function(e,t,n){},696:function(e,t,n){},697:function(e,t,n){"use strict";n.r(t);var a,r,i,o,s=n(0),l=n(25),c=n(775),u=(n(422),n(423),n(9)),m=n(10),d=n(16),h=n(15),p=n(20),g=n(779),f=n(769),b=n(768),y=n(111),v=n(757),O=n(785),E=n(772),_=n(43),k=n(781),C=n(381),j=(n(424),n(744)),w=n(748),S=n(392),N=n(751),T=n(784),I=n(752),P=n(753),D=n(754),F=n(755),x=n(756),M=n(750),L=n(700),R=n(747),H=n(758),A=(n(425),n(391)),z=n(11),B=(n(38),n(5)),W=n(4),V=n(24),Y=n.n(V),G=(a=function(){function e(){var t;(Object(u.a)(this,e),Object(z.a)(this,"_showTimeAsLocal",r,this),Object(z.a)(this,"_timeZoneName",i,this),"Local"!==DfmClientConfig.showTimeAs)?this._showTimeAsLocal="Local"===(null===(t=localStorage)||void 0===t?void 0:t.getItem("showTimeAs")):this._showTimeAsLocal=!0;this.setTimeZoneName()}return Object(m.a)(e,[{key:"theme",get:function(){return DfmClientConfig.theme}},{key:"timeZoneName",get:function(){return this._timeZoneName}},{key:"showTimeAsLocal",get:function(){return this._showTimeAsLocal},set:function(e){var t;null===(t=localStorage)||void 0===t||t.setItem("showTimeAs",e?"Local":"UTC"),this._showTimeAsLocal=e,this.setTimeZoneName()}},{key:"getMoment",value:function(e){return e&&e.isValid()?(this._showTimeAsLocal?e.local():e.utc(),e):e}},{key:"setMoment",value:function(e){return e&&e.isValid()&&!this._showTimeAsLocal?Y()(e.toISOString(!0).slice(0,19)+"Z"):e}},{key:"formatDateTimeString",value:function(e){if(!this._showTimeAsLocal||!e||e.length<11)return e;var t=e.lastIndexOf("."),n=t>=0?"."+e.substring(t+1,e.length-1):"";return Y()(e).format("YYYY-MM-DDTHH:mm:ss")+n}},{key:"setTimeZoneName",value:function(){var e="UTC";if(this.showTimeAsLocal){var t=(new Date).getTimezoneOffset()/60;e+=(t<0?"+":"-")+(Math.floor(t)===t?Math.abs(t).toFixed(0):Math.abs(t).toFixed(1))}this._timeZoneName=e}}]),e}(),Object(B.a)(a.prototype,"timeZoneName",[W.e],Object.getOwnPropertyDescriptor(a.prototype,"timeZoneName"),a.prototype),Object(B.a)(a.prototype,"showTimeAsLocal",[W.e],Object.getOwnPropertyDescriptor(a.prototype,"showTimeAsLocal"),a.prototype),r=Object(B.a)(a.prototype,"_showTimeAsLocal",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=Object(B.a)(a.prototype,"_timeZoneName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a),U=s.createContext(new G),J=new G,q=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_BASE_URI:"",REACT_APP_BACKEND_PATH:"a/p/i"}).REACT_APP_COLOR_THEME:J.theme,Z=Object(A.a)({palette:{type:"dark"===q?"dark":"light"}}),K="dark"===Z.palette.type?{backgroundColor:"#aaa"}:{},$="dark"===Z.palette.type?"default":"primary";function X(e){var t=null;switch(e){case"Failed":t=Q(Z.palette.error.light,.2);break;case"Completed":t=Q(Z.palette.success.light,.2);break;case"Running":t=Q(Z.palette.warning.light,.2);break;case"Terminated":t=Q(Z.palette.background.paper,.1)}return t?{backgroundColor:t}:{}}function Q(e,t){return e.length>4?"rgba(".concat(parseInt(e.slice(1,3),16),", ").concat(parseInt(e.slice(3,5),16),", ").concat(parseInt(e.slice(5,7),16),", ").concat(t.toFixed(1),")"):"rgba(".concat(parseInt(e.slice(1,2),16),", ").concat(parseInt(e.slice(2,3),16),", ").concat(parseInt(e.slice(3,4),16),", ").concat(t.toFixed(1),")")}function ee(e){var t=null;if("dark"===Z.palette.type)switch(e){case"Failed":t="rgb(103,73,76)";break;case"Completed":t="rgb(74,98,80)";break;case"Running":t="rgb(105,93,68)";break;case"Terminated":t="rgb(66,66,66)";break;case"Duration":t="rgb(50,50,50)"}else switch(e){case"Failed":t="rgb(250,227,227)";break;case"Completed":t="rgb(230,244,230)";break;case"Running":t="rgb(255,241,219)";break;case"Terminated":t="rgb(231,231,231)";break;case"Duration":t="rgb(255,255,255)"}return t?{backgroundColor:t}:{}}var te,ne,ae,re,ie,oe,se,le,ce=Object(p.a)(o=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement("div",null,s.createElement(j.a,{color:e.isLoggedInAnonymously?"secondary":"inherit",onClick:function(t){return e.menuAnchorElement=t.currentTarget}},s.createElement(R.a,null),s.createElement(g.a,{width:5}),s.createElement(w.a,{title:e.isLoggedInAnonymously?"Ensure this endpoint is not exposed to the public!":""},s.createElement(y.a,{color:e.isLoggedInAnonymously?"secondary":"inherit"},e.isLoggedInAnonymously?"Anonymous":e.userName))),!e.isLoggedInAnonymously&&s.createElement(S.a,{anchorEl:e.menuAnchorElement,keepMounted:!0,open:!!e.menuAnchorElement,onClose:function(){return e.menuAnchorElement=void 0}},s.createElement(N.a,{onClick:function(){return e.logout()}},"Login under a different name")),s.createElement(T.a,{open:!e.isLoggedIn},s.createElement(I.a,null,e.errorMessage?s.createElement(s.Fragment,null,s.createElement(P.a,{className:"login-progress"},s.createElement(H.a,{color:"secondary",fontSize:"large"})),s.createElement(F.a,{color:"secondary"},"Login failed. ",e.errorMessage)):e.allowedTaskHubNames?s.createElement(s.Fragment,null,s.createElement(x.a,null,"Select your Task Hub"),s.createElement(M.a,{className:"task-hub-list"},e.allowedTaskHubNames.map((function(t){return s.createElement(L.a,{button:!0,key:t},s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",href:e.locationPathName+t},t))})))):s.createElement(s.Fragment,null,s.createElement(P.a,{className:"login-progress"},s.createElement(D.a,null)),s.createElement(F.a,null,"Login in progress...")))))}}]),n}(s.Component))||o,ue=n(701),me=n(759),de=n(760),he=n(782),pe=(n(429),n(386)),ge=n.n(pe),fe=Object(p.a)((ae=ne=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.props.state.setWindowTitle()}},{key:"render",value:function(){var e=this,t=this.props.state;return s.createElement(s.Fragment,null,s.createElement(ue.a,{color:"inherit",onClick:function(e){return t.menuAnchorElement=e.currentTarget}},s.createElement(ge.a,null)),s.createElement(S.a,{anchorEl:t.menuAnchorElement,keepMounted:!0,open:!!t.menuAnchorElement,onClose:function(){return t.menuAnchorElement=void 0}},s.createElement(me.a,{row:!0,value:this.context.showTimeAsLocal.toString(),onChange:function(n){e.context.showTimeAsLocal="true"===n.target.value,t.menuAnchorElement=void 0,e.props.doRefresh()}},s.createElement(y.a,{className:"show-time-as-typography"},"Show time as:"),s.createElement(de.a,{control:s.createElement(he.a,{color:"primary"}),label:"UTC",value:"false"}),s.createElement(de.a,{control:s.createElement(he.a,{color:"primary"}),label:"Local",value:"true"})),s.createElement(N.a,{onClick:function(){return t.showConnectionParamsDialog()}},"Manage Storage Connection Settings..."),s.createElement(N.a,{onClick:function(){return t.showPurgeHistoryDialog()}},"Purge Instance History..."),s.createElement(N.a,{onClick:function(){return t.showCleanEntityStorageDialog()}},"Clean Entity Storage..."),s.createElement(N.a,{onClick:function(){return t.showStartNewInstanceDialog()}},"Start New Orchestration Instance...")))}}]),n}(s.Component),ne.contextType=U,te=ae))||te,be=n(770),ye=n(771),ve=n(706),Oe=n(783),Ee=n(707),_e=n(709),ke=n(702),Ce=n(774),je=n(780),we=n(773),Se=n(777),Ne=n(145),Te=n.n(Ne),Ie=n(222),Pe=n.n(Ie),De=n(389),Fe=n.n(De),xe=(n(431),["Timestamp","EventType","EventId","Name","ScheduledTime","Result","Details"]),Me=["Completed","Running","Failed","Pending","Terminated","Canceled","ContinuedAsNew"],Le=function(){function e(){Object(u.a)(this,e),this.instanceId=void 0,this.name=void 0,this.entityId=void 0,this.runtimeStatus=void 0,this.entityType=void 0,this.lastEvent=void 0,this.input=void 0,this.customStatus=void 0,this.output=void 0,this.createdTime=void 0,this.lastUpdatedTime=void 0,this.duration=void 0,this.tabTemplateNames=void 0}return Object(m.a)(e,null,[{key:"getFunctionName",value:function(e){return"DurableEntity"===e.entityType?e.entityId.name:e.name}}]),e}(),Re=["instanceId","name","createdTime","lastUpdatedTime","duration","runtimeStatus","lastEvent","input","output","customStatus"],He=n(786),Ae=n(761),ze=n(217),Be=n.n(ze),We=n(387),Ve=n.n(We),Ye=(n(432),re=W.d.bound,Object(p.a)((oe=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(He.a,{className:"message-snackbar",anchorOrigin:{vertical:"top",horizontal:"right"},open:!!e.errorMessage,autoHideDuration:6e3,onClose:this.handleClose},s.createElement(Ae.a,{className:"error-snackbar-content",message:s.createElement("span",null,s.createElement(Ve.a,{className:"error-icon"}),e.errorMessage),action:[s.createElement(ue.a,{key:"close","aria-label":"Close",color:"inherit",onClick:this.handleClose},s.createElement(Be.a,null))]}))}},{key:"handleClose",value:function(){this.props.state.errorMessage=""}}]),n}(s.Component),Object(B.a)(oe.prototype,"handleClose",[re],Object.getOwnPropertyDescriptor(oe.prototype,"handleClose"),oe.prototype),ie=oe))||ie),Ge=n(34),Ue=n(13),Je=function(){function e(){Object(u.a)(this,e)}return Object(m.a)(e,null,[{key:"isValidMoment",value:function(t){return!!t&&t.isValid()&&t.isAfter(e.MinMoment)&&t.isBefore(e.MaxMoment)}},{key:"formatDuration",value:function(e){if(isNaN(e)||e<0)return"";var t=Math.floor(e/864e5),n=0,a="";t>0&&(a+=t.toFixed(0)+"d",++n,e%=864e5);var r=Math.floor(e/36e5);if(r>0){if(a+=r.toFixed(0)+"h",++n>1)return a;e%=36e5}var i=Math.floor(e/6e4);if(i>0){if(a+=i.toFixed(0)+"m",++n>1)return a;e%=6e4}var o=Math.floor(e/1e3);if(o>0){if(a+=o.toFixed(0)+"s",++n>1)return a;e%=1e3}return e>0&&(a+=e.toFixed(0)+"ms"),a||(a="0ms"),a}}]),e}();Je.MinMoment=Y()("1900-01-01"),Je.MaxMoment=Y()("2100-01-01");var qe,Ze,Ke,$e,Xe,Qe,et,tt,nt,at,rt,it,ot,st,lt,ct,ut,mt,dt,ht,pt,gt,ft,bt,yt,vt=(se=function(){function e(){Object(u.a)(this,e),Object(z.a)(this,"errorMessage",le,this)}return Object(m.a)(e,[{key:"showError",value:function(e,t){this.errorMessage="string"===typeof t?"".concat(e,". ").concat(t):"".concat(e,". ").concat(t.response&&t.response.data?t.response.data:t.message)}}]),e}(),le=Object(B.a)(se.prototype,"errorMessage",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),se),Ot=(qe=function e(){Object(u.a)(this,e),Object(z.a)(this,"inProgress",Ze,this),Object(z.a)(this,"isCancelled",Ke,this)},Ze=Object(B.a)(qe.prototype,"inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ke=Object(B.a)(qe.prototype,"isCancelled",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qe),Et=n(223),_t=(rt=function(){function e(t,n,a){Object(u.a)(this,e),this._backendClient=t,this._localStorage=n,this._refresh=a,Object(z.a)(this,"longJsonDialogState",Xe,this),Object(z.a)(this,"columnUnderMouse",Qe,this),Object(z.a)(this,"_orchestrations",et,this),Object(z.a)(this,"_orderByDirection",tt,this),Object(z.a)(this,"_orderBy",nt,this),Object(z.a)(this,"_hiddenColumns",at,this),this._noMorePagesToLoad=!1,this._pageSize=50;var r=this._localStorage.getItem("orderBy");r&&(this._orderBy=r);var i=this._localStorage.getItem("orderByDirection");i&&(this._orderByDirection=i);var o=this._localStorage.getItem("hiddenColumns");o&&(this._hiddenColumns=o.split("|"))}return Object(m.a)(e,[{key:"hiddenColumns",get:function(){return this._hiddenColumns}},{key:"orchestrations",get:function(){return this._orchestrations}},{key:"orderByDirection",get:function(){return this._orderByDirection}},{key:"orderBy",get:function(){return this._orderBy},set:function(e){this._orderBy!==e?(this._orderBy=e,this._orderByDirection="asc"):"desc"===this._orderByDirection?(this._orderBy="",this._orderByDirection="asc"):this._orderByDirection="desc",this._refresh()}},{key:"backendClient",get:function(){return this._backendClient}},{key:"hideColumn",value:function(e){this._hiddenColumns.push(e),this._localStorage.setItem("hiddenColumns",this._hiddenColumns.join("|"))}},{key:"unhide",value:function(){this._hiddenColumns=[],this._localStorage.removeItem("hiddenColumns"),this._refresh()}},{key:"resetOrderBy",value:function(){this._orderBy="",this._orderByDirection="asc",this._refresh()}},{key:"reset",value:function(){this._orchestrations=[],this._noMorePagesToLoad=!1}},{key:"load",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a)this._noMorePagesToLoad=!1;else{if(this._noMorePagesToLoad)return Promise.resolve();this._localStorage.setItems([{fieldName:"orderBy",value:this._orderBy},{fieldName:"orderByDirection",value:this._orderByDirection}])}var r=a?0:this._orchestrations.length,i=this._orderBy?"&$orderby=".concat(this._orderBy," ").concat(this.orderByDirection):"",o=this._hiddenColumns.length?"&hidden-columns=".concat(this._hiddenColumns.join("|")):"",s="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(r).concat(e).concat(i).concat(o);return this._backendClient.call("GET",s).then((function(e){if(!t.isCancelled){var r;if(a)n._orchestrations=e;else(r=n._orchestrations).push.apply(r,Object(Et.a)(e));e.length||(n._noMorePagesToLoad=!0)}}))}}]),e}(),$e=rt,Xe=Object(B.a)($e.prototype,"longJsonDialogState",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Qe=Object(B.a)($e.prototype,"columnUnderMouse",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)($e.prototype,"hiddenColumns",[W.e],Object.getOwnPropertyDescriptor($e.prototype,"hiddenColumns"),$e.prototype),Object(B.a)($e.prototype,"orchestrations",[W.e],Object.getOwnPropertyDescriptor($e.prototype,"orchestrations"),$e.prototype),Object(B.a)($e.prototype,"orderByDirection",[W.e],Object.getOwnPropertyDescriptor($e.prototype,"orderByDirection"),$e.prototype),Object(B.a)($e.prototype,"orderBy",[W.e],Object.getOwnPropertyDescriptor($e.prototype,"orderBy"),$e.prototype),et=Object(B.a)($e.prototype,"_orchestrations",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),tt=Object(B.a)($e.prototype,"_orderByDirection",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"asc"}}),nt=Object(B.a)($e.prototype,"_orderBy",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),at=Object(B.a)($e.prototype,"_hiddenColumns",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$e),kt=n(53),Ct=n.n(kt),jt=(ct=lt=function(){function e(){Object(u.a)(this,e),Object(z.a)(this,"_diagramCode",ot,this),Object(z.a)(this,"_diagramSvg",st,this)}return Object(m.a)(e,[{key:"initMermaidWhenNeeded",value:function(){e._mermaidInitialized||(Ct.a.initialize({startOnLoad:!0,sequence:{noteMargin:0,boxMargin:5,boxTextMargin:5},flowchart:{curve:"Basis",useMaxWidth:!0,htmlLabels:!1}}),e._mermaidInitialized=!0)}},{key:"escapeTitle",value:function(e){return e.replace(/[@:;]/g," ")}},{key:"formatDuration",value:function(e){var t=Je.formatDuration(e);return t?"(".concat(t,")"):""}},{key:"formatDurationInSeconds",value:function(e){return Math.ceil(e/1e3).toFixed(0)+"s"}}]),e}(),lt._mermaidInitialized=!1,it=ct,ot=Object(B.a)(it.prototype,"_diagramCode",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st=Object(B.a)(it.prototype,"_diagramSvg",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it),wt=(ut=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,a._instances=[],a}return Object(m.a)(n,[{key:"rawHtml",get:function(){return this._diagramSvg}},{key:"diagramCode",get:function(){return this._diagramCode}},{key:"reset",value:function(){this._diagramCode="",this._diagramSvg="",this._instances=[]}},{key:"load",value:function(e,t,n){var a=this;return this.initMermaidWhenNeeded(),new Promise((function(n,r){var i="/orchestrations?$top=500&$orderby=createdTime asc".concat(e);a._backendClient.call("GET",i).then((function(e){if(a._instances=e,t.isCancelled)n();else{a._diagramCode="gantt \n"+"title Gantt Chart (".concat(e.length," instances shown) \n")+"dateFormat YYYY-MM-DDTHH:mm:ss \n"+a.renderDiagram(e),a._diagramSvg="";try{Ct.a.render("mermaidSvgId",a._diagramCode,(function(e){a._diagramSvg=e,n()}))}catch(i){r(i)}}}),r)}))}},{key:"goto",value:function(e){e&&e<=this._instances.length&&this._backendClient.showDetails(this._instances[e-1].instanceId)}},{key:"renderDiagram",value:function(e){var t,n="",a="",r=0,i=Object(Ge.a)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value,s="",l=Le.getFunctionName(o);l!==a&&(s="section ".concat(++r,". ").concat(this.escapeTitle(l)," \n"),a=l);var c="DurableEntity"===o.entityType?o.entityId.key:o.instanceId,u=new Date(o.lastUpdatedTime).getTime()-new Date(o.createdTime).getTime();n+=s+="".concat(this.escapeTitle(c)," ").concat(this.formatDuration(u),": active, ").concat(this.formatDateTime(o.createdTime),", ").concat(this.formatDurationInSeconds(u)," \n")}}catch(m){i.e(m)}finally{i.f()}return n}},{key:"formatDateTime",value:function(e){return J.showTimeAsLocal?Y()(e).format("YYYY-MM-DDTHH:mm:ss"):e.substr(0,19)}}]),n}(jt),Object(B.a)(ut.prototype,"rawHtml",[W.e],Object.getOwnPropertyDescriptor(ut.prototype,"rawHtml"),ut.prototype),Object(B.a)(ut.prototype,"diagramCode",[W.e],Object.getOwnPropertyDescriptor(ut.prototype,"diagramCode"),ut.prototype),ut),St=(mt=function(){function e(t,n){Object(u.a)(this,e),this._backendClient=t,this._filterState=n,Object(z.a)(this,"_histograms",dt,this),this._counts={},Object(z.a)(this,"_numOfInstancesShown",ht,this),Object(z.a)(this,"_zoomedIn",pt,this),this._originalTimeInterval=null,this._applyingZoom=!1,this._timeRangeInMilliseconds=0,this._numOfIntervals=200,this._pageSize=1e3}return Object(m.a)(e,[{key:"zoomedIn",get:function(){return this._zoomedIn}},{key:"histograms",get:function(){return this._histograms}},{key:"numOfInstancesShown",get:function(){return this._numOfInstancesShown}},{key:"counts",get:function(){return this._counts}},{key:"timeRangeInMilliseconds",get:function(){return this._timeRangeInMilliseconds}},{key:"reset",value:function(){}},{key:"load",value:function(e,t,n){this._applyingZoom||this._zoomedIn||(this._originalTimeInterval={timeFrom:this._filterState.timeFrom,timeTill:this._filterState.timeTill,timeRange:this._filterState.timeRange}),this._numOfInstancesShown=0,this._histograms={},this._counts={};var a=this._filterState.timeFrom.valueOf(),r=Math.ceil((this._filterState.timeTill.valueOf()-a)/this._numOfIntervals);return r<=0&&(r=1),this._timeRangeInMilliseconds=this._filterState.timeTill.valueOf()-this._filterState.timeFrom.valueOf(),this.loadNextBatch(e,a,r,0,t)}},{key:"applyZoom",value:function(e,t){this._numOfInstancesShown=0,this._filterState.cancel();var n=1e3*Math.floor(e.getTime()/1e3),a=1e3*Math.ceil(t.getTime()/1e3);this._filterState.timeFrom=Y()(n),this._filterState.timeTill=Y()(a),this._applyingZoom=!0;try{this._filterState.reloadOrchestrations()}finally{this._applyingZoom=!1}this._zoomedIn=!0}},{key:"resetZoom",value:function(){this._zoomedIn&&this._originalTimeInterval&&(this._zoomedIn=!1,this._filterState.cancel(),this._filterState.timeFrom=this._originalTimeInterval.timeFrom,this._filterState.timeTill=this._originalTimeInterval.timeTill,this._filterState.timeRange=this._originalTimeInterval.timeRange)}},{key:"loadNextBatch",value:function(e,t,n,a,r){var i=this,o="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(this._numOfInstancesShown).concat(e);return this._backendClient.call("GET",o).then((function(o){if(r.isCancelled)return Promise.resolve();var s,l=Object(Ge.a)(o);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=Le.getFunctionName(c);if(!i._histograms[u]){for(var m=[],d=0;d<i._numOfIntervals;d++)m[d]={x0:t+d*n,x:t+(d+1)*n,y:0};i._histograms[u]=m}var h=Math.floor((new Date(c.createdTime).getTime()-t)/n);h<0||h>=i._numOfIntervals||(i._histograms[u][h].y+=1,i._counts[u]?i._counts[u]+=1:i._counts[u]=1)}}catch(p){l.e(p)}finally{l.f()}return i._numOfInstancesShown+=o.length,o.length===i._pageSize?i.loadNextBatch(e,t,n,a+1,r):void 0}))}}]),e}(),Object(B.a)(mt.prototype,"zoomedIn",[W.e],Object.getOwnPropertyDescriptor(mt.prototype,"zoomedIn"),mt.prototype),Object(B.a)(mt.prototype,"histograms",[W.e],Object.getOwnPropertyDescriptor(mt.prototype,"histograms"),mt.prototype),Object(B.a)(mt.prototype,"numOfInstancesShown",[W.e],Object.getOwnPropertyDescriptor(mt.prototype,"numOfInstancesShown"),mt.prototype),dt=Object(B.a)(mt.prototype,"_histograms",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ht=Object(B.a)(mt.prototype,"_numOfInstancesShown",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=Object(B.a)(mt.prototype,"_zoomedIn",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),mt),Nt=(gt=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,Object(z.a)(a,"_renderFunctions",ft,Object(Ue.a)(a)),Object(z.a)(a,"_renderProxies",bt,Object(Ue.a)(a)),Object(z.a)(a,"_traversalResult",yt,Object(Ue.a)(a)),a}return Object(m.a)(n,[{key:"diagramCode",get:function(){return this._diagramCode}},{key:"diagramSvg",get:function(){return this._diagramSvg}},{key:"functionsLoaded",get:function(){return!!this._traversalResult}},{key:"backendClient",get:function(){return this._backendClient}},{key:"gotoFunctionCode",value:function(e){if(this.backendClient.isVsCode)this.backendClient.call("GotoFunctionCode",e).then((function(){}),(function(e){console.log("Failed to goto function code: ".concat(e.message))}));else{var t=null;(t=e.startsWith("proxy.")?this._traversalResult.proxies[e.substr(6)]:this._traversalResult.functions[e])&&t.filePath&&window.open(t.filePath)}}},{key:"saveAsJson",value:function(){this.backendClient.call("SaveFunctionGraphAsJson","").then((function(){}),(function(e){console.log("Failed to goto function code: ".concat(e.message))}))}},{key:"applyIcons",value:function(e){var t=document.getElementById("all-azure-icons-svg");return t?e=(e=e.replace("><style>",">\n<defs>\n".concat(t.innerHTML,"</defs>\n<style>"))).replace(/<g class="node (\w+).*?<g class="label" transform="translate\([0-9,.-]+\)"><g transform="translate\([0-9,.-]+\)">/g,'$&<use href="#az-icon-$1" width="20px" height="20px"/>'):e}}]),n}(jt),Object(B.a)(gt.prototype,"diagramCode",[W.e],Object.getOwnPropertyDescriptor(gt.prototype,"diagramCode"),gt.prototype),Object(B.a)(gt.prototype,"diagramSvg",[W.e],Object.getOwnPropertyDescriptor(gt.prototype,"diagramSvg"),gt.prototype),Object(B.a)(gt.prototype,"functionsLoaded",[W.e],Object.getOwnPropertyDescriptor(gt.prototype,"functionsLoaded"),gt.prototype),ft=Object(B.a)(gt.prototype,"_renderFunctions",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),bt=Object(B.a)(gt.prototype,"_renderProxies",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),yt=Object(B.a)(gt.prototype,"_traversalResult",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt),Tt=n(393),It="#32;";function Pt(e){var t,n,a,r,i,o,s;switch(e.type){case"httpTrigger":return"".concat("anonymous"===e.authLevel?"#127760;":"#128274;"," http").concat(e.methods?":["+e.methods.join(",")+"]":"").concat(e.route?":"+e.route:"");case"blobTrigger":return"".concat(It,"blob:").concat(null!==(t=e.path)&&void 0!==t?t:"");case"cosmosDBTrigger":return"".concat(It,"cosmosDB:").concat(null!==(n=e.databaseName)&&void 0!==n?n:"",":").concat(null!==(a=e.collectionName)&&void 0!==a?a:"");case"eventHubTrigger":return"".concat(It,"eventHub:").concat(null!==(r=e.eventHubName)&&void 0!==r?r:"");case"serviceBusTrigger":return"".concat(It,"serviceBus:").concat(e.queueName?e.queueName:null!==(i=e.topicName)&&void 0!==i?i:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queueTrigger":return"".concat(It,"queue:").concat(null!==(o=e.queueName)&&void 0!==o?o:"");case"timerTrigger":return"".concat(It,"timer:").concat(null!==(s=e.schedule)&&void 0!==s?s:"");default:return"".concat(It).concat(e.type)}}function Dt(e){var t,n,a,r,i,o,s;switch(e.type){case"table":return"".concat(It,"table:").concat(null!==(t=e.tableName)&&void 0!==t?t:"");case"blob":return"".concat(It,"blob:").concat(null!==(n=e.path)&&void 0!==n?n:"");case"cosmosDB":return"".concat(It,"cosmosDB:").concat(null!==(a=e.databaseName)&&void 0!==a?a:"",":").concat(null!==(r=e.collectionName)&&void 0!==r?r:"");case"eventHub":return"".concat(It,"eventHub:").concat(null!==(i=e.eventHubName)&&void 0!==i?i:"");case"serviceBus":return"".concat(It,"serviceBus:").concat(e.queueName?e.queueName:null!==(o=e.topicName)&&void 0!==o?o:"").concat(e.subscriptionName?":"+e.subscriptionName:"");case"queue":return"".concat(It,"queue:").concat(null!==(s=e.queueName)&&void 0!==s?s:"");default:return"".concat(It).concat(e.type)}}function Ft(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";if(!n.doNotRenderFunctions){var r=[];for(var i in e){var o,s=e[i],l=void 0,c=[],u=[],m=[],d="".concat(i,'{{"').concat(It).concat(i,'"}}:::function'),h=Object(Ge.a)(s.bindings);try{for(h.s();!(o=h.n()).done;){var p=o.value;"orchestrationTrigger"===p.type?d="".concat(i,'[["').concat(It).concat(i,'"]]:::orchestrator'):"activityTrigger"===p.type?d="".concat(i,'[/"').concat(It).concat(i,'"/]:::activity'):"entityTrigger"===p.type&&(d="".concat(i,'[("').concat(It).concat(i,'")]:::entity')),p.type.endsWith("Trigger")?l=p:"in"===p.direction?c.push(p):"out"===p.direction?u.push(p):m.push(p)}}catch(B){h.e(B)}finally{h.f()}r.push(Object(Tt.a)({name:i,nodeCode:d,triggerBinding:l,inputBindings:c,outputBindings:u,otherBindings:m},s))}var g=function(e){var t,n=!(null===(t=e.isCalledBy)||void 0===t?void 0:t.length)&&e.triggerBinding&&e.triggerBinding.type?e.triggerBinding.type:"";return n+="~"+e.name};r.sort((function(e,t){var n=g(e),a=g(t);return n>a?1:a>n?-1:0}));for(var f=0,b=r;f<b.length;f++){var y,v,O=b[f];if(a+="".concat(O.nodeCode,"\n"),a+="style ".concat(O.name," fill:#D9D9FF,stroke-width:2px\n"),null===(y=O.isCalledBy)||void 0===y?void 0:y.length){var E,_=Object(Ge.a)(O.isCalledBy);try{for(_.s();!(E=_.n()).done;){var k=E.value;a+="".concat(k," ---\x3e ").concat(O.name,"\n")}}catch(B){_.e(B)}finally{_.f()}}else O.triggerBinding&&(a+="".concat(O.name,".").concat(O.triggerBinding.type,'>"').concat(Pt(O.triggerBinding),'"]:::').concat(O.triggerBinding.type," --\x3e ").concat(O.name,"\n"));for(var C=0;C<O.inputBindings.length;C++){var j=O.inputBindings[C];a+="".concat(O.name,".").concat(C,".").concat(j.type,'(["').concat(Dt(j),'"]):::').concat(j.type," -.-> ").concat(O.name,"\n")}for(C=0;C<O.outputBindings.length;C++){var w=O.outputBindings[C];a+="".concat(O.name," -.-> ").concat(O.name,".").concat(C,".").concat(w.type,'(["').concat(Dt(w),'"]):::').concat(w.type,"\n")}for(C=0;C<O.otherBindings.length;C++){var S=O.otherBindings[C];a+="".concat(O.name," -.- ").concat(O.name,".").concat(C,".").concat(S.type,'(["').concat(Dt(S),'"]):::').concat(S.type,"\n")}if(null===(v=O.isSignalledBy)||void 0===v?void 0:v.length){var N,T=Object(Ge.a)(O.isSignalledBy);try{for(T.s();!(N=T.n()).done;){var I=N.value;a+="".concat(I.name,' -- "#9889; ').concat(I.signalName,'" ---\x3e ').concat(O.name,"\n")}}catch(B){T.e(B)}finally{T.f()}}O.isCalledByItself&&(a+="".concat(O.name,' -- "[ContinueAsNew]" --\x3e ').concat(O.name,"\n"))}}if(!n.doNotRenderProxies&&Object.keys(t).length>0){var P="#FFE6C8",D="",F=!1;for(var x in t){var M=t[x],L=x.replace(/ /g,"");F=M.warningNotAddedToCsProjFile,D="",M.matchCondition&&(M.matchCondition.methods&&M.matchCondition.methods.length&&(D+=(D?":":"")+"[".concat(M.matchCondition.methods.join(","),"]")),M.matchCondition.route&&(D+=(D?":":"")+M.matchCondition.route)),D||(D=x);var R="proxy.".concat(L);if(a+='proxies.json -. "'.concat(x,'" .-> ').concat(R,'(["').concat(It).concat(D,'"]):::proxy\n'),a+="style ".concat(R," fill:").concat(P,"\n"),M.backendUri){D=M.backendUri.replace(/'response./g,"'");var H="proxy.".concat(L,".backendUri");a+="".concat(R," ").concat(Ht(M.requestOverrides)," ").concat(H,'["').concat(It).concat(D,'"]:::http\n'),a+="style ".concat(H," fill:").concat(P,"\n"),R=H}var A="proxy.".concat(L,".response");a+="".concat(R," ").concat(At(M.responseOverrides)," ").concat(A,'(["').concat(It,'."]):::http\n'),a+="style ".concat(A," fill:").concat(P,"\n")}D="proxies.json";var z=P;F&&(D+=" #9888; Not added to .CSPROJ file!",z="#FF8080"),a+='proxies.json["'.concat(It).concat(D,'"]\n'),a+="style proxies.json fill:".concat(z,"\n")}return a}var xt,Mt,Lt,Rt=150;function Ht(e){if(!e)return"--\x3e";var t=JSON.stringify(e).replace(/"/g,"'").replace(/'backend.request./g,"'");return t.length>Rt&&(t=t.substr(0,Rt)+"..."),'-- "'.concat(t).concat(It,'" --\x3e')}function At(e){if(!e)return"--\x3e";e["response.body"]&&(e["response.body"]="...");var t=JSON.stringify(e).replace(/"/g,"'").replace(/'response./g,"'");return t.length>Rt&&(t=t.substr(0,Rt)+"..."),'-- "'.concat(t).concat(It,'" --\x3e')}var zt,Bt,Wt,Vt,Yt,Gt,Ut,Jt,qt,Zt,Kt,$t,Xt,Qt,en,tn,nn=function e(){Object(u.a)(this,e),this.completed=0,this.running=0,this.failed=0,this.other=0,this.duration=0},an=(xt=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e,a){var r;return Object(u.a)(this,n),(r=t.call(this,e))._startNewInstance=a,Object(z.a)(r,"menuAnchorElement",Mt,Object(Ue.a)(r)),r.TotalMetricsName="DurableFunctionsMonitor-ResultsFunctionGraphTabState-TotalNumbers",Object(z.a)(r,"_metrics",Lt,Object(Ue.a)(r)),r._numOfInstancesShown=0,r._pageSize=1e3,r._selectedFunctionName=void 0,r}return Object(m.a)(n,[{key:"metrics",get:function(){return this._metrics}},{key:"diagramSvg",get:function(){return this._diagramSvg}},{key:"diagramCode",get:function(){return this._diagramCode}},{key:"renderFunctions",get:function(){return this._renderFunctions},set:function(e){this._renderFunctions=e,this.render()}},{key:"renderProxies",get:function(){return this._renderProxies},set:function(e){this._renderProxies=e,this.render()}},{key:"showPopupMenu",value:function(e,t){this.menuAnchorElement=e,this._selectedFunctionName=t}},{key:"gotoOrchestrationCode",value:function(){this.menuAnchorElement=void 0,this._selectedFunctionName&&this.gotoFunctionCode(this._selectedFunctionName)}},{key:"startNewInstance",value:function(){this.menuAnchorElement=void 0,this._selectedFunctionName&&this._startNewInstance(this._selectedFunctionName)}},{key:"reset",value:function(){this._diagramCode="",this._diagramSvg="",this._traversalResult=null,this._metrics={},this._numOfInstancesShown=0}},{key:"load",value:function(e,t,n){var a=this;this.initMermaidWhenNeeded(),this._numOfInstancesShown=0;var r=n?{}:JSON.parse(JSON.stringify(this._metrics));return this._backendClient.call("GET","/function-map").then((function(i){return a._traversalResult=i,a.render().then((function(){return a.loadNextBatch(e,0,r,n,t).then((function(e){a._metrics=e}))}))}))}},{key:"loadNextBatch",value:function(e,t,n,a,r){var i=this,o="/orchestrations?$top=".concat(this._pageSize,"&$skip=").concat(this._numOfInstancesShown).concat(e);return this._backendClient.call("GET",o).then((function(o){if(r.isCancelled)return Promise.resolve(n);n[i.TotalMetricsName]||(n[i.TotalMetricsName]=new nn);var s,l=Object(Ge.a)(o);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=Le.getFunctionName(c);switch(n[u]||(n[u]=new nn),c.runtimeStatus){case"Completed":n[u].completed++,n[i.TotalMetricsName].completed++;break;case"Running":case"Pending":case"ContinuedAsNew":n[u].running++,n[i.TotalMetricsName].running++;break;case"Failed":n[u].failed++,n[i.TotalMetricsName].failed++;break;default:n[u].other++,n[i.TotalMetricsName].other++}}}catch(m){l.e(m)}finally{l.f()}return i._numOfInstancesShown+=o.length,a||(i._metrics=n),o.length===i._pageSize?i.loadNextBatch(e,t+1,n,a,r):n}))}},{key:"render",value:function(){var e=this;return this._diagramCode="",this._diagramSvg="",new Promise((function(t,n){try{var a=Ft(e._traversalResult.functions,e._traversalResult.proxies,{doNotRenderFunctions:!e._renderFunctions,doNotRenderProxies:!e._renderProxies});if(!a)return void t();e._diagramCode="graph LR\n".concat(a),Ct.a.render("mermaidSvgId",e._diagramCode,(function(n){e._diagramSvg=e.applyIcons(n),t()}))}catch(r){n(r)}}))}}]),n}(Nt),Mt=Object(B.a)(xt.prototype,"menuAnchorElement",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)(xt.prototype,"metrics",[W.e],Object.getOwnPropertyDescriptor(xt.prototype,"metrics"),xt.prototype),Object(B.a)(xt.prototype,"diagramSvg",[W.e],Object.getOwnPropertyDescriptor(xt.prototype,"diagramSvg"),xt.prototype),Object(B.a)(xt.prototype,"diagramCode",[W.e],Object.getOwnPropertyDescriptor(xt.prototype,"diagramCode"),xt.prototype),Object(B.a)(xt.prototype,"renderFunctions",[W.e],Object.getOwnPropertyDescriptor(xt.prototype,"renderFunctions"),xt.prototype),Object(B.a)(xt.prototype,"renderProxies",[W.e],Object.getOwnPropertyDescriptor(xt.prototype,"renderProxies"),xt.prototype),Lt=Object(B.a)(xt.prototype,"_metrics",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),xt),rn=function(){function e(){Object(u.a)(this,e),this._values={};var t,n=window.location.search.substr(1).split("&"),a=Object(Ge.a)(n);try{for(a.s();!(t=a.n()).done;){var r=t.value.split("=");r.length>1&&(this._values[r[0]]=decodeURIComponent(r[1]))}}catch(i){a.e(i)}finally{a.f()}}return Object(m.a)(e,[{key:"values",get:function(){return this._values}},{key:"apply",value:function(){var e="";for(var t in this._values)e&&(e+="&"),e+=t+"="+encodeURIComponent(this._values[t]);window.history.replaceState(null,null,e?"?"+e:"")}}]),e}();function on(e,t,n){if(!n||!e||"0"===e)return"";switch(t){case zt.Equals:return"".concat(e," eq '").concat(encodeURIComponent(n),"'");case zt.StartsWith:return"startswith(".concat(e,", '").concat(encodeURIComponent(n),"')");case zt.Contains:return"contains(".concat(e,", '").concat(encodeURIComponent(n),"')");case zt.NotEquals:return"".concat(e," ne '").concat(encodeURIComponent(n),"'");case zt.NotStartsWith:return"startswith(".concat(e,", '").concat(encodeURIComponent(n),"') eq false");case zt.NotContains:return"contains(".concat(e,", '").concat(encodeURIComponent(n),"') eq false");case zt.In:case zt.NotIn:var a=function(e){if(e.trim().startsWith("["))try{return JSON.parse(e).map((function(e){return"'".concat(e,"'")}))}catch(t){}return e.split(",").map((function(e){var t=e.trim();return t.startsWith("'")?t:"'".concat(t,"'")}))}(n),r="".concat(e," in (").concat(a.map((function(e){return encodeURIComponent(e)})).join(","),")");return t===zt.NotIn&&(r+=" eq false"),r;default:return""}}!function(e){e[e.Equals=0]="Equals",e[e.StartsWith=1]="StartsWith",e[e.Contains=2]="Contains",e[e.NotEquals=3]="NotEquals",e[e.NotStartsWith=4]="NotStartsWith",e[e.NotContains=5]="NotContains",e[e.In=6]="In",e[e.NotIn=7]="NotIn"}(zt||(zt={})),function(e){e[e.List=0]="List",e[e.Histogram=1]="Histogram",e[e.Gantt=2]="Gantt",e[e.FunctionGraph=3]="FunctionGraph"}(en||(en={})),function(e){e[e.Custom=0]="Custom",e[e.LastMinute=1]="LastMinute",e[e.Last10Minutes=2]="Last10Minutes",e[e.LastHour=3]="LastHour",e[e.Last24Hours=4]="Last24Hours",e[e.Last7Days=5]="Last7Days",e[e.Last30Days=6]="Last30Days",e[e.Last90Days=7]="Last90Days"}(tn||(tn={}));var sn,ln,cn,un,mn,dn,hn,pn,gn,fn,bn,yn,vn,On,En,_n,kn,Cn=(Bt=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e,a,r,i){var o,s;Object(u.a)(this,n),(o=t.call(this))._isFunctionGraphAvailable=e,o._backendClient=a,o._localStorage=r,o._startNewInstance=i,Object(z.a)(o,"menuAnchorElement",Wt,Object(Ue.a)(o)),Object(z.a)(o,"_tabIndex",Vt,Object(Ue.a)(o)),Object(z.a)(o,"_cancelToken",Yt,Object(Ue.a)(o)),Object(z.a)(o,"_autoRefresh",Gt,Object(Ue.a)(o)),Object(z.a)(o,"_timeFrom",Ut,Object(Ue.a)(o)),Object(z.a)(o,"_timeTill",Jt,Object(Ue.a)(o)),Object(z.a)(o,"_timeRange",qt,Object(Ue.a)(o)),Object(z.a)(o,"_filterValue",Zt,Object(Ue.a)(o)),Object(z.a)(o,"_filterOperator",Kt,Object(Ue.a)(o)),Object(z.a)(o,"_filteredColumn",$t,Object(Ue.a)(o)),Object(z.a)(o,"_showStatuses",Xt,Object(Ue.a)(o)),Object(z.a)(o,"_isStatusSelectOpen",Qt,Object(Ue.a)(o)),o._tabStates=void 0,o._refreshToken=void 0,o._selectAutoCloseToken=void 0,o._delayedRefreshDelay=5e3,o._oldFilterValue="",o._oldTimeFrom=void 0,o._oldTimeTill=void 0,o._tabStates=[new _t(o._backendClient,o._localStorage,(function(){return o.reloadOrchestrations()})),new St(o._backendClient,Object(Ue.a)(o)),new wt(o._backendClient)],o._isFunctionGraphAvailable&&o._tabStates.push(new an(o._backendClient,o._startNewInstance));var l=o._localStorage.getItem("timeFrom");s=l?Y()(l):Y()().subtract(1,"days"),o._timeFrom=s,o._oldTimeFrom=s;var c=o._localStorage.getItem("timeTill");c&&(o._timeTill=Y()(c),o._oldTimeTill=o._timeTill);var m=o._localStorage.getItem("timeRange");if(m){var d=new rn;d.values.timeFrom||d.values.timeTill||(o._timeRange=tn[m])}var h=o._localStorage.getItem("filteredColumn");h&&(o._filteredColumn=h);var p=o._localStorage.getItem("filterOperator");p&&(o._filterOperator=zt[p]);var g=o._localStorage.getItem("filterValue");g&&(o._filterValue=g,o._oldFilterValue=g);var f=o._localStorage.getItem("showStatuses");f&&(o._showStatuses=JSON.parse(f));var b=o._localStorage.getItem("autoRefresh");b&&(o._autoRefresh=Number(b));var y=o._localStorage.getItem("tabIndex");if(y){var v=Number(y);v>=0&&v<o._tabStates.length&&(o._tabIndex=v)}return o}return Object(m.a)(n,[{key:"tabIndex",get:function(){return this._tabIndex},set:function(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.reloadOrchestrations())}},{key:"selectedTabState",get:function(){return this._tabStates[this._tabIndex]}},{key:"inProgress",get:function(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}},{key:"autoRefresh",get:function(){return this._autoRefresh},set:function(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadOrchestrations(!0)}},{key:"timeFrom",get:function(){return this.getTimeFrom()},set:function(e){this._timeFrom=e,this._timeRange=tn.Custom}},{key:"timeTill",get:function(){return this.getTimeTill()},set:function(e){this._timeTill=e,this._timeRange=tn.Custom}},{key:"timeTillEnabled",get:function(){return!!this._timeTill},set:function(e){this._timeTill=e?Y()():null,e||this.reloadOrchestrations()}},{key:"timeRange",get:function(){return this._timeRange},set:function(e){this.menuAnchorElement=void 0,this._timeRange=e,this.reloadOrchestrations()}},{key:"filterValue",get:function(){return this._filterValue},set:function(e){this._filterValue=e}},{key:"filterOperator",get:function(){return this._filterOperator},set:function(e){this._filterOperator=e,this._filterValue&&"0"!==this._filteredColumn&&this.reloadOrchestrations()}},{key:"filteredColumn",get:function(){return this._filteredColumn},set:function(e){this._filteredColumn=e,this._filterValue&&("0"===this._filteredColumn&&(this._filterValue=""),this.reloadOrchestrations())}},{key:"showStatuses",get:function(){return this._showStatuses},set:function(e){var t=this;this._showStatuses=e,this._selectAutoCloseToken&&(clearTimeout(this._selectAutoCloseToken),this._selectAutoCloseToken=setTimeout((function(){t.isStatusSelectOpen=!1}),this._delayedRefreshDelay))}},{key:"isStatusSelectOpen",get:function(){return this._isStatusSelectOpen},set:function(e){var t=this;this._isStatusSelectOpen=e,this._isStatusSelectOpen?this._selectAutoCloseToken=setTimeout((function(){t.isStatusSelectOpen=!1}),this._delayedRefreshDelay):(this._selectAutoCloseToken&&(clearTimeout(this._selectAutoCloseToken),this._selectAutoCloseToken=void 0),this.reloadOrchestrations())}},{key:"showLastEventColumn",get:function(){return"lastEvent"===this._filteredColumn&&!!this._oldFilterValue}},{key:"backendClient",get:function(){return this._backendClient}},{key:"isFunctionGraphAvailable",get:function(){return this._isFunctionGraphAvailable}},{key:"applyTimeFrom",value:function(){Je.isValidMoment(this._timeFrom)&&this._oldTimeFrom!==this._timeFrom&&this.reloadOrchestrations()}},{key:"applyTimeTill",value:function(){Je.isValidMoment(this._timeTill)&&this._oldTimeTill!==this._timeTill&&this.reloadOrchestrations()}},{key:"applyFilterValue",value:function(){this._oldFilterValue!==this._filterValue&&this.reloadOrchestrations()}},{key:"reloadOrchestrations",value:function(){this._refreshToken&&(clearTimeout(this._refreshToken),this._refreshToken=null);var e,t=Object(Ge.a)(this._tabStates);try{for(t.s();!(e=t.n()).done;){e.value.reset()}}catch(n){t.e(n)}finally{t.f()}Je.isValidMoment(this._timeFrom)||(this._timeFrom=this._oldTimeFrom),this._timeTill&&!Je.isValidMoment(this._timeTill)&&(this._timeTill=this._oldTimeTill),this._localStorage.setItems([{fieldName:"timeFrom",value:this._timeRange?null:this._timeFrom.toISOString()},{fieldName:"timeTill",value:this._timeTill&&!this._timeRange?this._timeTill.toISOString():null},{fieldName:"timeRange",value:this._timeRange?tn[this._timeRange]:null},{fieldName:"filteredColumn",value:this._filteredColumn},{fieldName:"filterOperator",value:zt[this._filterOperator]},{fieldName:"filterValue",value:this._filterValue?this._filterValue:null},{fieldName:"showStatuses",value:this._showStatuses?JSON.stringify(this._showStatuses):null}]),this.loadOrchestrations(),this._oldFilterValue=this._filterValue,this._oldTimeFrom=this._timeFrom,this._oldTimeTill=this._timeTill}},{key:"cancel",value:function(){this._cancelToken.isCancelled=!0,this._cancelToken=new Ot}},{key:"loadOrchestrations",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this._cancelToken;if(!n.inProgress){n.inProgress=!0;var a="&$filter=createdTime ge '".concat(this.getTimeFrom().toISOString(),"' and createdTime le '").concat(this.getTimeTill().toISOString(),"'");this._showStatuses&&(a+=" and runtimeStatus in (".concat(this._showStatuses.map((function(e){return"'".concat(e,"'")})).join(","),")"));var r=on(this._filteredColumn,this._filterOperator,this._filterValue);r&&(a+=" and "+r),this.selectedTabState.load(a,n,t).then((function(){e._refreshToken&&clearTimeout(e._refreshToken),e._autoRefresh&&(e._refreshToken=setTimeout((function(){e.loadOrchestrations(!0)}),1e3*e._autoRefresh))}),(function(t){e._autoRefresh=0,n.isCancelled||e.showError("Load failed",t)})).finally((function(){n.inProgress=!1}))}}},{key:"getTimeFrom",value:function(){switch(this._timeRange){case tn.LastMinute:return Y()().subtract(1,"minutes");case tn.Last10Minutes:return Y()().subtract(10,"minutes");case tn.LastHour:return Y()().subtract(1,"hours");case tn.Last24Hours:return Y()().subtract(1,"days");case tn.Last7Days:return Y()().subtract(7,"days");case tn.Last30Days:return Y()().subtract(30,"days");case tn.Last90Days:return Y()().subtract(90,"days");default:return this._timeFrom}}},{key:"getTimeTill",value:function(){return this._timeRange||!this._timeTill?Y()():this._timeTill}}]),n}(vt),Object(B.a)(Bt.prototype,"tabIndex",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"tabIndex"),Bt.prototype),Object(B.a)(Bt.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"inProgress"),Bt.prototype),Object(B.a)(Bt.prototype,"autoRefresh",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"autoRefresh"),Bt.prototype),Object(B.a)(Bt.prototype,"timeFrom",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"timeFrom"),Bt.prototype),Object(B.a)(Bt.prototype,"timeTill",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"timeTill"),Bt.prototype),Object(B.a)(Bt.prototype,"timeTillEnabled",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"timeTillEnabled"),Bt.prototype),Object(B.a)(Bt.prototype,"timeRange",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"timeRange"),Bt.prototype),Wt=Object(B.a)(Bt.prototype,"menuAnchorElement",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)(Bt.prototype,"filterValue",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"filterValue"),Bt.prototype),Object(B.a)(Bt.prototype,"filterOperator",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"filterOperator"),Bt.prototype),Object(B.a)(Bt.prototype,"filteredColumn",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"filteredColumn"),Bt.prototype),Object(B.a)(Bt.prototype,"showStatuses",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"showStatuses"),Bt.prototype),Object(B.a)(Bt.prototype,"isStatusSelectOpen",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"isStatusSelectOpen"),Bt.prototype),Object(B.a)(Bt.prototype,"showLastEventColumn",[W.e],Object.getOwnPropertyDescriptor(Bt.prototype,"showLastEventColumn"),Bt.prototype),Vt=Object(B.a)(Bt.prototype,"_tabIndex",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return en.List}}),Yt=Object(B.a)(Bt.prototype,"_cancelToken",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ot}}),Gt=Object(B.a)(Bt.prototype,"_autoRefresh",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ut=Object(B.a)(Bt.prototype,"_timeFrom",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=Object(B.a)(Bt.prototype,"_timeTill",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Object(B.a)(Bt.prototype,"_timeRange",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return tn.Custom}}),Zt=Object(B.a)(Bt.prototype,"_filterValue",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Kt=Object(B.a)(Bt.prototype,"_filterOperator",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return zt.Equals}}),$t=Object(B.a)(Bt.prototype,"_filteredColumn",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0"}}),Xt=Object(B.a)(Bt.prototype,"_showStatuses",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qt=Object(B.a)(Bt.prototype,"_isStatusSelectOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bt),jn=n(703),wn=n(266),Sn=n(763),Nn=n(764),Tn=n(765),In=n(766),Pn=n(787),Dn=n(767),Fn=n(126),xn=n.n(Fn),Mn=n(776),Ln=DfmRoutePrefix?"/".concat(DfmRoutePrefix,"/"):"/",Rn=Ln+"a/p/i",Hn=function(){function e(t,n){Object(u.a)(this,e),this._getTaskHubName=t,this._getAuthorizationHeaderAsync=n}return Object(m.a)(e,[{key:"isVsCode",get:function(){return!1}},{key:"routePrefixAndTaskHubName",get:function(){return Ln+this._getTaskHubName()}},{key:"call",value:function(e,t,n){var a=this;return["get","post","put"].includes(e.toLowerCase())?new Promise((function(r,i){a._getAuthorizationHeaderAsync().then((function(o){var s=a._getTaskHubName();s.endsWith("TestHubName")&&"POST"===e&&t.match(/\/(orchestrations|restart)$/i)&&(s=s.replace("TestHubName","testhubname")),s.includes("-")||(s="--"+s),xn.a.request({url:Rn+"/"+s+t,method:e,data:n,headers:o}).then((function(e){r(e.data)}),i)}))})):Promise.reject(new Error("Method ".concat(e," not supported")))}},{key:"showDetails",value:function(e){window.open("".concat(this.routePrefixAndTaskHubName).concat(An).concat(e))}}]),e}(),An="/orchestrations/",zn=(sn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(u.a)(this,n),e=t.call(this),Object(z.a)(e,"menuAnchorElement",ln,Object(Ue.a)(e)),Object(z.a)(e,"_isLoggedIn",cn,Object(Ue.a)(e)),Object(z.a)(e,"_userName",un,Object(Ue.a)(e)),Object(z.a)(e,"_taskHubName",mn,Object(Ue.a)(e)),Object(z.a)(e,"_allowedTaskHubNames",dn,Object(Ue.a)(e)),e._aadApp=void 0,xn.a.defaults.maxRedirects=0,e.login(),e}return Object(m.a)(n,[{key:"isLoggedIn",get:function(){return this._isLoggedIn}},{key:"isLoggedInAnonymously",get:function(){return!this._userName}},{key:"userName",get:function(){return this._userName}},{key:"taskHubName",get:function(){return this._taskHubName}},{key:"allowedTaskHubNames",get:function(){return this._allowedTaskHubNames}},{key:"locationPathName",get:function(){var e=window.location.pathname,t=e.lastIndexOf(An);return t>=0&&(e=e.substring(0,t)),e.endsWith("/")||(e+="/"),e}},{key:"rootUri",get:function(){var e=this.tryGetTaskHubName();if(e){var t=window.location.href.toLowerCase().lastIndexOf("/"+e.toLowerCase());if(t>=0)return window.location.href.substring(0,t)}return window.location.origin+(window.location.pathname.endsWith("/")?window.location.pathname.substr(0,window.location.pathname.length-1):window.location.pathname)}},{key:"login",value:function(){var e=this,t="".concat(Rn,"/easyauth-config");xn.a.get(t).then((function(t){return e.loginWithEasyAuthConfig(t.data)}),(function(t){return e.showError("Failed to load auth config",t)}))}},{key:"logout",value:function(){this.menuAnchorElement=void 0,this._aadApp?this._aadApp.logout():window.location.replace("/.auth/logout")}},{key:"getAuthorizationHeaderAsync",value:function(){var e=this,t={},n="x-dfm-xsrf-token",a=new RegExp("".concat(n,"=([^;]+)")).exec(decodeURIComponent(document.cookie));return a&&(t["x-dfm-xsrf-token"]=a[1]),this._aadApp?new Promise((function(n,a){var r={scopes:[e._aadApp.getCurrentConfiguration().auth.clientId]};e._aadApp.acquireTokenSilent(r).then((function(e){var a=e.accessToken;a||(console.log("DFM: accessToken is null, so using idToken.rawIdToken instead"),a=e.idToken.rawIdToken),t.Authorization="Bearer ".concat(a),n(t)}),(function(t){console.log("DFM: acquireTokenSilent() failed (".concat(t,"), so calling acquireTokenRedirect()...")),e._aadApp.acquireTokenRedirect(r)}))})):new Promise((function(e,n){return e(t)}))}},{key:"loginWithEasyAuthConfig",value:function(e){if(!e.clientId)return this._userName=e.userName,xn.a.interceptors.response.use((function(e){return e}),(function(e){return"Network Error"===e.message&&window.location.reload(!0),Promise.reject(e)})),void this.initializeTaskHubNameAndConfirmLogin();this._aadApp=new Mn.a({auth:{clientId:e.clientId,authority:e.authority,redirectUri:this.rootUri}}),this._aadApp.handleRedirectCallback((function(){}),(function(e,t){console.log("Failed to handle login redirect. name: ".concat(e.name,", message: ").concat(e.message,", errorCode: ").concat(e.errorCode,", errorMessage: ").concat(e.errorMessage,", accountState: ").concat(t))}));var t=this._aadApp.getAccount();t?(this._userName=t.userName,this.initializeTaskHubNameAndConfirmLogin()):this._aadApp.loginRedirect()}},{key:"initializeTaskHubNameAndConfirmLogin",value:function(){var e=this,t=this.tryGetTaskHubName();if(t)return this._taskHubName=t,void(this._isLoggedIn=!0);this.getAuthorizationHeaderAsync().then((function(t){var n="".concat(Rn,"/task-hub-names");xn.a.get(n,{headers:t}).then((function(t){var n=t.data;1===n.length?window.location.pathname=e.locationPathName+n[0]:e._allowedTaskHubNames=n}),(function(t){return e.showError("Failed to load the list of Task Hubs",t)}))}))}},{key:"tryGetTaskHubName",value:function(){var e=this.locationPathName;if(e.toLowerCase().endsWith("/".concat(DfmRoutePrefix.toLowerCase(),"/")))return null;var t=e.split("/").filter((function(e){return!!e}));return t.length<1?null:t[t.length-1]}}]),n}(vt),Object(B.a)(sn.prototype,"isLoggedIn",[W.e],Object.getOwnPropertyDescriptor(sn.prototype,"isLoggedIn"),sn.prototype),Object(B.a)(sn.prototype,"isLoggedInAnonymously",[W.e],Object.getOwnPropertyDescriptor(sn.prototype,"isLoggedInAnonymously"),sn.prototype),Object(B.a)(sn.prototype,"userName",[W.e],Object.getOwnPropertyDescriptor(sn.prototype,"userName"),sn.prototype),Object(B.a)(sn.prototype,"taskHubName",[W.e],Object.getOwnPropertyDescriptor(sn.prototype,"taskHubName"),sn.prototype),Object(B.a)(sn.prototype,"allowedTaskHubNames",[W.e],Object.getOwnPropertyDescriptor(sn.prototype,"allowedTaskHubNames"),sn.prototype),ln=Object(B.a)(sn.prototype,"menuAnchorElement",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=Object(B.a)(sn.prototype,"_isLoggedIn",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),un=Object(B.a)(sn.prototype,"_userName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=Object(B.a)(sn.prototype,"_taskHubName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=Object(B.a)(sn.prototype,"_allowedTaskHubNames",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn),Bn=(hn=W.d.bound,Object(p.a)((gn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e,t;return this.props.backendClient.isVsCode?s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",className:"link-with-pointer-cursor",onClick:this.onLinkClicked},null!==(e=this.props.title)&&void 0!==e?e:this.props.orchestrationId):s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",href:"".concat(this.props.backendClient.routePrefixAndTaskHubName).concat(An).concat(this.extraSanitizeHrefComponent(this.props.orchestrationId)),target:"_blank"},null!==(t=this.props.title)&&void 0!==t?t:this.props.orchestrationId)}},{key:"onLinkClicked",value:function(){this.props.backendClient.call("OpenInNewWindow",this.props.orchestrationId)}},{key:"extraSanitizeHrefComponent",value:function(e){return e.replace(/javascript:/gi,"")}}]),n}(s.Component),Object(B.a)(gn.prototype,"onLinkClicked",[hn],Object.getOwnPropertyDescriptor(gn.prototype,"onLinkClicked"),gn.prototype),pn=gn))||pn),Wn=n(397),Vn=n(762),Yn=Object(p.a)(fn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(T.a,{fullWidth:!0,maxWidth:"md",open:!!e.jsonString,onClose:function(){return e.jsonString=""}},s.createElement(x.a,null,e.title),s.createElement(I.a,null,s.createElement(Wn.a,{multiline:!0,fullWidth:!0,readOnly:!0,value:e.jsonString})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.jsonString=""},color:$},"Close")))}}],[{key:"formatJson",value:function(e){if(!e)return"";if("string"===typeof e)try{e=JSON.parse(e)}catch(t){}return"string"===typeof e?e:JSON.stringify(e,null,3)}},{key:"renderJson",value:function(e,t,n){if(!e)return null;if("string"===typeof e)try{e=JSON.parse(e)}catch(i){}var a="string"===typeof e?e:JSON.stringify(e),r="string"===typeof e?e:JSON.stringify(e,null,3);return s.createElement(Wn.a,{color:"secondary",className:"long-text-cell-input",multiline:!0,fullWidth:!0,rowsMax:4,readOnly:!0,value:a.substr(0,512),onClick:function(){n.title=t,n.jsonString=r}})}}]),n}(s.Component))||fn,Gn=Object(p.a)((vn=yn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,s.createElement(jn.a,{className:"items-count-label"},!!e.orchestrations.length&&s.createElement(s.Fragment,null,e.orchestrations.length," items shown",!!e.hiddenColumns.length&&s.createElement(s.Fragment,null,", ",e.hiddenColumns.length," columns hidden (",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",className:"unhide-button",component:"button",variant:"inherit",onClick:function(){return e.unhide()}},"unhide"),")"),!!e.orderBy&&s.createElement(s.Fragment,null,", sorted by ",s.createElement("strong",null,e.orderBy," ",e.orderByDirection),"(",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",className:"unhide-button",component:"button",variant:"inherit",onClick:function(){return e.resetOrderBy()}},"reset"),")"))),s.createElement(wn.a,{elevation:0},this.renderTable(e)),s.createElement(Yn,{state:e.longJsonDialogState}))}},{key:"renderTable",value:function(e){var t=this;if(!e.orchestrations.length)return s.createElement(y.a,{variant:"h5",className:"empty-table-placeholder"},"This list is empty");var n=Re.filter((function(e){return!!t.props.showLastEventColumn||"lastEvent"!==e}));return s.createElement(Sn.a,{size:"small"},s.createElement(Nn.a,null,s.createElement(Tn.a,null,n.map((function(a){var r=n.length<=e.hiddenColumns.length+1;return!e.hiddenColumns.includes(a)&&s.createElement(In.a,{key:a,onMouseEnter:function(){return e.columnUnderMouse=a},onMouseLeave:function(){return e.columnUnderMouse=""}},s.createElement(Pn.a,{active:e.orderBy===a,direction:e.orderByDirection,onClick:function(){return e.orderBy=a}},a,["createdTime","lastUpdatedTime"].includes(a)&&s.createElement("span",{className:"time-zone-name-span"},"(",t.context.timeZoneName,")")),e.columnUnderMouse===a&&!r&&s.createElement(ue.a,{color:"inherit",size:"small",className:"column-hide-button",onClick:function(){return e.hideColumn(a)}},s.createElement(Be.a,null)))})))),s.createElement(Dn.a,null,e.orchestrations.map((function(n){var a=X(n.runtimeStatus),r={verticalAlign:"top"};return s.createElement(Tn.a,{key:n.instanceId,style:a},!e.hiddenColumns.includes("instanceId")&&s.createElement(In.a,{className:"instance-id-cell",style:r},s.createElement(Bn,{orchestrationId:n.instanceId,backendClient:t.props.backendClient})),!e.hiddenColumns.includes("name")&&s.createElement(In.a,{className:"name-cell",style:r},n.name),!e.hiddenColumns.includes("createdTime")&&s.createElement(In.a,{className:"datetime-cell",style:r},t.context.formatDateTimeString(n.createdTime)),!e.hiddenColumns.includes("lastUpdatedTime")&&s.createElement(In.a,{className:"datetime-cell",style:r},t.context.formatDateTimeString(n.lastUpdatedTime)),!e.hiddenColumns.includes("duration")&&s.createElement(In.a,{style:r},Je.formatDuration(n.duration)),!e.hiddenColumns.includes("runtimeStatus")&&s.createElement(In.a,{style:r},n.runtimeStatus),!e.hiddenColumns.includes("lastEvent")&&t.props.showLastEventColumn&&s.createElement(In.a,{style:r},n.lastEvent),!e.hiddenColumns.includes("input")&&s.createElement(In.a,{className:"long-text-cell",style:r},Yn.renderJson(n.input,"".concat(n.instanceId," / input"),e.longJsonDialogState)),!e.hiddenColumns.includes("output")&&s.createElement(In.a,{className:"output-cell",style:r},Yn.renderJson(n.output,"".concat(n.instanceId," / output"),e.longJsonDialogState)),!e.hiddenColumns.includes("customStatus")&&s.createElement(In.a,{className:"output-cell",style:r},Yn.renderJson(n.customStatus,"".concat(n.instanceId," / customStatus"),e.longJsonDialogState)))}))))}}]),n}(s.Component),yn.contextType=U,bn=vn))||bn,Un=n(127),Jn=Object(p.a)((_n=En=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state,n=Object.keys(t.histograms).sort();return s.createElement(s.Fragment,null,s.createElement(jn.a,{className:"items-count-label"},"".concat(t.numOfInstancesShown," items shown"),t.zoomedIn&&s.createElement(s.Fragment,null,", ",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",className:"unhide-button",component:"button",variant:"inherit",onClick:function(){return t.resetZoom()}},"reset zoom (Ctrl+Z)"))),s.createElement(Un.e,{width:window.innerWidth-40,height:window.innerHeight-400,xType:"time",stackBy:"y",margin:{left:80,right:10,top:20}},!!t.numOfInstancesShown&&s.createElement(Un.f,{tickTotal:7}),s.createElement(Un.d,{tickTotal:7,tickFormat:function(n){return e.formatTimeTick(n,t.timeRangeInMilliseconds)}}),n.map((function(n){return s.createElement(Un.c,{key:n,stroke:"white",color:e.getColorCodeForInstanceType(n),data:t.histograms[n]})})),!!t.numOfInstancesShown&&s.createElement(Un.b,{color:"#829AE3",drag:!0,enableY:!1,onDragEnd:function(e){e&&t.applyZoom(e.left,e.right)}})),s.createElement(Un.a,{className:"histogram-legend"+("dark"===Z.palette.type?" histogram-legend-dark-mode":""),colors:n.map((function(t){return e.getColorCodeForInstanceType(t)})),items:n.map((function(e){return"".concat(e," (").concat(t.counts[e],")")})),orientation:"horizontal"}))}},{key:"getColorCodeForInstanceType",value:function(e){for(var t=0,n=e.length-1;n>=0;n--)t=(t<<5)-t+e.charCodeAt(n),t&=2147483647;return t|=1048576,"#"+(t&=16777199).toString(16)}},{key:"formatTimeTick",value:function(e,t){var n=Y()(e);return this.context.showTimeAsLocal||n.utc(),t>432e6?n.format("YYYY-MM-DD"):t>864e5?n.format("YYYY-MM-DD HH:mm"):t>1e4?0===n.second()?n.format("HH:mm"):n.format("HH:mm:ss"):0===n.millisecond()?n.format("HH:mm:ss"):n.format(":SSS")}}]),n}(s.Component),En.contextType=U,On=_n))||On,qn=n(80),Zn=n.n(qn),Kn=n(264),$n=n.n(Kn),Xn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this;return this.props.backendClient.isVsCode?s.createElement(j.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return e.props.backendClient.call("SaveAs",e.props.fileName+".svg",e.props.svg)}},s.createElement($n.a,null),s.createElement(g.a,{width:20}),s.createElement(y.a,{color:"inherit"},"Save as .SVG")):s.createElement(j.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,href:URL.createObjectURL(new Blob([this.props.svg],{type:"image/svg+xml"})),download:this.props.fileName+".svg"},s.createElement($n.a,null),s.createElement(g.a,{width:20}),s.createElement(y.a,{color:"inherit"},"Save as .SVG"))}}]),n}(s.Component);function Qn(e){return e.replace("</style>",".note { stroke: none !important; fill: none !important; } .noteText { font-size: 9px !important; } .label > g > text { transform: translateX(25px); }</style>")}var ea,ta=Object(p.a)(kn=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("task")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideLeft")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideRight")))}},{key:"render",value:function(){var e=this.props.state;return e.rawHtml?s.createElement(s.Fragment,null,s.createElement("div",{className:"raw-html-div",style:K,dangerouslySetInnerHTML:{__html:Qn(e.rawHtml)}}),s.createElement(b.a,{variant:"dense"},s.createElement(y.a,{style:{flex:1}}),s.createElement(j.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},s.createElement(Zn.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Copy diagram code to Clipboard")),s.createElement(g.a,{width:20}),s.createElement(Xn,{svg:Qn(e.rawHtml),fileName:this.props.fileName,inProgress:this.props.inProgress,backendClient:this.props.backendClient}),s.createElement(g.a,{width:20}))):null}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=function(){var n=e[a],r=parseInt(n.id.substr(4));n.onclick=function(){return t.goto(r)},n.style.cursor="pointer",n.onmouseenter=function(e){e.target.style.strokeOpacity="0.5"},n.onmouseleave=function(e){e.target.style.strokeOpacity="1"}},a=0;a<e.length;a++)n()}}]),n}(s.Component))||kn,na=n(788),aa=(n(692),n(377),function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"mountClickEventToFunctionNodes",value:function(e){var t=this,a=this.props.state;n.forEachFunctionNode(e,(function(e,n){e.onclick=function(){return a.gotoFunctionCode(n)},t.showAsClickable(e)}))}},{key:"showAsClickable",value:function(e){e.style.cursor="pointer",e.onmouseenter=function(e){e.target.style.strokeOpacity="0.5"},e.onmouseleave=function(e){e.target.style.strokeOpacity="1"}}}],[{key:"forEachFunctionNode",value:function(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=/flowchart-(.+)-/.exec(a.id);r&&t(a,r[1])}}}]),n}(s.Component)),ra=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).RunningStyle=ee("Running"),e.CompletedStyle=ee("Completed"),e.FailedStyle=ee("Failed"),e.OtherStyle=ee("Terminated"),e.DurationStyle=ee("Duration"),e}return Object(m.a)(n,null,[{key:"repositionMetricHints",value:function(){for(var e=document.getElementsByClassName("metrics-span"),t=0;t<e.length;t++){e[t].style.visibility="hidden"}var a=document.getElementById("mermaidSvgId");if(a){var r=n.nodeTypesToHighlight.map((function(e){return Array.from(a.getElementsByClassName(e))})).flat(),i="";if(n.forEachFunctionNode(r,(function(e,t){var n=document.getElementById("metrics-hint-".concat(t.toLowerCase()));if(n){i="data-is-highlighted",e.setAttribute(i,"true");var a=e.getBoundingClientRect();n.style.visibility="visible",n.style.left="".concat(a.left+5,"px"),n.style.top="".concat(a.top-17,"px")}})),i)for(var o=0,s=Array.from(a.getElementsByClassName("node"));o<s.length;o++){var l=s[o];l.style.opacity=l.getAttribute(i)?"1":"0.6"}}}}]),n}(aa);ra.nodeTypesToHighlight=["orchestrator","entity"];var ia,oa,sa,la,ca,ua,ma,da,ha,pa,ga,fa,ba,ya,va=Object(p.a)(ea=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",n.repositionMetricHints),n.repositionMetricHints()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",n.repositionMetricHints)}},{key:"componentDidUpdate",value:function(){n.repositionMetricHints();var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("proxy")),this.mountClickEventToOrchestrationNodes(e.getElementsByClassName("orchestrator")))}},{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,s.createElement(jn.a,{className:"link-to-az-func-as-a-graph"},"powered by ",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",variant:"inherit",href:"https://github.com/scale-tone/az-func-as-a-graph"},"az-func-as-a-graph")),!!e.functionsLoaded&&s.createElement(ke.a,{row:!0,className:"settings-group"},s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:this.props.inProgress,checked:e.renderFunctions,onChange:function(t){return e.renderFunctions=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Functions")}),s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:this.props.inProgress,checked:e.renderProxies,onChange:function(t){return e.renderProxies=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Proxies")}),this.renderTotalMetric()),this.renderMetrics(),!!e.diagramSvg&&s.createElement(s.Fragment,null,s.createElement("div",{className:"diagram-div",style:K,dangerouslySetInnerHTML:{__html:Qn(e.diagramSvg)}}),s.createElement(b.a,{variant:"dense"},s.createElement(y.a,{style:{flex:1}}),s.createElement(j.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},s.createElement(Zn.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Copy diagram code to Clipboard")),s.createElement(g.a,{width:20}),s.createElement(Xn,{svg:Qn(e.diagramSvg),fileName:this.props.fileName,inProgress:this.props.inProgress,backendClient:this.props.backendClient}),s.createElement(g.a,{width:20})),s.createElement(S.a,{anchorEl:e.menuAnchorElement,anchorOrigin:{vertical:"center",horizontal:"left"},keepMounted:!0,open:!!e.menuAnchorElement,onClose:function(){return e.menuAnchorElement=void 0}},s.createElement(N.a,{onClick:function(){return e.gotoOrchestrationCode()}},"Go to Code"),s.createElement(N.a,{onClick:function(){return e.startNewInstance()}},"Start New Instance..."))))}},{key:"renderTotalMetric",value:function(){var e=this.props.state,t=e.metrics[e.TotalMetricsName];return!!t&&(!!t.completed||!!t.running||!!t.failed||!!t.other)&&s.createElement("span",{className:"total-metrics-span"},s.createElement(y.a,{color:"textPrimary"},"Total instances:"),s.createElement(g.a,{width:10}),!!t.completed&&s.createElement(na.a,{className:"metrics-chip",style:this.CompletedStyle,variant:"outlined",size:"small",label:"".concat(t.completed," completed")}),!!t.running&&s.createElement(na.a,{className:"metrics-chip",style:this.RunningStyle,variant:"outlined",size:"small",label:"".concat(t.running," running")}),!!t.failed&&s.createElement(na.a,{className:"metrics-chip",style:this.FailedStyle,variant:"outlined",size:"small",label:"".concat(t.failed," failed")}),!!t.other&&s.createElement(na.a,{className:"metrics-chip",style:this.OtherStyle,variant:"outlined",size:"small",label:"".concat(t.other," other")}))}},{key:"renderMetrics",value:function(){var e=this,t=this.props.state;return Object.keys(t.metrics).map((function(n){var a=t.metrics[n];return s.createElement("span",{id:"metrics-hint-".concat(n.toLowerCase()),key:"metrics-hint-".concat(n),className:"metrics-span"},!!a.completed&&s.createElement(w.a,{title:"Number of completed instances"},s.createElement(na.a,{className:"metrics-chip",style:e.CompletedStyle,variant:"outlined",size:"small",label:"".concat(a.completed)})),!!a.running&&s.createElement(w.a,{title:"Number of running instances"},s.createElement(na.a,{className:"metrics-chip",style:e.RunningStyle,variant:"outlined",size:"small",label:"".concat(a.running)})),!!a.failed&&s.createElement(w.a,{title:"Number of failed instances"},s.createElement(na.a,{className:"metrics-chip",style:e.FailedStyle,variant:"outlined",size:"small",label:"".concat(a.failed)})),!!a.other&&s.createElement(w.a,{title:"Number of terminated/cancelled instances"},s.createElement(na.a,{className:"metrics-chip",style:e.OtherStyle,variant:"outlined",size:"small",label:"".concat(a.other)})))}))}},{key:"mountClickEventToOrchestrationNodes",value:function(e){var t=this,a=this.props.state;n.forEachFunctionNode(e,(function(e,n){e.onclick=function(){return a.showPopupMenu(e,n)},t.showAsClickable(e)}))}}]),n}(ra))||ea,Oa=(ia=W.d.bound,Object(p.a)((ca=la=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.props.state.loadOrchestrations(),document.addEventListener("scroll",(function(t){var n=e.props.state;if(n.tabIndex===en.List){var a=t.target.scrollingElement;if(a){a.scrollHeight-window.innerHeight-a.scrollTop<100&&n.loadOrchestrations()}}})),document.addEventListener("keydown",(function(t){var n=e.props.state;n.tabIndex===en.Histogram&&t.ctrlKey&&90===t.keyCode&&n.selectedTabState.resetZoom()}))}},{key:"render",value:function(){var e,t=this,n=this.props.state,a=n.selectedTabState,r=n.selectedTabState,i=n.selectedTabState,o=n.selectedTabState,l="[Show All]";return s.createElement(s.Fragment,null,s.createElement(S.a,{anchorEl:n.menuAnchorElement,keepMounted:!0,open:!!n.menuAnchorElement,onClose:function(){return n.menuAnchorElement=void 0}},s.createElement(N.a,{onClick:function(){return n.timeRange=tn.LastMinute}},"Last Minute"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Last10Minutes}},"Last 10 Minutes"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.LastHour}},"Last Hour"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Last24Hours}},"Last 24 Hours"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Last7Days}},"Last 7 Days"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Last30Days}},"Last 30 Days"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Last90Days}},"Last 90 Days"),s.createElement(N.a,{onClick:function(){return n.timeRange=tn.Custom}},"Custom")),s.createElement(f.a,{color:"inherit",position:"static",className:"top-appbar"},n.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(b.a,{variant:"dense",className:"top-toolbar"},s.createElement(ye.a,{container:!0,className:"toolbar-grid1"},s.createElement(ye.a,{item:!0,xs:12},s.createElement(j.a,{size:"small",variant:"outlined",className:"time-period-menu-drop-btn",onClick:function(e){return n.menuAnchorElement=e.currentTarget}},s.createElement(Fe.a,null)),n.timeRange?s.createElement(E.a,{className:"from-input",label:"Time Range",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},type:"text",value:this.timeRangeToString(n.timeRange)}):s.createElement(Se.a,{className:"from-input",ampm:!1,autoOk:!0,label:"From (".concat(this.context.timeZoneName,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:n.inProgress,value:this.context.getMoment(n.timeFrom),onChange:function(e){return n.timeFrom=t.context.setMoment(e)},onBlur:function(){return n.applyTimeFrom()},onAccept:function(){return n.applyTimeFrom()},onKeyPress:this.handleKeyPress})),s.createElement(ye.a,{item:!0,xs:12,className:"toolbar-grid1-item2"},!n.timeRange&&s.createElement(s.Fragment,null,s.createElement(ve.a,null,s.createElement(Oe.a,{id:"till-checkbox",className:"till-checkbox",disabled:n.inProgress,checked:n.timeTillEnabled,onChange:function(e){return n.timeTillEnabled=e.target.checked}})),n.timeTillEnabled?s.createElement(Se.a,{className:"till-input",ampm:!1,autoOk:!0,label:"Till (".concat(this.context.timeZoneName,")"),invalidDateMessage:"",format:"YYYY-MM-DD HH:mm:ss",disabled:n.inProgress,value:this.context.getMoment(n.timeTill),onChange:function(e){return n.timeTill=t.context.setMoment(e)},onBlur:function(){return n.applyTimeTill()},onAccept:function(){return n.applyTimeTill()},onKeyPress:this.handleKeyPress}):s.createElement(E.a,{className:"till-input",label:"Till (".concat(this.context.timeZoneName,")"),placeholder:"[Now]",InputLabelProps:{shrink:!0},type:"text",disabled:!0})))),s.createElement(ye.a,{container:!0,className:"toolbar-grid2"},s.createElement(ye.a,{item:!0,xs:12,className:"toolbar-grid2-item-1"},s.createElement(ve.a,null,s.createElement(Ee.a,{htmlFor:"filtered-column-select"},"Filtered Column"),s.createElement(_e.a,{className:"toolbar-select filtered-column-input",disabled:n.inProgress,value:n.filteredColumn,onChange:function(e){return n.filteredColumn=e.target.value},inputProps:{id:"filtered-column-select"}},s.createElement(N.a,{value:"0"},"[Not Selected]"),Re.map((function(e){return s.createElement(N.a,{key:e,value:e},e)})))),s.createElement(ve.a,{className:"toolbar-grid2-item1-select"},s.createElement(Ee.a,{htmlFor:"filter-operator-select"},"Filter Operator"),s.createElement(_e.a,{className:"toolbar-select",disabled:n.inProgress,value:n.filterOperator,onChange:function(e){return n.filterOperator=e.target.value},inputProps:{id:"filter-operator-select"}},s.createElement(N.a,{value:zt.Equals},"Equals"),s.createElement(N.a,{value:zt.StartsWith},"Starts With"),s.createElement(N.a,{value:zt.Contains},"Contains"),s.createElement(N.a,{value:zt.In},"In"),s.createElement(N.a,{value:zt.NotEquals},"Not Equals"),s.createElement(N.a,{value:zt.NotStartsWith},"Not Starts With"),s.createElement(N.a,{value:zt.NotContains},"Not Contains"),s.createElement(N.a,{value:zt.NotIn},"Not In"))),s.createElement(E.a,{fullWidth:!0,className:"filter-value-input",label:"Filter Value",InputLabelProps:{shrink:!0},placeholder:[zt.In,zt.NotIn].includes(n.filterOperator)?"[comma-separated or JSON array]":"[some text or 'null']",disabled:"0"===n.filteredColumn||n.inProgress,value:n.filterValue,onChange:function(e){return n.filterValue=e.target.value},onBlur:function(){return n.applyFilterValue()},onKeyPress:this.handleKeyPress})),s.createElement(ye.a,{item:!0,xs:12,className:"toolbar-grid2-item2"},s.createElement(ke.a,{className:"toolbar-runtime-status-checkbox-group"},s.createElement(Ee.a,{shrink:!0},"Type/Status ",n.showStatuses?" (".concat(n.showStatuses.length," selected)"):""),s.createElement(_e.a,{multiple:!0,className:"toolbar-select",disabled:n.inProgress,value:null!==(e=n.showStatuses)&&void 0!==e?e:[l],onChange:function(e){var t=e.target.value;n.showStatuses&&t.includes(l)?n.showStatuses=null:(t=t.filter((function(e){return e!=l})),n.showStatuses=t.length?t:null)},open:n.isStatusSelectOpen,onClose:function(){n.isStatusSelectOpen=!1},onOpen:function(e){n.isStatusSelectOpen=!0},renderValue:function(e){var t=[],n=e.filter((function(e){return e!=l&&"DurableEntities"!=e}));return n.length&&t.push("Orchestrations: "+n.join(", ")),e.includes("DurableEntities")&&t.push("Durable Entities"),t.length?t.join("; "):l}},s.createElement(N.a,{key:l,value:l},s.createElement(Oe.a,{checked:!n.showStatuses}),s.createElement(Ce.a,{primary:l})),Me.map((function(e){return s.createElement(N.a,{key:e,value:e},s.createElement(Oe.a,{checked:!!n.showStatuses&&!!n.showStatuses.includes(e)}),s.createElement(Ce.a,{primary:"Orchestrations: "+e}))})),s.createElement(N.a,{key:"DurableEntities",value:"DurableEntities"},s.createElement(Oe.a,{checked:!!n.showStatuses&&!!n.showStatuses.includes("DurableEntities")}),s.createElement(Ce.a,{primary:"Durable Entities"})))))),s.createElement(ye.a,{container:!0,className:"toolbar-grid3"},s.createElement(ye.a,{item:!0,xs:12},s.createElement(ve.a,{className:"form-control-float-right"},s.createElement(Ee.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),s.createElement(_e.a,{className:"autorefresh-select",inputProps:{id:"auto-refresh-select"},value:n.autoRefresh,onChange:function(e){return n.autoRefresh=e.target.value}},s.createElement(N.a,{value:0},"Never"),s.createElement(N.a,{value:1},"Every 1 sec."),s.createElement(N.a,{value:5},"Every 5 sec."),s.createElement(N.a,{value:10},"Every 10 sec.")))),s.createElement(ye.a,{item:!0,xs:12,className:"toolbar-grid3-item2"},s.createElement(j.a,{className:"refresh-button form-control-float-right",variant:"outlined",color:"default",size:"large",onClick:function(){return n.inProgress?n.cancel():n.reloadOrchestrations()}},n.inProgress?s.createElement(Pe.a,null):s.createElement(Te.a,null)))))),s.createElement(f.a,{color:"inherit",position:"static"},s.createElement(je.a,{className:"tab-buttons",value:n.tabIndex,onChange:function(e,t){return n.tabIndex=t}},s.createElement(we.a,{className:"tab-buttons",disabled:n.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},"List")}),s.createElement(we.a,{className:"tab-buttons",disabled:n.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},"Time Histogram")}),s.createElement(we.a,{className:"tab-buttons",disabled:n.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},"Gantt Chart")}),!!n.isFunctionGraphAvailable&&s.createElement(we.a,{className:"tab-buttons",disabled:n.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},"Functions Graph")}))),n.tabIndex===en.List&&s.createElement(s.Fragment,null,s.createElement(Gn,{state:a,showLastEventColumn:n.showLastEventColumn,backendClient:n.backendClient}),n.inProgress&&a.orchestrations.length?s.createElement(be.a,null):s.createElement(g.a,{height:4})),n.tabIndex===en.Histogram&&s.createElement(Jn,{state:r}),n.tabIndex===en.Gantt&&s.createElement(ta,{state:i,inProgress:n.inProgress,fileName:"gantt-chart-".concat(n.timeFrom.format("YYYY-MM-DD-HH-mm-ss"),"-").concat(n.timeTill.format("YYYY-MM-DD-HH-mm-ss")),backendClient:n.backendClient}),n.tabIndex===en.FunctionGraph&&s.createElement(va,{state:o,inProgress:n.inProgress,fileName:"function-graph-".concat(n.timeFrom.format("YYYY-MM-DD-HH-mm-ss"),"-").concat(n.timeTill.format("YYYY-MM-DD-HH-mm-ss")),backendClient:n.backendClient}),s.createElement(b.a,{variant:"dense"}),s.createElement(Ye,{state:this.props.state}))}},{key:"timeRangeToString",value:function(e){switch(e){case tn.LastMinute:return"Last Minute";case tn.Last10Minutes:return"Last 10 Minutes";case tn.LastHour:return"Last Hour";case tn.Last24Hours:return"Last 24 Hours";case tn.Last7Days:return"Last 7 Days";case tn.Last30Days:return"Last 30 Days";case tn.Last90Days:return"Last 90 Days";default:return""}}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.reloadOrchestrations())}}]),n}(s.Component),la.contextType=U,sa=ca,Object(B.a)(sa.prototype,"handleKeyPress",[ia],Object.getOwnPropertyDescriptor(sa.prototype,"handleKeyPress"),sa.prototype),oa=sa))||oa),Ea=(n(693),Object(p.a)(ua=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,this.renderDialogs(e),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.purgeConfirmationOpen=!0}},"Purge"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.raiseEventDialogOpen=!0}},"Send Signal"))}},{key:"renderDialogs",value:function(e){return s.createElement(s.Fragment,null,s.createElement(T.a,{open:e.purgeConfirmationOpen,onClose:function(){return e.purgeConfirmationOpen=!1}},s.createElement(x.a,null,"Confirm Purge"),s.createElement(I.a,null,s.createElement(F.a,null,"You're about to purge entity '",e.orchestrationId,"'. This operation drops entity state from the underlying storage and cannot be undone. Are you sure?")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.purgeConfirmationOpen=!1},color:$,autoFocus:!0},"Cancel"),s.createElement(j.a,{onClick:function(){return e.purge()},color:"secondary"},"Yes, purge"))),s.createElement(T.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:function(){return e.raiseEventDialogOpen=!1}},s.createElement(x.a,null,"Send Signal"),s.createElement(I.a,null,s.createElement(F.a,null,"Provide signal name and some additional data"),s.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Signal Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:function(t){return e.eventName=t.target.value}}),s.createElement(E.a,{margin:"dense",label:"Signal Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:function(t){return e.eventData=t.target.value}})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.raiseEventDialogOpen=!1},color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return e.raiseEvent()},disabled:!e.eventName,color:"secondary"},"Send"))))}}]),n}(s.Component))||ua),_a=Object(p.a)((ha=da=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"render",value:function(){var e,t,n=this.props.details,a=X(n.runtimeStatus);return s.createElement(s.Fragment,null,s.createElement(ye.a,{container:!0,className:"grid-container"},s.createElement(ye.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"entityId.name",value:null===(e=n.entityId)||void 0===e?void 0:e.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:6,md:3,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"entityId.key",value:null===(t=n.entityId)||void 0===t?void 0:t.key,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"createdTime (".concat(this.context.timeZoneName,")"),value:this.context.formatDateTimeString(n.createdTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"lastUpdatedTime (".concat(this.context.timeZoneName,")"),value:this.context.formatDateTimeString(n.lastUpdatedTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:6,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"runtimeStatus",value:n.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:a})),s.createElement(ye.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"input",value:Yn.formatJson(n.input),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10})),s.createElement(ye.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"customStatus",value:Yn.formatJson(n.customStatus),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:10}))))}}]),n}(s.Component),da.contextType=U,ma=ha))||ma,ka=Object(p.a)(pa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,this.renderDialogs(e),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.restartDialogOpen=!0}},"Restart"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.rewindConfirmationOpen=!0}},"Rewind"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.terminateConfirmationOpen=!0}},"Terminate"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.raiseEventDialogOpen=!0}},"Raise Event"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.setCustomStatusDialogOpen=!0}},"Set Custom Status"),s.createElement(g.a,{width:10}),s.createElement(j.a,{variant:"outlined",color:$,size:"medium",disabled:this.props.disabled,onClick:function(){return e.purgeConfirmationOpen=!0}},"Purge"))}},{key:"renderDialogs",value:function(e){return s.createElement(s.Fragment,null,s.createElement(T.a,{open:e.rewindConfirmationOpen,onClose:function(){return e.rewindConfirmationOpen=!1}},s.createElement(x.a,null,"Confirm Rewind"),s.createElement(I.a,null,s.createElement(F.a,null,"You're about to rewind orchestration '",e.orchestrationId,"'. Are you sure?")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.rewindConfirmationOpen=!1},color:$,autoFocus:!0},"Cancel"),s.createElement(j.a,{onClick:function(){return e.rewind()},color:"secondary"},"Yes, rewind"))),s.createElement(T.a,{open:e.terminateConfirmationOpen,onClose:function(){return e.terminateConfirmationOpen=!1}},s.createElement(x.a,null,"Confirm Terminate"),s.createElement(I.a,null,s.createElement(F.a,null,"You're about to terminate orchestration '",e.orchestrationId,"'. This operation cannot be undone. Are you sure?")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.terminateConfirmationOpen=!1},color:$,autoFocus:!0},"Cancel"),s.createElement(j.a,{onClick:function(){return e.terminate()},color:"secondary"},"Yes, terminate"))),s.createElement(T.a,{fullWidth:!0,open:e.raiseEventDialogOpen,onClose:function(){return e.raiseEventDialogOpen=!1}},s.createElement(x.a,null,"Raise Event"),s.createElement(I.a,null,s.createElement(F.a,null,"Provide event name and some additional data"),s.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Event Name",InputLabelProps:{shrink:!0},fullWidth:!0,value:e.eventName,onChange:function(t){return e.eventName=t.target.value}}),s.createElement(E.a,{margin:"dense",label:"Event Data (JSON)",InputLabelProps:{shrink:!0},fullWidth:!0,multiline:!0,rows:7,value:e.eventData,onChange:function(t){return e.eventData=t.target.value}})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.raiseEventDialogOpen=!1},color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return e.raiseEvent()},disabled:!e.eventName,color:"secondary"},"Raise"))),s.createElement(T.a,{fullWidth:!0,open:e.setCustomStatusDialogOpen,onClose:function(){return e.setCustomStatusDialogOpen=!1}},s.createElement(x.a,null,"Set customStatus"),s.createElement(I.a,null,s.createElement(F.a,null,"customStatus field is a way for external clients to differentiate instances of your orchestration. It does not affect the orchestration workflow itself."),s.createElement(E.a,{margin:"dense",InputLabelProps:{shrink:!0},label:"New customStatus (JSON)",fullWidth:!0,multiline:!0,rows:10,value:e.newCustomStatus,onChange:function(t){return e.newCustomStatus=t.target.value}})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.setCustomStatusDialogOpen=!1},color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return e.setCustomStatus()},disabled:!e.isCustomStatusDirty,color:"secondary"},"Apply"))),s.createElement(T.a,{open:e.purgeConfirmationOpen,onClose:function(){return e.purgeConfirmationOpen=!1}},s.createElement(x.a,null,"Confirm Purge"),s.createElement(I.a,null,s.createElement(F.a,null,"You're about to purge orchestration '",e.orchestrationId,"'. This operation drops orchestration state from the underlying storage and cannot be undone. Are you sure?")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.purgeConfirmationOpen=!1},color:$,autoFocus:!0},"Cancel"),s.createElement(j.a,{onClick:function(){return e.purge()},color:"secondary"},"Yes, purge"))),s.createElement(T.a,{open:e.restartDialogOpen,onClose:function(){return e.restartDialogOpen=!1}},s.createElement(x.a,null,"Confirm Restart"),s.createElement(I.a,null,s.createElement(F.a,null,"You're about to restart orchestration '",e.orchestrationId,"'. Are you sure?"),s.createElement(de.a,{control:s.createElement(Oe.a,{checked:e.restartWithNewInstanceId,onChange:function(t){return e.restartWithNewInstanceId=t.target.checked}}),label:"Restart with new instanceId"})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.restartDialogOpen=!1},color:$,autoFocus:!0},"Cancel"),s.createElement(j.a,{onClick:function(){return e.restart()},color:"secondary"},"Restart"))))}}]),n}(s.Component))||pa;!function(e){e[e.RawHtml=0]="RawHtml",e[e.MermaidDiagram=1]="MermaidDiagram",e[e.FunctionGraph=2]="FunctionGraph"}(ga||(ga={}));var Ca,ja,wa,Sa,Na,Ta,Ia,Pa,Da,Fa,xa,Ma,La,Ra,Ha,Aa,za,Ba,Wa,Va,Ya,Ga,Ua,Ja,qa,Za,Ka,$a,Xa,Qa,er,tr,nr,ar,rr,ir,or,sr,lr,cr,ur,mr,dr,hr,pr,gr,fr,br,yr,vr,Or,Er,_r,kr,Cr,jr,wr,Sr,Nr,Tr,Ir,Pr,Dr,Fr,xr,Mr,Lr,Rr,Hr,Ar,zr,Br,Wr,Vr,Yr,Gr,Ur,Jr=Object(p.a)((ya=ba=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("scroll",(function(t){var n=t.target.scrollingElement;if(n){n.scrollHeight-window.innerHeight-n.scrollTop<50&&e.props.state.loadHistory()}}))}},{key:"render",value:function(){var e=this,t=this.props.state,n=t.historyTotalCount,a=t.details,r=t.history,i=r.length,o=X(a.runtimeStatus);return s.createElement(s.Fragment,null,s.createElement(ye.a,{container:!0,className:"grid-container"},s.createElement(ye.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"instanceId",value:a.instanceId,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:12,md:3,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"name",value:a.name,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"createdTime (".concat(this.context.timeZoneName,")"),value:this.context.formatDateTimeString(a.createdTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"lastUpdatedTime (".concat(this.context.timeZoneName,")"),value:this.context.formatDateTimeString(a.lastUpdatedTime),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0})),s.createElement(ye.a,{item:!0,xs:12,sm:4,md:2,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"runtimeStatus",value:a.runtimeStatus,margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,style:o})),s.createElement(ye.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"input",value:Yn.formatJson(a.input),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),s.createElement(ye.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"output",value:Yn.formatJson(a.output),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8})),s.createElement(ye.a,{item:!0,xs:12,zeroMinWidth:!0,className:"grid-item"},s.createElement(E.a,{label:"customStatus",value:Yn.formatJson(a.customStatus),margin:"normal",InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},variant:"outlined",fullWidth:!0,multiline:!0,rowsMax:8}))),s.createElement(f.a,{color:"inherit",position:"static",className:"history-appbar"},s.createElement(b.a,null,s.createElement(y.a,{variant:"subtitle2",color:"inherit",className:"history-toolbar"},"Execution History (",n&&n!==i?"".concat(i," of ").concat(n," items shown"):"".concat(i," items").concat(n?"":" shown"),"0"!==t.filteredColumn&&t.filterValue?", filtered by ".concat(t.filteredColumn):"",")"),s.createElement(y.a,{style:{flex:1}}),s.createElement(ve.a,null,s.createElement(Ee.a,{htmlFor:"history-filtered-column-select"},"Filtered Column"),s.createElement(_e.a,{className:"toolbar-select history-filtered-column-input",disabled:t.inProgress,value:t.filteredColumn,onChange:function(e){return t.filteredColumn=e.target.value},inputProps:{id:"history-filtered-column-select"}},s.createElement(N.a,{value:"0"},"[Not Selected]"),xe.map((function(e){return s.createElement(N.a,{key:e,value:e},e)})))),s.createElement(ve.a,null,s.createElement(Ee.a,{htmlFor:"history-filter-operator-select"},"Filter Operator"),s.createElement(_e.a,{className:"toolbar-select",disabled:t.inProgress,value:t.filterOperator,onChange:function(e){return t.filterOperator=e.target.value},inputProps:{id:"history-filter-operator-select"}},s.createElement(N.a,{value:zt.Equals},"Equals"),s.createElement(N.a,{value:zt.StartsWith},"Starts With"),s.createElement(N.a,{value:zt.Contains},"Contains"),s.createElement(N.a,{value:zt.In},"In"),s.createElement(N.a,{value:zt.NotEquals},"Not Equals"),s.createElement(N.a,{value:zt.NotStartsWith},"Not Starts With"),s.createElement(N.a,{value:zt.NotContains},"Not Contains"),s.createElement(N.a,{value:zt.NotIn},"Not In"))),s.createElement(E.a,{size:"small",className:"history-filter-value-input",label:"Filter Value",InputLabelProps:{shrink:!0},placeholder:[zt.In,zt.NotIn].includes(t.filterOperator)?"[comma-separated or JSON array]":"[some text or 'null']",disabled:"0"===t.filteredColumn||t.inProgress,value:t.filterValue,onChange:function(e){return t.filterValue=e.target.value},onBlur:function(){return t.applyFilterValue()},onKeyPress:function(t){return e.handleKeyPress(t)}}))),!!r.length&&this.renderTable(r),s.createElement(Yn,{state:t.longJsonDialogState}))}},{key:"getFunctionName",value:function(e){var t;return e.Name?e.Name:null!==(t=e.FunctionName)&&void 0!==t?t:""}},{key:"renderEventLink",value:function(e){var t=this.props.state,n=this.getFunctionName(e);return e.SubOrchestrationId?s.createElement(Bn,{orchestrationId:e.SubOrchestrationId,title:n,backendClient:t.backendClient}):t.functionNames[n]?s.createElement(v.a,{className:"link-with-pointer-cursor",color:"dark"===Z.palette.type?"inherit":"primary",onClick:function(){t.gotoFunctionCode(n)}},n):n}},{key:"renderTable",value:function(e){var t=this;return s.createElement(Sn.a,{size:"small"},s.createElement(Nn.a,null,s.createElement(Tn.a,null,xe.map((function(e){return s.createElement(In.a,{key:e},e,["Timestamp","ScheduledTime"].includes(e)&&s.createElement("span",{className:"time-zone-name-span"},"(",t.context.timeZoneName,")"))})))),s.createElement(Dn.a,null,e.map((function(e,n){var a={verticalAlign:"top"};return s.createElement(Tn.a,{key:n},s.createElement(In.a,{style:a},t.context.formatDateTimeString(e.Timestamp)),s.createElement(In.a,{style:a},e.EventType),s.createElement(In.a,{style:a},e.EventId),s.createElement(In.a,{className:"name-cell",style:a},t.renderEventLink(e)),s.createElement(In.a,{style:a},t.context.formatDateTimeString(e.ScheduledTime)),s.createElement(In.a,{className:"long-text-cell",style:a},Yn.renderJson(e.Result,"".concat(e.EventType," / ").concat(t.getFunctionName(e)," / ").concat(xe[5]),t.props.state.longJsonDialogState)),s.createElement(In.a,{className:"long-text-cell",style:a},Yn.renderJson(e.Details,"".concat(e.EventType," / ").concat(t.getFunctionName(e)," / ").concat(xe[6]),t.props.state.longJsonDialogState)))}))))}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.reloadHistory())}}]),n}(s.Component),ba.contextType=U,fa=ya))||fa,qr=Object(p.a)(Ca=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){ra.nodeTypesToHighlight=["orchestrator","entity","activity"],window.addEventListener("resize",n.repositionMetricHints),n.repositionMetricHints()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",n.repositionMetricHints)}},{key:"componentDidUpdate",value:function(){n.repositionMetricHints();var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("orchestrator")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("proxy")))}},{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,s.createElement(jn.a,{className:"link-to-az-func-as-a-graph"},"powered by ",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",variant:"inherit",href:"https://github.com/scale-tone/az-func-as-a-graph"},"az-func-as-a-graph")),!!e.functionsLoaded&&s.createElement(ke.a,{row:!0,className:"settings-group"},s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:this.props.inProgress,checked:e.renderFunctions,onChange:function(t){return e.renderFunctions=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Functions")}),s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:this.props.inProgress,checked:e.renderProxies,onChange:function(t){return e.renderProxies=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Proxies")})),this.renderMetrics(),!!e.diagramSvg&&s.createElement(s.Fragment,null,s.createElement("div",{className:"diagram-div",style:K,dangerouslySetInnerHTML:{__html:Qn(e.diagramSvg)}}),s.createElement(b.a,{variant:"dense"},s.createElement(y.a,{style:{flex:1}}),s.createElement(j.a,{variant:"outlined",color:"default",disabled:this.props.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},s.createElement(Zn.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Copy diagram code to Clipboard")),s.createElement(g.a,{width:20}),s.createElement(Xn,{svg:Qn(e.diagramSvg),fileName:this.props.fileName,inProgress:this.props.inProgress,backendClient:this.props.backendClient}),s.createElement(g.a,{width:20}))))}},{key:"renderMetrics",value:function(){var e=this,t=this.props.state;return Object.keys(t.metrics).map((function(n){var a,r,i,o,l=t.metrics[n],c=(null!==(a=l.completed)&&void 0!==a?a:0)+(null!==(r=l.running)&&void 0!==r?r:0)+(null!==(i=l.failed)&&void 0!==i?i:0)+(null!==(o=l.other)&&void 0!==o?o:0);return s.createElement("span",{id:"metrics-hint-".concat(n.toLowerCase()),key:"metrics-hint-".concat(n),className:"metrics-span"},!!l.completed&&s.createElement(w.a,{title:1===c?"runtimeStatus":"Number of completed instances"},s.createElement(na.a,{className:"metrics-chip",style:e.CompletedStyle,variant:"outlined",size:"small",label:1===c?"completed":"".concat(l.completed)})),!!l.running&&s.createElement(w.a,{title:1===c?"runtimeStatus":"Number of running instances"},s.createElement(na.a,{className:"metrics-chip",style:e.RunningStyle,variant:"outlined",size:"small",label:1===c?"running":"".concat(l.running)})),!!l.failed&&s.createElement(w.a,{title:1===c?"runtimeStatus":"Number of failed instances"},s.createElement(na.a,{className:"metrics-chip",style:e.FailedStyle,variant:"outlined",size:"small",label:1===c?"failed":"".concat(l.failed)})),!!l.other&&s.createElement(w.a,{title:1===c?"runtimeStatus":"Number of terminated/cancelled instances"},s.createElement(na.a,{className:"metrics-chip",style:e.OtherStyle,variant:"outlined",size:"small",label:1===c?"terminated":"".concat(l.other)})),!!l.duration&&s.createElement(w.a,{title:1===c?"Duration":"Max Duration"},s.createElement(na.a,{className:"metrics-chip",style:e.DurationStyle,variant:"outlined",size:"small",label:Je.formatDuration(l.duration)})))}))}}]),n}(ra))||Ca,Zr=Object(p.a)(ja=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.props.state.loadDetails()}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("actor")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("messageText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("task")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskText")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideLeft")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("taskTextOutsideRight")))}},{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,s.createElement(f.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(b.a,{variant:"dense",className:"details-top-toolbar"},"Orchestration"===e.details.entityType&&s.createElement(ka,{state:e,disabled:e.inProgress}),"DurableEntity"===e.details.entityType&&s.createElement(Ea,{state:e,disabled:e.inProgress}),s.createElement(g.a,{width:20}),s.createElement(y.a,{style:{flex:1}}),s.createElement(ve.a,null,s.createElement(Ee.a,{htmlFor:"auto-refresh-select"},"Auto-refresh"),s.createElement(_e.a,{className:"toolbar-select",value:e.autoRefresh,onChange:function(t){return e.autoRefresh=t.target.value},inputProps:{id:"auto-refresh-select"}},s.createElement(N.a,{value:0},"Never"),s.createElement(N.a,{value:1},"Every 1 sec."),s.createElement(N.a,{value:5},"Every 5 sec."),s.createElement(N.a,{value:10},"Every 10 sec."))),s.createElement(g.a,{width:20}),s.createElement(j.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress&&!e.loadInProgress,onClick:function(){return e.loadInProgress?e.cancel():e.loadDetails()}},e.loadInProgress?s.createElement(Pe.a,null):s.createElement(Te.a,null)))),!!e.tabStates.length&&s.createElement(s.Fragment,null,s.createElement(f.a,{color:"inherit",position:"static"},s.createElement(je.a,{className:"tab-buttons",value:e.tabIndex,onChange:function(t,n){"functions-graph-link"!==n&&(e.tabIndex=n)}},s.createElement(we.a,{className:"tab-buttons",disabled:e.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},"Details")}),e.tabStates.map((function(t){return s.createElement(we.a,{className:"tab-buttons",key:t.name,disabled:e.inProgress,label:s.createElement(y.a,{color:"textPrimary",variant:"subtitle2"},t.name)})}))))),!e.tabIndex&&"Orchestration"===e.details.entityType&&s.createElement(s.Fragment,null,s.createElement(Jr,{state:e}),e.inProgress&&e.history.length?s.createElement(be.a,null):s.createElement(g.a,{height:4})),!e.tabIndex&&"DurableEntity"===e.details.entityType&&s.createElement(_a,{details:e.details}),!!e.selectedTab&&e.selectedTab.tabType===ga.FunctionGraph&&s.createElement(qr,{state:e.selectedTab,inProgress:e.inProgress,fileName:e.orchestrationId,backendClient:e.backendClient}),!!e.selectedTab&&e.selectedTab.tabType!==ga.FunctionGraph&&!!e.selectedTab.rawHtml&&s.createElement(s.Fragment,null,s.createElement("div",{className:"raw-html-div",style:K,dangerouslySetInnerHTML:{__html:Qn(e.selectedTab.rawHtml)}}),e.selectedTab.tabType===ga.MermaidDiagram&&s.createElement(b.a,{variant:"dense"},s.createElement(y.a,{style:{flex:1}}),s.createElement(j.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.selectedTab.description)}},s.createElement(Zn.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Copy diagram code to Clipboard")),s.createElement(g.a,{width:20}),s.createElement(Xn,{svg:Qn(e.selectedTab.rawHtml),fileName:e.orchestrationId,inProgress:e.inProgress,backendClient:e.backendClient}),s.createElement(g.a,{width:20}))),s.createElement(Ye,{state:this.props.state}))}},{key:"mountClickEventToFunctionNodes",value:function(e){for(var t=this.props.state,n=0;n<e.length;n++){var a=e[n],r=a.getAttribute("data-function-name");if(!r){r=a.innerHTML;var i=/>(.+)</.exec(r);i&&(r=i[1])}t.functionNames[r]&&function(){var e=r;a.onclick=function(){return t.gotoFunctionCode(e)},a.style.cursor="pointer",a.onmouseenter=function(e){e.target.style.strokeOpacity="0.5"},a.onmouseleave=function(e){e.target.style.strokeOpacity="1"}}()}}}]),n}(s.Component))||ja,Kr=n(390),$r=n.n(Kr),Xr=Object(p.a)(wa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.props.state.load()}},{key:"componentDidUpdate",value:function(){var e=document.getElementById("mermaidSvgId");e&&(this.mountClickEventToFunctionNodes(e.getElementsByClassName("function")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("orchestrator")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("activity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("entity")),this.mountClickEventToFunctionNodes(e.getElementsByClassName("proxy")))}},{key:"render",value:function(){var e=this.props.state;return s.createElement(s.Fragment,null,s.createElement(f.a,{color:"inherit",position:"static",className:"top-appbar"},e.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(b.a,{variant:"dense"},s.createElement(g.a,{width:20}),s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:e.inProgress,checked:e.renderFunctions,onChange:function(t){return e.renderFunctions=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Functions")}),s.createElement(g.a,{width:20}),s.createElement(de.a,{control:s.createElement(Oe.a,{color:"default",disabled:e.inProgress,checked:e.renderProxies,onChange:function(t){return e.renderProxies=t.target.checked}}),label:s.createElement(y.a,{color:"textPrimary"},"Show Proxies")}),s.createElement(g.a,{width:20}),s.createElement(y.a,{style:{flex:1}}),s.createElement(j.a,{className:"details-refresh-button",variant:"outlined",color:"default",size:"large",disabled:e.inProgress,onClick:function(){return e.load()}},s.createElement(Te.a,null)))),s.createElement(jn.a,{className:"link-to-az-func-as-a-graph"},"powered by ",s.createElement(v.a,{color:"dark"===Z.palette.type?"inherit":"primary",variant:"inherit",href:"https://github.com/scale-tone/az-func-as-a-graph"},"az-func-as-a-graph")),!!e.diagramSvg&&s.createElement(s.Fragment,null,s.createElement("div",{className:"diagram-div",style:K,dangerouslySetInnerHTML:{__html:Qn(e.diagramSvg)}}),s.createElement(b.a,{variant:"dense"},s.createElement(j.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:function(){return window.navigator.clipboard.writeText(e.diagramCode)}},s.createElement(Zn.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Copy diagram code to Clipboard")),s.createElement(g.a,{width:20}),s.createElement(Xn,{svg:Qn(e.diagramSvg),fileName:"functions.svg",inProgress:e.inProgress,backendClient:e.backendClient}),s.createElement(g.a,{width:20}),s.createElement(j.a,{variant:"outlined",color:"default",disabled:e.inProgress,onClick:function(){return e.saveAsJson()}},s.createElement($r.a,null),s.createElement(g.a,{width:10}),s.createElement(y.a,{color:"inherit"},"Save as JSON")))),s.createElement(Ye,{state:this.props.state}))}}]),n}(aa))||wa,Qr=n(708),ei=(n(694),Object(p.a)((Ta=Na=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context=void 0,e}return Object(m.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state;return s.createElement(T.a,{open:t.dialogOpen,onClose:function(){t.inProgress||(t.dialogOpen=!1)}},s.createElement(x.a,null,"Purge Instance History"),null===t.instancesDeleted&&s.createElement(s.Fragment,null,s.createElement(I.a,null,t.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(F.a,null,"WARNING: this operation drops instance states from the underlying storage and cannot be undone.","DurableEntity"===t.entityType&&s.createElement(y.a,{color:"error"},"It might as well remove Durable Entities, that are still active. Ensure that you specify the correct time frame! To clean up deleted Entities use the 'Clean Entity Storage' command instead.")),s.createElement(ve.a,{className:"purge-history-apply-to",disabled:t.inProgress,fullWidth:!0},s.createElement(Qr.a,null,"Apply to:"),s.createElement(me.a,{row:!0,value:t.entityType,onChange:function(e){return t.entityType=e.target.value}},s.createElement(de.a,{disabled:t.inProgress,value:"Orchestration",control:s.createElement(he.a,null),label:"Orchestrations"}),s.createElement(de.a,{disabled:t.inProgress,value:"DurableEntity",control:s.createElement(he.a,null),label:"Durable Entities"}))),s.createElement(Se.a,{className:"purge-history-from-input",ampm:!1,autoOk:!0,label:"DurableEntity"===t.entityType?"Last Updated From (".concat(this.context.timeZoneName,")"):"From (".concat(this.context.timeZoneName,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:t.inProgress,value:this.context.getMoment(t.timeFrom),onChange:function(n){return t.timeFrom=e.context.setMoment(n)}}),s.createElement(Se.a,{className:"purge-history-till-input",ampm:!1,autoOk:!0,label:"DurableEntity"===t.entityType?"Last Updated Till (".concat(this.context.timeZoneName,")"):"Till (".concat(this.context.timeZoneName,")"),format:"YYYY-MM-DD HH:mm:ss",variant:"inline",disabled:t.inProgress,value:this.context.getMoment(t.timeTill),onChange:function(n){return t.timeTill=e.context.setMoment(n)}}),s.createElement(ve.a,{disabled:t.inProgress},s.createElement(Qr.a,null,"With the following status:"),"Orchestration"===t.entityType&&s.createElement(ke.a,{row:!0},s.createElement(ti,{state:t,runtimeStatus:"Completed"}),s.createElement(ti,{state:t,runtimeStatus:"Failed"}),s.createElement(ti,{state:t,runtimeStatus:"Terminated"})),"DurableEntity"===t.entityType&&s.createElement(ke.a,{row:!0},s.createElement(w.a,{title:"Durable Entities are always in 'Running' state"},s.createElement(de.a,{control:s.createElement(Oe.a,{checked:!0}),label:"Running",disabled:!0})))),s.createElement(Ye,{state:t})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return t.dialogOpen=!1},disabled:t.inProgress,color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return t.purgeHistory()},disabled:!t.isValid||t.inProgress,color:"secondary"},"Purge"))),null!==t.instancesDeleted&&s.createElement(s.Fragment,null,s.createElement(I.a,null,s.createElement(F.a,{className:"success-message"},t.instancesDeleted," instances were deleted.")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return t.dialogOpen=!1},color:$},"Close"))))}}]),n}(s.Component),Na.contextType=U,Sa=Ta))||Sa),ti=Object(p.a)(Ia=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state,t=this.props.runtimeStatus;return s.createElement(de.a,{control:s.createElement(Oe.a,{checked:e.getStatusIncluded(t),onChange:function(n){return e.setStatusIncluded(t,n.target.checked)}}),label:t})}}]),n}(s.Component))||Ia,ni=(n(695),Object(p.a)(Pa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(T.a,{open:e.dialogOpen,onClose:function(){e.inProgress||(e.dialogOpen=!1)}},s.createElement(x.a,null,"Clean Entity Storage"),!e.response&&s.createElement(s.Fragment,null,s.createElement(I.a,null,e.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(F.a,null,"An entity is considered empty, and is removed, if it has no state, is not locked, and has been idle for more than ",s.createElement("strong",null,"EntityMessageReorderWindowInMinutes"),". Locks are considered orphaned, and are released, if the orchestration that holds them is not in ",s.createElement("strong",null,"Running")," state."),s.createElement(ve.a,{className:"purge-history-statuses",disabled:e.inProgress},s.createElement(ke.a,{row:!0},s.createElement(de.a,{control:s.createElement(Oe.a,{checked:e.removeEmptyEntities,onChange:function(t){return e.removeEmptyEntities=t.target.checked}}),label:"Remove Empty Entities"}),s.createElement(de.a,{control:s.createElement(Oe.a,{checked:e.releaseOrphanedLocks,onChange:function(t){return e.releaseOrphanedLocks=t.target.checked}}),label:"Release Orphaned Locks"}))),s.createElement(Ye,{state:e})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.dialogOpen=!1},disabled:e.inProgress,color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return e.clean()},disabled:!e.isValid||e.inProgress,color:"secondary"},"Clean"))),!!e.response&&s.createElement(s.Fragment,null,s.createElement(I.a,null,s.createElement(F.a,{className:"success-message"},e.response.numberOfEmptyEntitiesRemoved," empty entities removed."),s.createElement(F.a,{className:"success-message"},e.response.numberOfOrphanedLocksRemoved," orphaned locks removed.")),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.dialogOpen=!1},color:$},"Close"))))}}]),n}(s.Component))||Pa),ai=Object(p.a)(Da=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(T.a,{open:e.dialogOpen,onClose:function(){return e.dialogOpen=!1}},s.createElement(x.a,null,"Manage Storage Connection Settings"),s.createElement(I.a,null,e.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(F.a,null,e.isReadonly?"Change the below values via your application settings ('DFM_HUB_NAME' and 'AzureWebJobsStorage' respectively)":"The below values will be saved to local.settings.json file."),s.createElement(E.a,{className:"dialog-text-field",autoFocus:!0,margin:"dense",label:"Hub Name",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:!0},InputLabelProps:{shrink:!0},value:e.hubName,onChange:function(t){return e.hubName=t.target.value}}),s.createElement(E.a,{autoFocus:!0,margin:"dense",label:"Azure Storage Connection String",fullWidth:!0,disabled:e.inProgress,InputProps:{readOnly:e.isReadonly},InputLabelProps:{shrink:!0},value:e.connectionString,onChange:function(t){return e.connectionString=t.target.value}}),s.createElement(Ye,{state:e})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.dialogOpen=!1},color:$},"Cancel"),!e.isReadonly&&s.createElement(j.a,{onClick:function(){return e.saveConnectionParams()},disabled:!e.isDirty||!e.hubName||!e.connectionString||e.inProgress,color:"secondary"},"Save")))}}]),n}(s.Component))||Da,ri=(n(696),Object(p.a)(Fa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this.props.state;return s.createElement(T.a,{open:e.dialogOpen,onClose:function(){return e.dialogOpen=!1}},s.createElement(x.a,null,"Start New Orchestration Instance"),s.createElement(I.a,null,e.inProgress?s.createElement(be.a,null):s.createElement(g.a,{height:4}),s.createElement(E.a,{className:"dialog-text-field",margin:"dense",label:"InstanceId (optional)",fullWidth:!0,disabled:e.inProgress,InputLabelProps:{shrink:!0},value:e.instanceId,onChange:function(t){return e.instanceId=t.target.value}}),s.createElement(E.a,{className:"dialog-text-field",autoFocus:!0,margin:"dense",label:"Orchestrator Function Name",fullWidth:!0,disabled:e.inProgress,InputLabelProps:{shrink:!0},value:e.orchestratorFunctionName,onChange:function(t){return e.orchestratorFunctionName=t.target.value}}),s.createElement(E.a,{margin:"dense",disabled:e.inProgress,InputLabelProps:{shrink:!0},label:"Input (optional JSON)",fullWidth:!0,multiline:!0,rows:10,value:e.input,onChange:function(t){return e.input=t.target.value}}),s.createElement(Ye,{state:e})),s.createElement(Vn.a,null,s.createElement(j.a,{onClick:function(){return e.dialogOpen=!1},color:$},"Cancel"),s.createElement(j.a,{onClick:function(){return e.startNewInstance()},disabled:!e.orchestratorFunctionName,color:"secondary"},"Start")))}}]),n}(s.Component))||Fa),ii=Object(p.a)(xa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){var e=this,t=this.props.state;return s.createElement(_.a,{utils:C.a},s.createElement(U.Provider,{value:J},!t.loginState&&s.createElement(g.a,{height:20}),!!t.loginState&&s.createElement(f.a,{position:"static",color:"default",className:"app-bar"},s.createElement(b.a,null,t.loginState.isLoggedIn&&!!t.mainMenuState&&s.createElement(fe,{state:t.mainMenuState,doRefresh:function(){return t.orchestrationsState.reloadOrchestrations()}}),s.createElement("img",{src:"".concat(DfmRoutePrefix?"/":"").concat(DfmRoutePrefix,"/logo.svg"),width:"30px"}),s.createElement(g.a,{width:5}),s.createElement(y.a,{variant:"h6",color:"inherit",className:"title-typography"},s.createElement(v.a,{color:"inherit",href:t.loginState.rootUri},"Durable Functions Monitor")),s.createElement(O.a,{color:"inherit"},s.createElement(v.a,{color:"inherit",href:t.loginState.locationPathName},"/ ",t.loginState.taskHubName),t.orchestrationDetailsState?s.createElement(y.a,{color:"inherit"},s.createElement(v.a,{color:"inherit",href:window.location.pathname},t.orchestrationDetailsState.orchestrationId)):s.createElement(k.a,{className:"instance-id-input",freeSolo:!0,options:t.isExactMatch?[]:t.suggestions,value:t.typedInstanceId,onChange:function(e,n){t.typedInstanceId=null!==n&&void 0!==n?n:"",n&&t.goto()},renderInput:function(n){return s.createElement(E.a,Object.assign({},n,{className:t.isExactMatch?"instance-id-valid":null,size:"small",label:"instanceId to go to...",variant:"outlined",onChange:function(e){return t.typedInstanceId=e.target.value},onKeyPress:function(t){return e.handleKeyPress(t)}}))}})),s.createElement(y.a,{style:{flex:1}}),s.createElement(ce,{state:t.loginState}))),!!t.orchestrationsState&&(!t.loginState||t.loginState.isLoggedIn)&&s.createElement(Oa,{state:t.orchestrationsState}),!!t.orchestrationDetailsState&&(!t.loginState||t.loginState.isLoggedIn)&&s.createElement(Zr,{state:t.orchestrationDetailsState}),!!t.functionGraphState&&(!t.loginState||t.loginState.isLoggedIn)&&s.createElement(Xr,{state:t.functionGraphState}),s.createElement(ei,{state:t.purgeHistoryDialogState}),s.createElement(ni,{state:t.cleanEntityStorageDialogState}),s.createElement(ri,{state:t.startNewInstanceDialogState}),!!t.connectionParamsDialogState&&s.createElement(ai,{state:t.connectionParamsDialogState})))}},{key:"handleKeyPress",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.props.state.goto())}}]),n}(s.Component))||xa,oi=(Ma=function(){function e(t,n,a,r,i){Object(u.a)(this,e),this._backendClient=t,this._purgeHistoryDialogState=n,this._cleanEntityStorageDialogState=a,this._connectionParamsDialogState=r,this._startNewInstanceDialogState=i,Object(z.a)(this,"menuAnchorElement",La,this)}return Object(m.a)(e,[{key:"showConnectionParamsDialog",value:function(){this.menuAnchorElement=void 0,this._connectionParamsDialogState.dialogOpen=!0}},{key:"showPurgeHistoryDialog",value:function(){this.menuAnchorElement=void 0,this._purgeHistoryDialogState.dialogOpen=!0}},{key:"showCleanEntityStorageDialog",value:function(){this.menuAnchorElement=void 0,this._cleanEntityStorageDialogState.dialogOpen=!0}},{key:"showStartNewInstanceDialog",value:function(){this.menuAnchorElement=void 0,this._startNewInstanceDialogState.dialogOpen=!0}},{key:"setWindowTitle",value:function(){this._backendClient.call("GET","/about").then((function(e){document.title="Durable Functions Monitor (".concat(e.accountName,"/").concat(e.hubName,") v").concat(e.version)}))}}]),e}(),La=Object(B.a)(Ma.prototype,"menuAnchorElement",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma),si=(Ra=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._loadHistory=e,a.name="Diagram",a.tabType=ga.MermaidDiagram,a}return Object(m.a)(n,[{key:"description",get:function(){return this._diagramCode}},{key:"rawHtml",get:function(){return this._diagramSvg}},{key:"load",value:function(e,t){var n=this;return this.initMermaidWhenNeeded(),this._loadHistory(e.instanceId).then((function(a){if(a.length&&!t.isCancelled)return n.buildDiagram(e,a,t)}))}}]),n}(jt),Object(B.a)(Ra.prototype,"description",[W.e],Object.getOwnPropertyDescriptor(Ra.prototype,"description"),Ra.prototype),Object(B.a)(Ra.prototype,"rawHtml",[W.e],Object.getOwnPropertyDescriptor(Ra.prototype,"rawHtml"),Ra.prototype),Ra),li=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="Sequence Diagram",e}return Object(m.a)(n,[{key:"buildDiagram",value:function(e,t,n){var a=this;return new Promise((function(r,i){Promise.all(a.getSequenceForOrchestration(e.name,".","Failed"===e.runtimeStatus,t)).then((function(e){if(n.isCancelled)r();else{a._diagramCode="sequenceDiagram \n"+e.join("");try{a._diagramSvg="",Ct.a.render("mermaidSvgId",a._diagramCode,(function(e){a._diagramSvg=e,r()}))}catch(t){i(t)}}}),i)}))}},{key:"getSequenceForOrchestration",value:function(e,t,n,a){for(var r,i=this,o=".",s=[],l=0;l<a.length;){var c,u,m=a[l];!function(){switch(m.EventType){case"ExecutionStarted":r="".concat(t,"->>+").concat(e,":[ExecutionStarted] \n")+"Note over ".concat(t,",").concat(e,": ").concat(i.formatTimestamp(m.Timestamp)," \n"),s.push(Promise.resolve(r));break;case"SubOrchestrationInstanceCompleted":case"SubOrchestrationInstanceFailed":var d="SubOrchestrationInstanceFailed"===m.EventType;if(m.SubOrchestrationId){var h=m.SubOrchestrationId,p=m.FunctionName;s.push(new Promise((function(t,n){i._loadHistory(h).then((function(a){Promise.all(i.getSequenceForOrchestration(p,e,d,a)).then((function(e){t(e.join(""))}),n)}),(function(n){console.log("Failed to load ".concat(p,". ").concat(n.message)),t("".concat(e,"-x").concat(p,":[FailedToLoad] \n"))}))})))}else d?(r="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(m.FunctionName,":[SubOrchestrationInstanceFailed] \n")+"end \n",s.push(Promise.resolve(r))):(r="".concat(e,"->>+").concat(m.FunctionName,":[SubOrchestrationInstanceStarted] \n"),s.push(Promise.resolve(r)));break;case"TaskCompleted":for(c=m.DurationInMs,u=l+1;u<a.length&&"TaskCompleted"===a[u].EventType&&a[u].FunctionName===m.FunctionName&&a[u].ScheduledTime.substr(0,23)===m.ScheduledTime.substr(0,23);u++)c<a[u].DurationInMs&&(c=a[u].DurationInMs);if(u===l+1){var g="".concat(e,"->>").concat(e,":").concat(m.FunctionName," \n")+"Note over ".concat(e,": ").concat(i.formatDuration(m.DurationInMs)," \n");s.push(Promise.resolve(g))}else{var f="par ".concat(u-l," calls \n")+"".concat(e,"->>").concat(e,":").concat(m.FunctionName," \n")+"Note over ".concat(e,": ").concat(i.formatDuration(c)," \n")+"end \n";s.push(Promise.resolve(f)),l=u-1}break;case"TaskFailed":r="rect rgba(255,0,0,0.4) \n"+"".concat(e,"-x").concat(e,":").concat(m.FunctionName," \n")+"end \n",s.push(Promise.resolve(r));break;case"EventRaised":r="".concat(o,"->>").concat(e,":").concat(m.Name," \n")+"Note over ".concat(o,",").concat(e,": ").concat(i.formatTimestamp(m.Timestamp)," \n"),s.push(Promise.resolve(r));break;case"TimerFired":r="".concat(o,"->>").concat(e,":[TimerFired] \n")+"Note over ".concat(o,",").concat(e,": ").concat(i.formatTimestamp(m.Timestamp)," \n"),s.push(Promise.resolve(r));break;case"ExecutionTerminated":r="".concat(o,"->>").concat(e,":[ExecutionTerminated] \n")+"Note over ".concat(o,",").concat(e,": ").concat(i.formatTimestamp(m.Timestamp)," \n"),s.push(Promise.resolve(r));break;case"ExecutionCompleted":r="".concat(e,"--\x3e>-").concat(t,":[").concat(n?"ExecutionFailed":"ExecutionCompleted","] \n")+"Note over ".concat(e,",").concat(t,": ").concat(i.formatDuration(m.DurationInMs)," \n"),n&&(r="rect rgba(255,0,0,0.4) \n"+r+"end \n"),s.push(Promise.resolve(r))}}(),l++}return s}},{key:"formatTimestamp",value:function(e){return e.length<=11?e:J.showTimeAsLocal?Y()(e).format("(HH:mm:ss.SSS)"):"("+e.substr(11,12)+"Z)"}}]),n}(si),ci=(Ha=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e,a,r){var i;return Object(u.a)(this,n),(i=t.call(this,e))._loadHistory=r,i.name="Functions Graph",i.tabType=ga.FunctionGraph,Object(z.a)(i,"_metrics",Aa,Object(Ue.a)(i)),i._traversalResult=a,i}return Object(m.a)(n,[{key:"description",get:function(){return this._diagramCode}},{key:"rawHtml",get:function(){return this._diagramSvg}},{key:"renderFunctions",get:function(){return this._renderFunctions},set:function(e){this._renderFunctions=e,this.render()}},{key:"renderProxies",get:function(){return this._renderProxies},set:function(e){this._renderProxies=e,this.render()}},{key:"metrics",get:function(){return this._metrics}},{key:"load",value:function(e,t){var n=this;this.initMermaidWhenNeeded();var a={};return this.render().then((function(){return n._loadHistory(e.instanceId).then((function(r){if(!t.isCancelled)return n.updateMetricsForInstance(a,Le.getFunctionName(e),e.runtimeStatus,new Date(e.lastUpdatedTime).getTime()-new Date(e.createdTime).getTime(),r,t).then((function(){n._metrics=a}))}))}))}},{key:"updateMetricsForInstance",value:function(e,t,n,a,r,i){var o=this;switch(e[t]||(e[t]=new nn),n){case"Completed":e[t].completed++;break;case"Running":case"Pending":case"ContinuedAsNew":e[t].running++;break;case"Failed":e[t].failed++;break;default:e[t].other++}e[t].duration<a&&(e[t].duration=a);var s,l=[],c=Object(Ge.a)(r);try{var u=function(){var t,n=null!==(t=(m=s.value).FunctionName)&&void 0!==t?t:m.Name;switch(m.EventType){case"SubOrchestrationInstanceCreated":m.SubOrchestrationId&&l.push(o._loadHistory(m.SubOrchestrationId).then((function(t){if(!i.isCancelled)return o.updateMetricsForInstance(e,n,"Running",0,t,i)})));break;case"SubOrchestrationInstanceCompleted":if(m.SubOrchestrationId){var a=new Date(m.Timestamp).getTime()-new Date(m.ScheduledTime).getTime();l.push(o._loadHistory(m.SubOrchestrationId).then((function(t){if(!i.isCancelled)return o.updateMetricsForInstance(e,n,"Completed",a,t,i)})))}break;case"SubOrchestrationInstanceFailed":if(m.SubOrchestrationId){var r=new Date(m.Timestamp).getTime()-new Date(m.ScheduledTime).getTime();l.push(o._loadHistory(m.SubOrchestrationId).then((function(t){if(!i.isCancelled)return o.updateMetricsForInstance(e,n,"Failed",r,t,i)})))}break;case"TaskCompleted":e[n]||(e[n]=new nn),e[n].completed++,e[n].duration<m.DurationInMs&&(e[m.FunctionName].duration=m.DurationInMs);break;case"TaskFailed":e[n]||(e[n]=new nn),e[n].failed++,e[n].duration<m.DurationInMs&&(e[n].duration=m.DurationInMs);break;case"TaskScheduled":e[n]||(e[n]=new nn),e[n].running++}};for(c.s();!(s=c.n()).done;){var m;u()}}catch(d){c.e(d)}finally{c.f()}return Promise.all(l)}},{key:"render",value:function(){var e=this;return this._diagramCode="",this._diagramSvg="",new Promise((function(t,n){try{var a=Ft(e._traversalResult.functions,e._traversalResult.proxies,{doNotRenderFunctions:!e._renderFunctions,doNotRenderProxies:!e._renderProxies});if(!a)return void t();e._diagramCode="graph LR\n".concat(a),Ct.a.render("mermaidSvgId",e._diagramCode,(function(n){e._diagramSvg=e.applyIcons(n),t()}))}catch(r){n(r)}}))}}]),n}(Nt),Object(B.a)(Ha.prototype,"description",[W.e],Object.getOwnPropertyDescriptor(Ha.prototype,"description"),Ha.prototype),Object(B.a)(Ha.prototype,"rawHtml",[W.e],Object.getOwnPropertyDescriptor(Ha.prototype,"rawHtml"),Ha.prototype),Object(B.a)(Ha.prototype,"renderFunctions",[W.e],Object.getOwnPropertyDescriptor(Ha.prototype,"renderFunctions"),Ha.prototype),Object(B.a)(Ha.prototype,"renderProxies",[W.e],Object.getOwnPropertyDescriptor(Ha.prototype,"renderProxies"),Ha.prototype),Object(B.a)(Ha.prototype,"metrics",[W.e],Object.getOwnPropertyDescriptor(Ha.prototype,"metrics"),Ha.prototype),Aa=Object(B.a)(Ha.prototype,"_metrics",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Ha),ui=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).name="Gantt Chart",e}return Object(m.a)(n,[{key:"buildDiagram",value:function(e,t,n){var a=this;return new Promise((function(r,i){Promise.all(a.renderOrchestration(e.instanceId,e.name,t,!0)).then((function(t){if(n.isCancelled)r();else{var o=t.flat(),s=o.filter((function(e){return!!e.functionName}));a._diagramCode="gantt \n"+"title ".concat(e.name,"(").concat(e.instanceId,") \n")+"dateFormat YYYY-MM-DDTHH:mm:ss.SSS \n"+o.map((function(e){return e.nextLine})).join(""),a._diagramSvg="";try{Ct.a.render("mermaidSvgId",a._diagramCode,(function(e){e=a.injectFunctionNameAttributes(e,s),e=a.adjustIntervalsSmallerThanOneSecond(e,s),a._diagramSvg=e,r()}))}catch(l){i(l)}}}),i)}))}},{key:"injectFunctionNameAttributes",value:function(e,t){return e.replace(new RegExp('<(rect|text) id="task([0-9]+)(-text)?"',"gi"),(function(e,n,a){var r=parseInt(a);if(r<=0||r>t.length)return e;var i=t[r-1];return i.functionName?e+' data-function-name="'.concat(i.functionName,'"'):e}))}},{key:"adjustIntervalsSmallerThanOneSecond",value:function(e,t){return e.replace(new RegExp('<rect id="task([0-9]+)" [^>]+ width="([0-9]+)"',"gi"),(function(n,a,r){var i=parseInt(a);if(i<=0||i>t.length)return n;var o=t[i-1];if(!o.parentInstanceId||!o.widthPercentage||o.duration>1e4)return n;var s=t.findIndex((function(e){return e.instanceId===o.parentInstanceId}));if(s<0)return n;var l=new RegExp('<rect id="task'.concat(s+1,'" [^>]+ width="([0-9]+)"'),"i").exec(e);if(!l)return n;var c=parseInt(l[1]),u=o.widthPercentage>1?c:Math.ceil(c*o.widthPercentage);return n.replace('width="'.concat(r,'"'),'width="'.concat(u.toFixed(0),'"'))}))}},{key:"renderOrchestration",value:function(e,t,n,a){var r,i=this,o=[],s=n.find((function(e){return"ExecutionStarted"===e.EventType})),l=n.find((function(e){return"ExecutionCompleted"===e.EventType})),c=a,u=0;if(s&&l){if(c){var m=l.DurationInMs>864e5;r=m?"axisFormat %Y-%m-%d %H:%M \n":"axisFormat %H:%M:%S \n",o.push(Promise.resolve([{nextLine:r}])),c=!1}r=a?"":"section ".concat(t,"(").concat(this.escapeTitle(e),") \n");var d=this.formatDuration(l.DurationInMs);d||(d=this.formatLineName(t)),r+="".concat(d,": ").concat(a?"":"active,"," ").concat(this.formatDateTime(s.Timestamp),", ").concat(this.formatDurationInSeconds(l.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:t,instanceId:e}])),u=l.DurationInMs}c&&(r="axisFormat %H:%M:%S \n",o.push(Promise.resolve([{nextLine:r}])));var h,p=Object(Ge.a)(n);try{for(p.s();!(h=p.n()).done;){var g=h.value,f=g.ScheduledTime;switch(s&&Date.parse(f)<Date.parse(s.Timestamp)&&(f=s.Timestamp),g.EventType){case"SubOrchestrationInstanceCompleted":case"SubOrchestrationInstanceFailed":g.SubOrchestrationId&&function(){var n=g.SubOrchestrationId,a=g.FunctionName;o.push(new Promise((function(e,t){i._loadHistory(n).then((function(r){Promise.all(i.renderOrchestration(n,a,r,!1)).then((function(t){e(t.flat())}),t)}),(function(t){console.log("Failed to load ".concat(a,". ").concat(t.message)),e([{nextLine:"%% Failed to load ".concat(i.formatLineName(a),". ").concat(t.message," \n")}])}))}))),r="section ".concat(t,"(").concat(i.escapeTitle(e),") \n"),o.push(Promise.resolve([{nextLine:r}]))}();break;case"TaskCompleted":r="".concat(this.formatLineName(g.FunctionName)," ").concat(this.formatDuration(g.DurationInMs),": done, ").concat(this.formatDateTime(f),", ").concat(this.formatDurationInSeconds(g.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:g.FunctionName,parentInstanceId:e,duration:g.DurationInMs,widthPercentage:u?g.DurationInMs/u:0}]));break;case"TaskFailed":r="".concat(this.formatLineName(g.FunctionName)," ").concat(this.formatDuration(g.DurationInMs),": crit, ").concat(this.formatDateTime(f),", ").concat(this.formatDurationInSeconds(g.DurationInMs)," \n"),o.push(Promise.resolve([{nextLine:r,functionName:g.FunctionName,parentInstanceId:e,duration:g.DurationInMs,widthPercentage:u?g.DurationInMs/u:0}]));break;case"TimerFired":r="[TimerFired]: done, ".concat(this.formatDateTime(g.Timestamp),", 1s \n"),o.push(Promise.resolve([{nextLine:r,functionName:t,parentInstanceId:e,duration:1,widthPercentage:1e-4}]))}}}catch(b){p.e(b)}finally{p.f()}return o}},{key:"formatDateTime",value:function(e){return J.showTimeAsLocal?Y()(e).format("YYYY-MM-DDTHH:mm:ss.SSS"):e.substr(0,23)}},{key:"formatLineName",value:function(e){return e.replace(/:/g,"-")}}]),n}(si),mi=(za=function(){function e(t,n){Object(u.a)(this,e),this._orchestrationId=t,this._backendClient=n,this.name="",this.description="",this.tabType=ga.RawHtml,Object(z.a)(this,"_rawHtml",Ba,this)}return Object(m.a)(e,[{key:"rawHtml",get:function(){return this._rawHtml}},{key:"load",value:function(e,t){var n=this,a="/orchestrations('".concat(this._orchestrationId,"')/custom-tab-markup('").concat(this.name,"')");return this._backendClient.call("POST",a).then((function(e){t.isCancelled||(n._rawHtml=e)}))}}]),e}(),Object(B.a)(za.prototype,"rawHtml",[W.e],Object.getOwnPropertyDescriptor(za.prototype,"rawHtml"),za.prototype),Ba=Object(B.a)(za.prototype,"_rawHtml",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za),di=(Wa=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e,a,r,i){var o;Object(u.a)(this,n),(o=t.call(this))._orchestrationId=e,o._isFunctionGraphAvailable=a,o._backendClient=r,o._localStorage=i,Object(z.a)(o,"rewindConfirmationOpen",Va,Object(Ue.a)(o)),Object(z.a)(o,"terminateConfirmationOpen",Ya,Object(Ue.a)(o)),Object(z.a)(o,"purgeConfirmationOpen",Ga,Object(Ue.a)(o)),Object(z.a)(o,"eventName",Ua,Object(Ue.a)(o)),Object(z.a)(o,"eventData",Ja,Object(Ue.a)(o)),Object(z.a)(o,"newCustomStatus",qa,Object(Ue.a)(o)),Object(z.a)(o,"restartWithNewInstanceId",Za,Object(Ue.a)(o)),Object(z.a)(o,"longJsonDialogState",Ka,Object(Ue.a)(o)),Object(z.a)(o,"_tabStates",$a,Object(Ue.a)(o)),Object(z.a)(o,"_details",Xa,Object(Ue.a)(o)),Object(z.a)(o,"_history",Qa,Object(Ue.a)(o)),Object(z.a)(o,"_tabIndex",er,Object(Ue.a)(o)),Object(z.a)(o,"_inProgress",tr,Object(Ue.a)(o)),Object(z.a)(o,"_cancelToken",nr,Object(Ue.a)(o)),Object(z.a)(o,"_raiseEventDialogOpen",ar,Object(Ue.a)(o)),Object(z.a)(o,"_setCustomStatusDialogOpen",rr,Object(Ue.a)(o)),Object(z.a)(o,"_restartDialogOpen",ir,Object(Ue.a)(o)),Object(z.a)(o,"_autoRefresh",or,Object(Ue.a)(o)),Object(z.a)(o,"_historyTotalCount",sr,Object(Ue.a)(o)),Object(z.a)(o,"_functionMap",lr,Object(Ue.a)(o)),Object(z.a)(o,"_filterValue",cr,Object(Ue.a)(o)),Object(z.a)(o,"_filterOperator",ur,Object(Ue.a)(o)),Object(z.a)(o,"_filteredColumn",mr,Object(Ue.a)(o)),o._oldFilterValue="",o._autoRefreshToken=void 0,o._noMorePagesToLoad=!1,o._pageSize=200;var s=o._localStorage.getItem("autoRefresh");s&&(o._autoRefresh=Number(s));var l=o._localStorage.getItem("tabIndex");l&&(o._tabIndex=Number(l));var c=o._localStorage.getItem("filteredColumn");c&&(o._filteredColumn=c);var m=o._localStorage.getItem("filterOperator");m&&(o._filterOperator=zt[m]);var d=o._localStorage.getItem("filterValue");return d&&(o._filterValue=d,o._oldFilterValue=d),o}return Object(m.a)(n,[{key:"tabIndex",get:function(){return this._tabIndex},set:function(e){this._tabIndex!==e&&(this._tabIndex=e,this._localStorage.setItem("tabIndex",e.toString()),this.selectedTab?this.loadCustomTab():this._history.length||this.loadHistory())}},{key:"selectedTab",get:function(){return this._tabIndex?this._tabStates[this._tabIndex-1]:null}},{key:"details",get:function(){return this._details}},{key:"history",get:function(){return this._history}},{key:"historyTotalCount",get:function(){return this._historyTotalCount}},{key:"orchestrationId",get:function(){return this._orchestrationId}},{key:"loadInProgress",get:function(){return this._cancelToken.inProgress&&!this._cancelToken.isCancelled}},{key:"inProgress",get:function(){return this._inProgress||this.loadInProgress}},{key:"autoRefresh",get:function(){return this._autoRefresh},set:function(e){this._autoRefresh=e,this._localStorage.setItem("autoRefresh",this._autoRefresh.toString()),this.loadDetails()}},{key:"raiseEventDialogOpen",get:function(){return this._raiseEventDialogOpen},set:function(e){this._raiseEventDialogOpen=e,e&&(this.eventName="",this.eventData="")}},{key:"setCustomStatusDialogOpen",get:function(){return this._setCustomStatusDialogOpen},set:function(e){this._setCustomStatusDialogOpen=e,e&&(this.newCustomStatus=this._details.customStatus?JSON.stringify(this._details.customStatus):"")}},{key:"restartDialogOpen",get:function(){return this._restartDialogOpen},set:function(e){this._restartDialogOpen=e,e&&(this.restartWithNewInstanceId=!0)}},{key:"isCustomStatusDirty",get:function(){return this._details.customStatus?this.newCustomStatus!==JSON.stringify(this._details.customStatus):!!this.newCustomStatus}},{key:"functionNames",get:function(){return this._functionMap}},{key:"filterValue",get:function(){return this._filterValue},set:function(e){this._filterValue=e}},{key:"filterOperator",get:function(){return this._filterOperator},set:function(e){this._filterOperator=e,this._filterValue&&"0"!==this._filteredColumn&&this.reloadHistory()}},{key:"filteredColumn",get:function(){return this._filteredColumn},set:function(e){this._filteredColumn=e,this._filterValue&&("0"===this._filteredColumn&&(this._filterValue=""),this.reloadHistory())}},{key:"tabStates",get:function(){return this._tabStates}},{key:"backendClient",get:function(){return this._backendClient}},{key:"rewind",value:function(){var e=this;this.rewindConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/rewind");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.showError("Failed to rewind",t)}))}},{key:"terminate",value:function(){var e=this;this.terminateConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/terminate");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.showError("Failed to terminate",t)}))}},{key:"purge",value:function(){var e=this;this.purgeConfirmationOpen=!1;var t="/orchestrations('".concat(this._orchestrationId,"')/purge");this._inProgress=!0,this._backendClient.call("POST",t).then((function(){e._inProgress=!1,e._history=[],e._details=new Le,e._tabStates=[]}),(function(t){e._inProgress=!1,e.showError("Failed to purge",t)}))}},{key:"restart",value:function(){var e=this,t="/orchestrations('".concat(this._orchestrationId,"')/restart"),n={restartWithNewInstanceId:this.restartWithNewInstanceId};this.restartDialogOpen=!1,this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.showError("Failed to restart",t)}))}},{key:"raiseEvent",value:function(){var e=this,t="/orchestrations('".concat(this._orchestrationId,"')/raise-event"),n={name:this.eventName,data:null};try{n.data=JSON.parse(this.eventData)}catch(a){return void this.showError("Failed to parse event data",a)}finally{this.raiseEventDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.showError("Failed to raise an event",t)}))}},{key:"setCustomStatus",value:function(){var e=this,t="/orchestrations('".concat(this._orchestrationId,"')/set-custom-status"),n=null;try{this.newCustomStatus&&(n=JSON.parse(this.newCustomStatus))}catch(a){return void this.showError("Failed to parse custom status",a)}finally{this.setCustomStatusDialogOpen=!1}this._inProgress=!0,this._backendClient.call("POST",t,n).then((function(){e._inProgress=!1,e.loadDetails()}),(function(t){e._inProgress=!1,e.showError("Failed to set custom status",t)}))}},{key:"loadDetails",value:function(){var e=this;if(!this.inProgress){this._inProgress=!0,this._noMorePagesToLoad=!1,this._autoRefresh||this.selectedTab||(this._history=[],this._historyTotalCount=0);var t=this._isFunctionGraphAvailable?this._backendClient.call("GET","/function-map"):Promise.resolve(null),n="/orchestrations('".concat(this._orchestrationId,"')");return Promise.all([this._backendClient.call("GET",n),t]).then((function(t){e._details=t[0];var n=t[1];e.setAutoRefresh();var a=0;if("Orchestration"===e._details.entityType&&(e._tabStates.length<=a&&(e._tabStates.push(new li((function(t){return e.loadAllHistory(t)}))),e._tabStates.push(new ui((function(t){return e.loadAllHistory(t)})))),a+=2),n){e._functionMap=n.functions;var r=Le.getFunctionName(e._details);Object.keys(n.functions).map((function(e){return e.toLowerCase()})).includes(r.toLowerCase())&&(e._tabStates.length<=a&&e._tabStates.push(new ci(e._backendClient,n,(function(t){return e.loadAllHistory(t)}))),a++)}if(e._details.tabTemplateNames){var i,o=Object(Ge.a)(e._details.tabTemplateNames);try{for(o.s();!(i=o.n()).done;){var s=i.value;e._tabStates.length<=a&&e._tabStates.push(new mi(e._orchestrationId,e._backendClient)),e._tabStates[a].name=s,a++}}catch(l){o.e(l)}finally{o.f()}}(e._tabIndex<0||e._tabIndex>e._tabStates.length)&&(e._tabIndex=0),e._inProgress=!1,e.selectedTab?e.loadCustomTab():e.loadHistory(!!e._autoRefresh)}),(function(t){e._inProgress=!1,e._autoRefresh=0,e.showError("Load failed",t)}))}this.setAutoRefresh()}},{key:"cancel",value:function(){this._cancelToken.isCancelled=!0,this._cancelToken=new Ot}},{key:"reloadHistory",value:function(){this.inProgress||this.selectedTab||(this._localStorage.setItems([{fieldName:"filteredColumn",value:this._filteredColumn},{fieldName:"filterOperator",value:zt[this._filterOperator]},{fieldName:"filterValue",value:this._filterValue?this._filterValue:null}]),this._noMorePagesToLoad=!1,this._history=[],this._historyTotalCount=0,this.loadHistory(),this._oldFilterValue=this._filterValue)}},{key:"loadHistory",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(this.inProgress||this.selectedTab||this._noMorePagesToLoad)){var n=this._cancelToken;n.inProgress=!0;var a=t?0:this._history.length,r="/orchestrations('".concat(this._orchestrationId,"')/history?$top=").concat(this._pageSize,"&$skip=").concat(a),i=on(this._filteredColumn,this._filterOperator,this._filterValue);i&&(r+="&$filter="+i),this._backendClient.call("GET",r).then((function(a){var r;n.isCancelled||(e._historyTotalCount=a.totalCount,t?e._history=a.history:((r=e._history).push.apply(r,Object(Et.a)(a.history)),a.history.length<e._pageSize&&(e._noMorePagesToLoad=!0)))}),(function(t){e._autoRefresh=0,n.isCancelled||e.showError("Failed to load history",t)})).finally((function(){n.inProgress=!1}))}}},{key:"gotoFunctionCode",value:function(e){if(this.backendClient.isVsCode)this.backendClient.call("GotoFunctionCode",e).then((function(){}),(function(e){console.log("Failed to goto function code: ".concat(e.message))}));else{var t=this._functionMap[e];t&&t.filePath&&window.open(t.filePath)}}},{key:"showFunctionsGraph",value:function(){this.backendClient.call("VisualizeFunctionsAsAGraph","").then((function(){}),(function(e){console.log("Failed to goto functions graph: ".concat(e.message))}))}},{key:"applyFilterValue",value:function(){this._oldFilterValue!==this._filterValue&&this.reloadHistory()}},{key:"loadCustomTab",value:function(){var e=this;if(!this.inProgress){var t=this._cancelToken;t.inProgress=!0,this.selectedTab.load(this._details,t).then((function(){}),(function(n){e._autoRefresh=0,t.isCancelled||e.showError("Failed to load tab",n)})).finally((function(){t.inProgress=!1}))}}},{key:"setAutoRefresh",value:function(){var e=this;this._autoRefresh&&(this._autoRefreshToken&&clearTimeout(this._autoRefreshToken),this._autoRefreshToken=setTimeout((function(){return e.loadDetails()}),1e3*this._autoRefresh))}},{key:"loadAllHistory",value:function(e){var t="/orchestrations('".concat(e,"')/history");return this._backendClient.call("GET",t).then((function(e){return e.history}))}}]),n}(vt),Object(B.a)(Wa.prototype,"tabIndex",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"tabIndex"),Wa.prototype),Object(B.a)(Wa.prototype,"details",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"details"),Wa.prototype),Object(B.a)(Wa.prototype,"history",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"history"),Wa.prototype),Object(B.a)(Wa.prototype,"historyTotalCount",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"historyTotalCount"),Wa.prototype),Object(B.a)(Wa.prototype,"orchestrationId",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"orchestrationId"),Wa.prototype),Object(B.a)(Wa.prototype,"loadInProgress",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"loadInProgress"),Wa.prototype),Object(B.a)(Wa.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"inProgress"),Wa.prototype),Object(B.a)(Wa.prototype,"autoRefresh",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"autoRefresh"),Wa.prototype),Object(B.a)(Wa.prototype,"raiseEventDialogOpen",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"raiseEventDialogOpen"),Wa.prototype),Object(B.a)(Wa.prototype,"setCustomStatusDialogOpen",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"setCustomStatusDialogOpen"),Wa.prototype),Object(B.a)(Wa.prototype,"restartDialogOpen",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"restartDialogOpen"),Wa.prototype),Object(B.a)(Wa.prototype,"isCustomStatusDirty",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"isCustomStatusDirty"),Wa.prototype),Object(B.a)(Wa.prototype,"functionNames",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"functionNames"),Wa.prototype),Object(B.a)(Wa.prototype,"filterValue",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"filterValue"),Wa.prototype),Object(B.a)(Wa.prototype,"filterOperator",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"filterOperator"),Wa.prototype),Object(B.a)(Wa.prototype,"filteredColumn",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"filteredColumn"),Wa.prototype),Va=Object(B.a)(Wa.prototype,"rewindConfirmationOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ya=Object(B.a)(Wa.prototype,"terminateConfirmationOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ga=Object(B.a)(Wa.prototype,"purgeConfirmationOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ua=Object(B.a)(Wa.prototype,"eventName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ja=Object(B.a)(Wa.prototype,"eventData",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qa=Object(B.a)(Wa.prototype,"newCustomStatus",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Za=Object(B.a)(Wa.prototype,"restartWithNewInstanceId",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Ka=Object(B.a)(Wa.prototype,"longJsonDialogState",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),Object(B.a)(Wa.prototype,"tabStates",[W.e],Object.getOwnPropertyDescriptor(Wa.prototype,"tabStates"),Wa.prototype),$a=Object(B.a)(Wa.prototype,"_tabStates",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Xa=Object(B.a)(Wa.prototype,"_details",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Le}}),Qa=Object(B.a)(Wa.prototype,"_history",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),er=Object(B.a)(Wa.prototype,"_tabIndex",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),tr=Object(B.a)(Wa.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),nr=Object(B.a)(Wa.prototype,"_cancelToken",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ot}}),ar=Object(B.a)(Wa.prototype,"_raiseEventDialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rr=Object(B.a)(Wa.prototype,"_setCustomStatusDialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ir=Object(B.a)(Wa.prototype,"_restartDialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),or=Object(B.a)(Wa.prototype,"_autoRefresh",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),sr=Object(B.a)(Wa.prototype,"_historyTotalCount",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lr=Object(B.a)(Wa.prototype,"_functionMap",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),cr=Object(B.a)(Wa.prototype,"_filterValue",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ur=Object(B.a)(Wa.prototype,"_filterOperator",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return zt.Equals}}),mr=Object(B.a)(Wa.prototype,"_filteredColumn",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"0"}}),Wa),hi=(gr=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r)),Object(z.a)(e,"errorMessage",hr,Object(Ue.a)(e)),Object(z.a)(e,"_inProgress",pr,Object(Ue.a)(e)),e}return Object(m.a)(n,[{key:"inProgress",get:function(){return this._inProgress}},{key:"functionsLoaded",get:function(){return!!this._traversalResult}},{key:"renderFunctions",get:function(){return this._renderFunctions},set:function(e){this._renderFunctions=e,this.render()}},{key:"renderProxies",get:function(){return this._renderProxies},set:function(e){this._renderProxies=e,this.render()}},{key:"render",value:function(){var e=this;if(this._diagramCode="",this._diagramSvg="",this.errorMessage="",this._traversalResult){this._inProgress=!0;try{var t=Ft(this._traversalResult.functions,this._traversalResult.proxies,{doNotRenderFunctions:!this._renderFunctions,doNotRenderProxies:!this._renderProxies});if(!t)return void(this._inProgress=!1);this._diagramCode="graph LR\n".concat(t),Ct.a.render("mermaidSvgId",this._diagramCode,(function(t){e._diagramSvg=e.applyIcons(t),e._inProgress=!1}))}catch(n){this.errorMessage="Failed to render: ".concat(n.message),this._inProgress=!1}}}},{key:"load",value:function(){var e=this;this._inProgress||(this.initMermaidWhenNeeded(),this._inProgress=!0,this.errorMessage="",this._diagramCode="",this._diagramSvg="",this._traversalResult=null,this._backendClient.call("GET","/function-map").then((function(t){e._traversalResult=t,e.render()}),(function(t){e._inProgress=!1,e.errorMessage="Failed to traverse. ".concat(t.response?t.response.data:t.message)})))}}]),n}(Nt),dr=gr,hr=Object(B.a)(dr.prototype,"errorMessage",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(B.a)(dr.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(dr.prototype,"inProgress"),dr.prototype),Object(B.a)(dr.prototype,"functionsLoaded",[W.e],Object.getOwnPropertyDescriptor(dr.prototype,"functionsLoaded"),dr.prototype),Object(B.a)(dr.prototype,"renderFunctions",[W.e],Object.getOwnPropertyDescriptor(dr.prototype,"renderFunctions"),dr.prototype),Object(B.a)(dr.prototype,"renderProxies",[W.e],Object.getOwnPropertyDescriptor(dr.prototype,"renderProxies"),dr.prototype),pr=Object(B.a)(dr.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),dr),pi=(fr=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,Object(z.a)(a,"timeFrom",br,Object(Ue.a)(a)),Object(z.a)(a,"timeTill",yr,Object(Ue.a)(a)),Object(z.a)(a,"entityType",vr,Object(Ue.a)(a)),Object(z.a)(a,"_statuses",Or,Object(Ue.a)(a)),Object(z.a)(a,"_dialogOpen",Er,Object(Ue.a)(a)),Object(z.a)(a,"_inProgress",_r,Object(Ue.a)(a)),Object(z.a)(a,"_instancesDeleted",kr,Object(Ue.a)(a)),a}return Object(m.a)(n,[{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){this._dialogOpen=e,e&&(this._instancesDeleted=null,this.timeFrom=Y()().subtract(1,"days").utc(),this.timeTill=Y()().utc(),this._statuses=new Set(["Completed","Terminated"]),this.entityType="Orchestration")}},{key:"instancesDeleted",get:function(){return this._instancesDeleted}},{key:"inProgress",get:function(){return this._inProgress}},{key:"isValid",get:function(){return this._statuses.size>0&&Je.isValidMoment(this.timeFrom)&&Je.isValidMoment(this.timeTill)}},{key:"purgeHistory",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("POST","/purge-history",{entityType:this.entityType,timeFrom:this.timeFrom.toISOString(),timeTill:this.timeTill.toISOString(),statuses:Array.from(this._statuses.values())}).then((function(t){e._instancesDeleted=t.instancesDeleted}),(function(t){return e.showError("Purge history failed",t)})).finally((function(){e._inProgress=!1}))}},{key:"getStatusIncluded",value:function(e){return this._statuses.has(e)}},{key:"setStatusIncluded",value:function(e,t){t?this._statuses.add(e):this._statuses.delete(e)}}]),n}(vt),Object(B.a)(fr.prototype,"dialogOpen",[W.e],Object.getOwnPropertyDescriptor(fr.prototype,"dialogOpen"),fr.prototype),Object(B.a)(fr.prototype,"instancesDeleted",[W.e],Object.getOwnPropertyDescriptor(fr.prototype,"instancesDeleted"),fr.prototype),Object(B.a)(fr.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(fr.prototype,"inProgress"),fr.prototype),Object(B.a)(fr.prototype,"isValid",[W.e],Object.getOwnPropertyDescriptor(fr.prototype,"isValid"),fr.prototype),br=Object(B.a)(fr.prototype,"timeFrom",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yr=Object(B.a)(fr.prototype,"timeTill",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vr=Object(B.a)(fr.prototype,"entityType",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Orchestration"}}),Or=Object(B.a)(fr.prototype,"_statuses",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Set}}),Er=Object(B.a)(fr.prototype,"_dialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_r=Object(B.a)(fr.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kr=Object(B.a)(fr.prototype,"_instancesDeleted",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fr),gi=(Cr=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,Object(z.a)(a,"removeEmptyEntities",jr,Object(Ue.a)(a)),Object(z.a)(a,"releaseOrphanedLocks",wr,Object(Ue.a)(a)),Object(z.a)(a,"_dialogOpen",Sr,Object(Ue.a)(a)),Object(z.a)(a,"_inProgress",Nr,Object(Ue.a)(a)),Object(z.a)(a,"_response",Tr,Object(Ue.a)(a)),a}return Object(m.a)(n,[{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){this._dialogOpen=e,e&&(this._response=null,this.removeEmptyEntities=!0,this.releaseOrphanedLocks=!0)}},{key:"response",get:function(){return this._response}},{key:"inProgress",get:function(){return this._inProgress}},{key:"isValid",get:function(){return!0}},{key:"clean",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("POST","/clean-entity-storage",{removeEmptyEntities:this.removeEmptyEntities,releaseOrphanedLocks:this.releaseOrphanedLocks}).then((function(t){e._response=t}),(function(t){return e.showError("Clean Entity Storage failed",t)})).finally((function(){e._inProgress=!1}))}}]),n}(vt),Object(B.a)(Cr.prototype,"dialogOpen",[W.e],Object.getOwnPropertyDescriptor(Cr.prototype,"dialogOpen"),Cr.prototype),Object(B.a)(Cr.prototype,"response",[W.e],Object.getOwnPropertyDescriptor(Cr.prototype,"response"),Cr.prototype),Object(B.a)(Cr.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(Cr.prototype,"inProgress"),Cr.prototype),Object(B.a)(Cr.prototype,"isValid",[W.e],Object.getOwnPropertyDescriptor(Cr.prototype,"isValid"),Cr.prototype),jr=Object(B.a)(Cr.prototype,"removeEmptyEntities",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr=Object(B.a)(Cr.prototype,"releaseOrphanedLocks",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sr=Object(B.a)(Cr.prototype,"_dialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Nr=Object(B.a)(Cr.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Tr=Object(B.a)(Cr.prototype,"_response",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cr),fi=(Ir=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,Object(z.a)(a,"hubName",Pr,Object(Ue.a)(a)),Object(z.a)(a,"connectionString",Dr,Object(Ue.a)(a)),Object(z.a)(a,"_dialogOpen",Fr,Object(Ue.a)(a)),Object(z.a)(a,"_inProgress",xr,Object(Ue.a)(a)),Object(z.a)(a,"_isReadOnly",Mr,Object(Ue.a)(a)),a._oldConnectionString=void 0,a._oldHubName=void 0,a}return Object(m.a)(n,[{key:"inProgress",get:function(){return this._inProgress}},{key:"isReadonly",get:function(){return this._isReadOnly}},{key:"isDirty",get:function(){return this.connectionString!==this._oldConnectionString||this.hubName!==this._oldHubName}},{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){var t=this;this._dialogOpen=e,e&&(this._inProgress=!0,this._backendClient.call("GET","/manage-connection").then((function(e){t.connectionString=t._oldConnectionString=e.connectionString,t.hubName=t._oldHubName=e.hubName,t._isReadOnly=e.isReadOnly}),(function(e){return t.showError("Load failed",e)})).finally((function(){t._inProgress=!1})))}},{key:"saveConnectionParams",value:function(){var e=this;this._inProgress=!0,this._backendClient.call("PUT","/manage-connection",{connectionString:this.connectionString!==this._oldConnectionString?this.connectionString:"",hubName:this.hubName}).then((function(){e._dialogOpen=!1,alert("Your changes were saved to local.settings.json file, but they cannot be picked up automatically. Please, restart the Function Host for them to take effect.")}),(function(t){return e.showError("Save failed",t)})).finally((function(){e._inProgress=!1}))}}]),n}(vt),Pr=Object(B.a)(Ir.prototype,"hubName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Object(B.a)(Ir.prototype,"connectionString",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)(Ir.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(Ir.prototype,"inProgress"),Ir.prototype),Object(B.a)(Ir.prototype,"isReadonly",[W.e],Object.getOwnPropertyDescriptor(Ir.prototype,"isReadonly"),Ir.prototype),Object(B.a)(Ir.prototype,"isDirty",[W.e],Object.getOwnPropertyDescriptor(Ir.prototype,"isDirty"),Ir.prototype),Object(B.a)(Ir.prototype,"dialogOpen",[W.e],Object.getOwnPropertyDescriptor(Ir.prototype,"dialogOpen"),Ir.prototype),Fr=Object(B.a)(Ir.prototype,"_dialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xr=Object(B.a)(Ir.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Mr=Object(B.a)(Ir.prototype,"_isReadOnly",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ir),bi=(Lr=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this))._backendClient=e,Object(z.a)(a,"instanceId",Rr,Object(Ue.a)(a)),Object(z.a)(a,"orchestratorFunctionName",Hr,Object(Ue.a)(a)),Object(z.a)(a,"input",Ar,Object(Ue.a)(a)),Object(z.a)(a,"_dialogOpen",zr,Object(Ue.a)(a)),Object(z.a)(a,"_inProgress",Br,Object(Ue.a)(a)),a}return Object(m.a)(n,[{key:"inProgress",get:function(){return this._inProgress}},{key:"dialogOpen",get:function(){return this._dialogOpen},set:function(e){this._dialogOpen=e,this.instanceId="",this.orchestratorFunctionName="",this.input=""}},{key:"backendClient",get:function(){return this._backendClient}},{key:"showWithFunctionName",value:function(e){this.dialogOpen=!0,this.orchestratorFunctionName=e}},{key:"startNewInstance",value:function(){var e=this,t=null;if(this.input)try{t=JSON.parse(this.input)}catch(n){return void this.showError("Failed to parse input",n)}this._inProgress=!0,this._backendClient.call("POST","/orchestrations",{id:this.instanceId,name:this.orchestratorFunctionName,data:t}).then((function(t){e._dialogOpen=!1,e._backendClient.showDetails(t.instanceId)}),(function(t){return e.showError("Failed to start new instance",t)})).finally((function(){e._inProgress=!1}))}}]),n}(vt),Rr=Object(B.a)(Lr.prototype,"instanceId",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hr=Object(B.a)(Lr.prototype,"orchestratorFunctionName",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Object(B.a)(Lr.prototype,"input",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)(Lr.prototype,"inProgress",[W.e],Object.getOwnPropertyDescriptor(Lr.prototype,"inProgress"),Lr.prototype),Object(B.a)(Lr.prototype,"dialogOpen",[W.e],Object.getOwnPropertyDescriptor(Lr.prototype,"dialogOpen"),Lr.prototype),zr=Object(B.a)(Lr.prototype,"_dialogOpen",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Br=Object(B.a)(Lr.prototype,"_inProgress",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Lr),yi=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Object(u.a)(this,e),this._prefix=t,this._useLocalStorage=n}return Object(m.a)(e,[{key:"setItem",value:function(e,t){this._useLocalStorage&&localStorage.setItem("".concat(this._prefix,"::").concat(e),t);var n=new rn;n.values[e]=t,n.apply()}},{key:"setItems",value:function(e){var t,n=new rn,a=Object(Ge.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;null===r.value?(this._useLocalStorage&&localStorage.removeItem("".concat(this._prefix,"::").concat(r.fieldName)),delete n.values[r.fieldName]):(this._useLocalStorage&&localStorage.setItem("".concat(this._prefix,"::").concat(r.fieldName),r.value),n.values[r.fieldName]=r.value)}}catch(i){a.e(i)}finally{a.f()}n.apply()}},{key:"getItem",value:function(e){var t=new rn;return t.values[e]?t.values[e]:this._useLocalStorage?localStorage.getItem("".concat(this._prefix,"::").concat(e)):null}},{key:"removeItem",value:function(e){this._useLocalStorage&&localStorage.removeItem("".concat(this._prefix,"::").concat(e));var t=new rn;delete t.values[e],t.apply()}}]),e}(),vi=function(){function e(t){var n=this;Object(u.a)(this,e),this._vsCodeApi=t,this._handlers=void 0,this._requests={},window.addEventListener("message",(function(e){var t=e.data;if(n._handlers&&n._handlers[t.id])try{n._handlers[t.id](t.data)}catch(r){console.log("Failed to handle response from VsCode: "+r)}else{var a=n._requests[t.id];a&&(t.err?a.reject(t.err):a.resolve(t.data),delete n._requests[t.id])}}))}return Object(m.a)(e,[{key:"isVsCode",get:function(){return!0}},{key:"routePrefixAndTaskHubName",get:function(){return null}},{key:"call",value:function(e,t,n){var a=this,r=Math.random().toString();return this._vsCodeApi.postMessage({id:r,method:e,url:t,data:n}),new Promise((function(e,t){a._requests[r]={resolve:e,reject:t}}))}},{key:"showDetails",value:function(e){this.call("OpenInNewWindow",e)}},{key:"setCustomHandlers",value:function(e){this._handlers=e,this._vsCodeApi.postMessage({method:"IAmReady"})}}]),e}(),Oi=function(){function e(t,n){Object(u.a)(this,e),this._prefix=t,this._vsCodeApi=n,this._state=void 0,this._state=StateFromVsCode[this._prefix],this._state||(this._state={})}return Object(m.a)(e,[{key:"setItem",value:function(e,t){this._state[e]=t,this.save()}},{key:"setItems",value:function(e){var t,n=Object(Ge.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value;null===a.value?delete this._state[a.fieldName]:this._state[a.fieldName]=a.value}}catch(r){n.e(r)}finally{n.f()}this.save()}},{key:"getItem",value:function(e){return this._state[e]}},{key:"removeItem",value:function(e){delete this._state[e],this.save()}},{key:"save",value:function(){this._vsCodeApi.postMessage({method:"PersistState",key:this._prefix,data:this._state})}}]),e}();!function(e){e[e.DurableFunctions=0]="DurableFunctions",e[e.FunctionGraph=1]="FunctionGraph"}(Ur||(Ur={}));var Ei=(Wr=function(){function e(){var t=this;Object(u.a)(this,e),this.loginState=void 0,this.mainMenuState=void 0,this.orchestrationsState=void 0,this.orchestrationDetailsState=void 0,this.functionGraphState=void 0,this.purgeHistoryDialogState=void 0,this.cleanEntityStorageDialogState=void 0,this.connectionParamsDialogState=void 0,this.startNewInstanceDialogState=void 0,Object(z.a)(this,"menuAnchorElement",Vr,this),Object(z.a)(this,"_suggestions",Yr,this),Object(z.a)(this,"_typedInstanceId",Gr,this),this._backendClient=void 0;var n=void 0;try{n=acquireVsCodeApi()}catch(i){}if(n){var a=new vi(n);this._backendClient=a,this.purgeHistoryDialogState=new pi(a),this.cleanEntityStorageDialogState=new gi(a),this.startNewInstanceDialogState=new bi(a),DfmViewMode===Ur.FunctionGraph?this.functionGraphState=new hi(a):this.instanceId?this.orchestrationDetailsState=new di(this.instanceId,IsFunctionGraphAvailable,a,new Oi("OrchestrationDetailsState",n)):(this.orchestrationsState=new Cn(IsFunctionGraphAvailable,a,new Oi("OrchestrationsState",n),(function(e){return t.startNewInstanceDialogState.showWithFunctionName(e)})),a.setCustomHandlers({purgeHistory:function(){return t.purgeHistoryDialogState.dialogOpen=!0},cleanEntityStorage:function(){return t.cleanEntityStorageDialogState.dialogOpen=!0},startNewInstance:function(){return t.startNewInstanceDialogState.dialogOpen=!0}}))}else{this.loginState=new zn;var r=new Hn((function(){return t.loginState.taskHubName}),(function(){return t.loginState.getAuthorizationHeaderAsync()}));this._backendClient=r,this.purgeHistoryDialogState=new pi(r),this.cleanEntityStorageDialogState=new gi(r),this.connectionParamsDialogState=new fi(r),this.startNewInstanceDialogState=new bi(r),this.instanceId?this.orchestrationDetailsState=new di(this.instanceId,IsFunctionGraphAvailable,r,new yi("OrchestrationDetailsState",!1)):(this.mainMenuState=new oi(r,this.purgeHistoryDialogState,this.cleanEntityStorageDialogState,this.connectionParamsDialogState,this.startNewInstanceDialogState),this.orchestrationsState=new Cn(IsFunctionGraphAvailable,r,new yi("OrchestrationsState"),(function(e){return t.startNewInstanceDialogState.showWithFunctionName(e)})))}}return Object(m.a)(e,[{key:"typedInstanceId",get:function(){return this._typedInstanceId},set:function(e){this._typedInstanceId=e,this.reloadSuggestions()}},{key:"suggestions",get:function(){return this._suggestions}},{key:"isExactMatch",get:function(){return 1===this._suggestions.length&&this._suggestions[0]===this._typedInstanceId}},{key:"goto",value:function(){window.open("".concat(this._backendClient.routePrefixAndTaskHubName).concat(An).concat(this._typedInstanceId)),this._typedInstanceId="",this._suggestions=[]}},{key:"instanceId",get:function(){if(OrchestrationIdFromVsCode)return OrchestrationIdFromVsCode;var e=window.location.pathname.lastIndexOf(An);return e<0?"":window.location.pathname.substr(e+An.length)}},{key:"reloadSuggestions",value:function(){var e=this;if(!this._typedInstanceId||this._typedInstanceId.length<2)this._suggestions=[];else{var t="/id-suggestions(prefix='".concat(this._typedInstanceId,"')");this._backendClient.call("GET",t).then((function(t){t&&e._typedInstanceId?e._suggestions=t:e._suggestions=[]}))}}}]),e}(),Vr=Object(B.a)(Wr.prototype,"menuAnchorElement",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(B.a)(Wr.prototype,"typedInstanceId",[W.e],Object.getOwnPropertyDescriptor(Wr.prototype,"typedInstanceId"),Wr.prototype),Object(B.a)(Wr.prototype,"suggestions",[W.e],Object.getOwnPropertyDescriptor(Wr.prototype,"suggestions"),Wr.prototype),Object(B.a)(Wr.prototype,"isExactMatch",[W.e],Object.getOwnPropertyDescriptor(Wr.prototype,"isExactMatch"),Wr.prototype),Yr=Object(B.a)(Wr.prototype,"_suggestions",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Gr=Object(B.a)(Wr.prototype,"_typedInstanceId",[W.l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Wr);document.body.style.backgroundColor=Z.palette.background.paper;var _i=new Ei;l.render(s.createElement(c.a,{theme:Z},s.createElement(ii,{state:_i})),document.getElementById("root"))}},[[697,1,2]]]);
//# sourceMappingURL=main.07c56eda.chunk.js.map